<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>ceoDOC.it ‚Äî Business Intelligence Platform</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">

<!-- Favicon con barre a gradiente -->
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cdefs%3E%3ClinearGradient id='g1' x1='0' y1='0' x2='0' y2='1'%3E%3Cstop offset='0%25' stop-color='%23ff6b00'/%3E%3Cstop offset='100%25' stop-color='%231d3557'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect x='10' y='60' width='8' height='30' rx='2' fill='url(%23g1)'/%3E%3Crect x='25' y='45' width='8' height='45' rx='2' fill='url(%23g1)'/%3E%3Crect x='40' y='35' width='8' height='55' rx='2' fill='url(%23g1)'/%3E%3Crect x='55' y='50' width='8' height='40' rx='2' fill='url(%23g1)'/%3E%3Crect x='70' y='40' width='8' height='50' rx='2' fill='url(%23g1)'/%3E%3C/svg%3E">

<style>
/* ======================================================
   VARIABILI GLOBALI & RESET
   ====================================================== */
:root{
  --ceo-orange:#ff6b00;
  --ceo-orange-2:#ff8c32;
  --ceo-blue:#1d3557;
  --brand-blue:#0b65d4;
  --brand-cyan:#1aa6ff;
  --bg:#eef3f9;
  --panel:#ffffff;
  --ink:#1b2330;
  --muted:#6b7280;
  --sidebar-w:280px;
  --radius:16px;
  --shadow:0 12px 28px rgba(27,35,48,.10);
  --border:#e7eaf0;
  --dash-w:1000px;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;background:var(--bg);color:var(--ink);
  font:14px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Arial;
}
a{color:var(--brand-blue);text-decoration:none}
button{cursor:pointer;border:0}
/* Dark Mode */
body.dark-mode {
  --bg: #1a1f2e;
  --panel: #232937;
  --ink: #e4e6eb;
  --muted: #9ca3af;
  --border: #374151;
  --shadow: 0 12px 28px rgba(0,0,0,.30);
}
body.dark-mode #sidebar {
  background: #232937;
  color: #e4e6eb;
}
body.dark-mode .sidebar-link {
  background: #2d3748;
  color: #e4e6eb;
  border-color: #374151;
}
body.dark-mode .sidebar-link:hover {
  background: linear-gradient(90deg,#374151 10%,#2d3748 90%);
}

/* Welcome page in dark mode */
body.dark-mode .welcome-content {
  color: #e4e6eb;
}
body.dark-mode .welcome-content p {
  color: #e4e6eb;
}
body.dark-mode .welcome-bullet span {
  color: #e4e6eb;
}
body.dark-mode .welcome-bullet span:first-child {
  color: #fff;
}
body.dark-mode .welcome-content a {
  color: var(--ceo-orange);
}

/* Logo text in dark mode */
body.dark-mode .logo-ceodoc-sidebar text {
  fill: #e4e6eb;
}
body.dark-mode .logo-ceodoc-sidebar text:first-of-type {
  fill: var(--ceo-orange); /* Mantieni ceoDOC arancione */
}

/* ======================================================
   SIDEBAR
   ====================================================== */
#sidebar{
  position:fixed;top:0;left:0;bottom:0;width:var(--sidebar-w);
  background:#fff;color:var(--ceo-blue);
  box-shadow:var(--shadow);z-index:5;overflow-y:auto;
  border-right:1px solid var(--border);
}
.sidebar-header{padding:16px 16px 8px;border-bottom:1px solid var(--border)}
.logo-ceodoc-sidebar{width:100%;height:auto;display:block}

.sidebar-menu{display:flex;flex-direction:column;gap:10px;padding:14px}
.sidebar-link{
  width:100%;text-align:left;background:#fff;color:var(--ceo-blue);
  padding:12px 14px;border-radius:12px;display:flex;align-items:center;gap:10px;
  border:1px solid #e8eef5;box-shadow:0 1px 2px rgba(16,24,40,.04);
}
.sidebar-link:hover,.sidebar-link.active{
  background:linear-gradient(90deg,#ffe3cc 10%,#ffffff 90%);
  color:var(--ceo-orange);transform:translateX(3px)
}

/* Bottone Chat nel footer sidebar */
.sidebar-chat{
  display:flex;align-items:center;gap:10px;width:100%;
  background:#f7fbff;border:1px solid #d9ecff;border-radius:14px;
  padding:12px 14px;font-weight:800;color:var(--ceo-blue);
}
.sidebar-chat:hover{background:#eef6ff;transform:translateX(3px)}
.chat-icon{width:24px;height:24px;flex:0 0 24px}

/* Footer fisso della sidebar */
.sidebar-footer{
  position:sticky;bottom:10px;left:10px;right:10px;
  padding:18px;background:#f8f9fa;border-top:1px solid var(--border);
  margin:10px;border-radius:12px;
  box-shadow:0 2px 4px rgba(0,0,0,0.05)
}
.sidebar-footer .links{display:flex;gap:10px;justify-content:center;margin:12px 0;font-size:.7rem}
.sidebar-footer .links a{color:#666;cursor:pointer}
.sidebar-footer .links a:hover{text-decoration:underline;color:var(--ceo-orange)}

/* Riquadro Anagrafica attiva */
.active-company{
  background:#f7fbff;border:1px solid #d9ecff;border-radius:14px;
  padding:10px 12px;color:var(--ceo-blue);line-height:1.2;margin-top:12px;
  transition:all 0.2s ease;
}
.active-company:hover{
  background:#eef6ff;transform:translateX(3px);
}
.active-company h4{
  margin:0 0 6px 0;font-size:10px;text-transform:uppercase;letter-spacing:.05em;
  color:var(--ceo-blue);font-weight:800;text-align:left;
}
.active-company .row{display:flex;align-items:flex-start;gap:4px;font-size:10px;text-align:left}
.active-company .k{min-width:70px;color:#5f6b7a;font-size:9px;text-align:left}
.active-company .v{font-weight:400;color:var(--ceo-blue);font-size:10px;word-break:break-word;overflow:hidden;text-overflow:ellipsis;text-align:left}
.active-company .v.bold{font-weight:700}
.active-company .k.bold{font-weight:700;color:var(--ceo-blue)}

/* ======================================================
   MAIN / HEADER
   ====================================================== */
#main-content{margin-left:var(--sidebar-w);min-height:100vh;display:flex;flex-direction:column}

.main-header{
  background:linear-gradient(135deg, #6585b0 0%, #4a6590 25%, #3a5580 50%, #2a4570 75%, #1d3557 100%);
  color:#fff;padding:10px 18px;box-shadow:var(--shadow);position:sticky;top:0;z-index:4
}
.header-content{display:flex;align-items:center;gap:16px}
.header-logo{width:150px;height:75px}
.header-title{font-size:28px;font-weight:800;margin:0}
.header-subtitle{font-size:14px;opacity:.92;margin:2px 0 0 0}
.header-buttons{margin-left:auto;display:flex;gap:10px;flex-wrap:wrap}
.header-buttons button{
  background:#ffffff;color:#1d3557;  /* BLU normale */
  padding:10px 14px;border-radius:12px;border:1px solid rgba(255,255,255,.2);
  font-weight:700;
  transition:all 0.3s ease;  /* Animazione fluida */
}
.header-buttons button svg{
  color:#1d3557;  /* BLU normale */
  transition:color 0.3s ease;
}
.header-buttons button:hover{
  color:#ff6b00;  /* ARANCIONE su hover */
  transform:translateY(-2px);  /* Leggero movimento */
  box-shadow:0 4px 12px rgba(0,0,0,0.15);
}
.header-buttons button:hover svg{
  color:#ff6b00;  /* ARANCIONE su hover */
}

/* ======================================================
   CONTENUTO (card/griglie centrate)
   ====================================================== */
.content-area{
  padding:20px;
  min-height:calc(100vh - 110px);
  display:grid;place-items:center;
}
.content-card{
  background:var(--panel);border-radius:var(--radius);box-shadow:var(--shadow);
  padding:18px;position:relative; /* per overlay licenza */
  width:100%;max-width:var(--dash-w);
}
.content-card.expanded{padding:0;max-width:95vw}

/* Overlay blocco licenza scaduta */
#license-overlay{
  position:absolute;inset:0;display:none;align-items:center;justify-content:center;
  background:rgba(255,255,255,.78);backdrop-filter:blur(2px);z-index:20
}
#license-overlay .msg{
  background:#fff;border:1px solid #ffdbc0;border-radius:12px;padding:18px 22px;
  color:#8a4b12;box-shadow:0 10px 30px rgba(0,0,0,.15);text-align:center;max-width:520px
}
.content-card.blocked #card-content{filter:grayscale(1) blur(.5px);pointer-events:none}

/* Dashboard */
.dashboard-grid{
  display:grid;gap:18px;grid-template-columns:repeat(5,minmax(160px,1fr));
  max-width:var(--dash-w);margin:0 auto;
}
@media (max-width:1300px){.dashboard-grid{grid-template-columns:repeat(4,1fr)}}
@media (max-width:1000px){.dashboard-grid{grid-template-columns:repeat(3,1fr)}}
@media (max-width:760px){.dashboard-grid{grid-template-columns:repeat(2,1fr)}}

.btn-circular{
  background:#fff;border-radius:18px;box-shadow:var(--shadow);padding:18px;
  display:grid;place-items:center;gap:8px;
  transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  border:1px solid #eef0f5;
  position:relative;
  overflow:hidden;
}
.btn-circular:hover{
  transform:translateY(-6px) scale(1.02);
  box-shadow:0 20px 40px rgba(255,107,0,0.15);
  border-color:#ffd4b3;
}
.btn-circular .icon{
  width:78px;height:78px;border-radius:50%;display:grid;place-items:center;color:#fff;font-weight:700;
  box-shadow:inset 0 0 0 6px rgba(255,255,255,.2),0 10px 20px rgba(0,0,0,.10);
  transition:transform 0.3s ease, box-shadow 0.3s ease;
}
.btn-circular:hover .icon{
  transform:rotate(5deg) scale(1.08);
  box-shadow:inset 0 0 0 6px rgba(255,255,255,.4),
             0 15px 30px rgba(0,0,0,.2);
}
.btn-circular span{
  font-weight:700;color:#1b2330;text-align:center;
  transition:color 0.3s ease;
}
.btn-circular:hover span{
  color:#ff6b00;
}
/* Welcome */
.welcome-content{max-width:var(--dash-w);margin:0 auto;text-align:center;color:var(--ceo-blue)}
.welcome-title{color:var(--ceo-orange);font-size:3.2rem;line-height:1.1;margin:0 0 12px}
@media (max-width:768px){.welcome-title{font-size:2rem}}
.welcome-bullet{display:flex;align-items:center;gap:12px;margin:10px 0}
.welcome-bullet .dot{
  display:inline-grid;place-items:center;width:40px;height:40px;border-radius:50%;
  background:var(--ceo-orange);color:#fff
}
.welcome-label {
  color: #1b2330;
}
body.dark-mode .welcome-label {
  color: #e4e6eb;
}

/* Avviso in fondo alla dashboard */
.dashboard-footer{
  display:flex;align-items:center;gap:10px;background:#fff3cd;border:1px solid #ffeaa7;
  color:#856404;padding:12px 16px;border-radius:12px
}

/* Anagrafica */
.anagrafica-buttons{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-bottom:8px}
.anagrafica-btn{
  background:var(--ceo-blue);color:#fff;padding:10px 14px;border-radius:10px;font-weight:700;
  border:1px solid rgba(0,0,0,.08)
}
.anagrafica-btn.secondary{background:#fff;color:var(--ceo-blue);border:1px solid #e5e7eb}
.anagrafica-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
@media (max-width:768px){.anagrafica-grid{grid-template-columns:repeat(2,1fr)}}
@media (max-width:480px){.anagrafica-grid{grid-template-columns:1fr}}
.anagrafica-field label{display:block;font-weight:700;margin-bottom:6px;color:var(--ceo-blue)}
.anagrafica-field input,.anagrafica-field select{
  width:100%;padding:10px;border:2px solid #ddd;border-radius:8px
}

/* Modali */
.modal-bg{position:fixed;inset:0;background:rgba(0,0,0,.45);display:flex;align-items:center;justify-content:center;z-index:90}
.modal-bg.hidden{display:none}
.modal-card{background:#fff;border-radius:16px;box-shadow:var(--shadow);width:min(760px,96%);padding:18px}
.modal-card h3{margin:0 0 8px 0}
.modal-card .grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.modal-card input,.modal-card select{width:100%;padding:10px;border:2px solid #e5e7eb;border-radius:10px}
.modal-card button{background:var(--ceo-blue);color:#fff;padding:10px 14px;border-radius:10px;border:1px solid rgba(0,0,0,.1);font-weight:700}
.modal-card button.secondary{background:#fff;color:var(--ceo-blue)}
.legal-notice{background:#fff7ed;border:1px solid #ffedd5;color:#7c2d12;padding:10px 12px;border-radius:10px;margin:8px 0}

/* Pannello chat laterale */
#chat-panel{
  position:fixed;top:0;right:-420px;width:380px;max-width:90vw;height:100vh;background:#fff;
  box-shadow:-12px 0 30px rgba(0,0,0,.20);border-left:1px solid var(--border);
  transition:right .28s ease;z-index:1000;display:flex;flex-direction:column
}
#chat-panel.open{right:0}
#chat-head{display:flex;align-items:center;gap:10px;justify-content:space-between;padding:12px 14px;border-bottom:1px solid var(--border);background:#f7f9fc}
#chat-left{display:flex;gap:10px;align-items:center}
#chat-slogan{font-size:12px;color:#334155}
#chat-title{font-weight:800;color:var(--ceo-blue);line-height:1.2}
#chat-close{background:#fff;border:1px solid #e5e7eb;border-radius:8px;padding:6px 10px;font-weight:700}
#chat-body{flex:1}
#chat-iframe{width:100%;height:100%;border:0}

/* Responsive sidebar su mobile */
@media (max-width: 768px){
  :root{--sidebar-w:100vw}
  #sidebar{position:relative;border-right:0;border-bottom:1px solid var(--border)}
  #main-content{margin-left:0}
}


/* INTEGRAZIONI - 2. MODAL PROFILO UTENTE */
.modal-profilo {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  z-index: 1000;
  display: none;
  align-items: center;
  justify-content: center;
  padding: 20px; /* Aggiungi padding per non toccare i bordi */
}
.modal-profilo-content {
  background: #fff;
  border-radius: 20px;
  width: 600px;
  max-width: 95%;
  height: 95vh; /* Altezza fissa al 95% dello schermo */
  overflow-y: auto;
}
.profilo-header {
  background: linear-gradient(135deg, var(--ceo-orange), #ff8533);
  color: white;
  padding: 15px 25px;
  border-radius: 20px 20px 0 0;
  text-align: center;
  position: relative;
}
.profilo-close {
  position: absolute;
  top: 15px;
  right: 15px;
  background: rgba(255,255,255,0.2);
  border: none;
  width: 36px;
  height: 36px;
  border-radius: 50%;
  color: white;
  font-size: 24px;
  cursor: pointer;
}
.profilo-close:hover {
  background: rgba(255,255,255,0.3);
}
.profilo-body {
  padding: 35px;
}
.profilo-section {
  margin-bottom: 35px;
}
.profilo-section h3 {
  color: var(--ceo-orange);
  margin-bottom: 20px;
  font-size: 18px;
  display: flex;
  align-items: center;
  gap: 10px;
}
.profilo-info-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 12px;
}
.profilo-info-item {
  background: var(--bg);
  padding: 12px;
  border-radius: 12px;
  border: 1px solid var(--border);
}
.profilo-info-label {
  font-size: 12px;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 5px;
}
.profilo-info-value {
  font-size: 16px;
  font-weight: 600;
  color: var(--ink);
}
.profilo-actions {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 12px;
  margin-top: 10px;
}
.profilo-actions button {
  padding: 12px 16px;
  border-radius: 10px;
  font-weight: 600;
  font-size: 14px;
  white-space: nowrap;
}
/* Compatta sezione anagrafiche */
.profilo-section:last-of-type .profilo-info-grid {
  grid-template-columns: 1fr 1fr;
  gap: 8px;
}
.profilo-section:last-of-type .profilo-info-item {
  padding: 8px 12px;
  min-height: auto;
}
.profilo-section:last-of-type h3 {
  margin-bottom: 12px; /* Ridotto spazio sotto titolo */
}

.btn-aggiorna {
  background: #fff;
  color: var(--ceo-orange);
  border: 2px solid var(--ceo-orange);
}
.btn-rinnova {
  background: var(--ceo-orange);
  color: white;
}
.btn-controlla {
  background: #6b7280;
  color: white;
  line-height: 1.2;
  min-height: 44px;
}
.btn-controlla:hover {
  background: #4b5563;
}
/* INTEGRAZIONI - 4. TOOLTIP BACKUP */
.tooltip-wrapper {
  position: relative;
  display: inline-block;
}
.tooltip-content {
  position: absolute;
  top: calc(100% + 10px);
  left: 50%;
  transform: translateX(-50%);
  background: #f59e0b;  /* Arancione per warning */
  color: #451a03;
  padding: 12px 16px;
  border-radius: 8px;
  font-size: 13px;
  white-space: normal;
  width: 280px;
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s ease;
  pointer-events: none;
  z-index: 9999;  /* Aumentato per essere sopra tutto */
  line-height: 1.4;
  box-shadow: 0 4px 12px rgba(0,0,0,0.3);  /* Aggiunta ombra */
}
.tooltip-content::after {
  content: '';
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%);
  border: 6px solid transparent;
  border-bottom-color: #f59e0b;
}
.tooltip-wrapper:hover .tooltip-content {
  opacity: 1;
  visibility: visible;
}
</style>
</head>
<body>


<!-- ============ SVG SYMBOLS ============ -->
<svg aria-hidden="true" style="position:absolute;width:0;height:0;overflow:hidden">
  <defs>
    <!-- Icona chiave -->
    <symbol id="i-key" viewBox="0 0 24 24">
      <path fill="currentColor" d="M21 10a5 5 0 1 0-9.9 1H5l-2 2 2 2-2 2 2 2 2-2h2v-2h2l1.1-1.1A5 5 0 0 0 21 10zM16 10a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"/>
    </symbol>
    
    <!-- Icona utente -->
    <symbol id="i-user" viewBox="0 0 24 24">
      <path fill="currentColor" d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5zm0 2c-5 0-9 2.5-9 5v1h18v-1c0-2.5-4-5-9-5z"/>
    </symbol>
    
    <!-- Icona documento -->
    <symbol id="i-doc" viewBox="0 0 24 24">
      <path fill="currentColor" d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
      <path fill="currentColor" d="M14 2v6h6"/>
    </symbol>
    
    <!-- Icona banca -->
    <symbol id="i-bank" viewBox="0 0 24 24">
      <path fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" d="M12 3 3 8v2h18V8l-9-5zM4 20h16v-8H4zM6 12v6M10 12v6M14 12v6M18 12v6"/>
    </symbol>
    
    <!-- Icona grafico -->
    <symbol id="i-chart" viewBox="0 0 24 24">
      <path fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" d="M4 20h16M6 18V9M12 18V4M18 18v-6"/>
    </symbol>
    
    <!-- Icona matita -->
    <symbol id="i-pencil" viewBox="0 0 24 24">
      <path fill="currentColor" d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25z"/>
      <path fill="currentColor" d="M20.71 7.04a1 1 0 0 0 0-1.41l-2.34-2.34a1 1 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
    </symbol>
    
    <!-- Icona salva -->
    <symbol id="i-save" viewBox="0 0 24 24">
      <path fill="currentColor" d="M17 3H5a2 2 0 0 0-2 2v14h18V7l-4-4z"/>
      <path fill="currentColor" d="M7 3v6h8V3M7 21v-6h10v6"/>
    </symbol>
    
    <!-- Icona X (chiudi) -->
    <symbol id="i-x" viewBox="0 0 24 24">
      <path fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" d="M18 6 6 18M6 6l12 12"/>
    </symbol>
    
    <!-- Icona avviso -->
    <symbol id="i-warn" viewBox="0 0 24 24">
      <path fill="none" stroke="currentColor" stroke-width="2" d="M12 2 1 21h22L12 2z"/>
      <path fill="none" stroke="currentColor" stroke-width="2" d="M12 8v6M12 17v1"/>
    </symbol>
    
    <!-- Icona lucchetto -->
    <symbol id="i-lock" viewBox="0 0 24 24">
      <path fill="none" stroke="currentColor" stroke-width="2" d="M6 10V8a6 6 0 1 1 12 0v2"/>
      <rect x="4" y="10" width="16" height="10" rx="2" fill="none" stroke="currentColor" stroke-width="2"/>
    </symbol>
    
    <!-- Icona freccia sinistra -->
    <symbol id="i-arrow-left" viewBox="0 0 24 24">
      <path fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" d="M19 12H5M12 19l-7-7 7-7"/>
    </symbol>
    
    <!-- Icona Chat Cloud (nuvola con puntini) -->
    <symbol id="i-cloudchat" viewBox="0 0 24 24">
      <!-- Forma nuvola chat -->
      <path fill="var(--ceo-blue)" d="M6.5 18a4.5 4.5 0 0 1-1.6-8.7A6.2 6.2 0 0 1 10.8 4c2.6 0 4.9 1.6 5.7 4a4.5 4.5 0 0 1 2.5 8.3 4.8 4.8 0 0 1-2.3.7H11l-2.7 2.7V18H6.5z"/>
      <!-- Tre puntini chat -->
      <circle cx="9" cy="13" r="1.1" fill="#fff"/>
      <circle cx="12" cy="13" r="1.1" fill="#fff"/>
      <circle cx="15" cy="13" r="1.1" fill="#fff"/>
    </symbol>
    
    <!-- Icona update -->
    <symbol id="i-update" viewBox="0 0 24 24">
      <path fill="currentColor" d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>
    </symbol>
    
    <!-- Icona check -->
    <symbol id="i-check" viewBox="0 0 24 24">
      <path fill="currentColor" d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"/>
    </symbol>
    
    <!-- Icona info -->
    <symbol id="i-info" viewBox="0 0 24 24">
      <path fill="currentColor" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/>
    </symbol>

<!-- Chatbot animato ceoDOC -->
<symbol id="i-chatbot" viewBox="0 0 100 100">
  <defs>
    <radialGradient id="ceoGlow">
      <stop offset="0%" stop-color="#ff6b00" stop-opacity="0.3"/>
      <stop offset="100%" stop-color="#ff6b00" stop-opacity="0"/>
    </radialGradient>
<!-- Bilancia della giustizia -->
<symbol id="i-scale" viewBox="0 0 24 24">
  <!-- Asta centrale -->
  <path d="M12 2v18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
  <!-- Base -->
  <path d="M8 21h8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
  <!-- Braccio orizzontale -->
  <path d="M6 6h12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
  <!-- Piatto sinistro -->
  <path d="M6 6l-3 6h6l-3-6z" fill="none" stroke="currentColor" stroke-width="1.5"/>
  <path d="M2 12v1c0 1.1 1.3 2 3 2s3-.9 3-2v-1" fill="currentColor" opacity="0.3"/>
  <!-- Piatto destro -->
  <path d="M18 6l-3 6h6l-3-6z" fill="none" stroke="currentColor" stroke-width="1.5"/>
  <path d="M14 12v1c0 1.1 1.3 2 3 2s3-.9 3-2v-1" fill="currentColor" opacity="0.3"/>
  <!-- Ornamento superiore -->
  <circle cx="12" cy="2" r="1" fill="currentColor"/>
</symbol>
<!-- Lucchetto per licenza -->
<symbol id="i-lock-license" viewBox="0 0 24 24">
  <path fill="currentColor" d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM9 6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9V6zm9 14H6V10h12v10zm-6-3c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2z"/>
</symbol>

<!-- Dischetto salva/backup -->
<symbol id="i-disk-out" viewBox="0 0 24 24">
  <path fill="currentColor" d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h11.17L19 7.83V19zm-7-7c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3zM6 6h9v4H6z"/>
  <path fill="currentColor" d="M16 13l2-2-2-2v1.5h-3v1h3V13z" opacity="0.8"/>
</symbol>

<!-- Dischetto ripristina -->
<symbol id="i-disk-in" viewBox="0 0 24 24">
  <path fill="currentColor" d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h11.17L19 7.83V19zm-7-7c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3zM6 6h9v4H6z"/>
  <path fill="currentColor" d="M11 13v-1.5h3v-1h-3V13l-2-2 2-2z" opacity="0.8"/>
</symbol>
  </defs>
  
  <!-- Effetto ripple -->
  <circle cx="50" cy="50" r="40" fill="url(#ceoGlow)" opacity="0">
    <animate attributeName="r" values="40;50;40" dur="2.5s" repeatCount="indefinite"/>
    <animate attributeName="opacity" values="0;0.4;0" dur="2.5s" repeatCount="indefinite"/>
  </circle>
  
  <!-- Cerchio base BLU - CONTENITORE VISIBILE -->
  <circle cx="50" cy="50" r="40" fill="#1d3557">
    <animate attributeName="r" values="40;42;40" dur="1.5s" repeatCount="indefinite"/>
  </circle>
  
  <!-- Chat bubble GRANDE MA CONTENUTA -->
  <g transform="translate(50, 50) scale(1.2)">
    <animateTransform attributeName="transform" type="scale" values="1.2;1.25;1.2" dur="1.5s" repeatCount="indefinite" additive="sum"/>
    <path d="M -18 -15 L 12 -15 Q 18 -15, 18 -9 L 18 6 Q 18 12, 12 12 L -3 12 L -9 20 L -9 12 L -12 12 Q -18 12, -18 6 L -18 -9 Q -18 -15, -12 -15 Z" fill="white"/>
    
    <!-- Occhi ARANCIONI -->
    <circle cx="-6" cy="-4" r="3" fill="#ff6b00">
      <animate attributeName="r" values="3;0.5;3" dur="3s" repeatCount="indefinite"/>
    </circle>
    <circle cx="6" cy="-4" r="3" fill="#ff6b00">
      <animate attributeName="r" values="3;0.5;3" dur="3s" repeatCount="indefinite" begin="0.1s"/>
    </circle>
    
    <!-- Sorriso ARANCIONE -->
    <path d="M -5 3 Q 0 7, 5 3" stroke="#ff6b00" stroke-width="3" fill="none" stroke-linecap="round">
      <animate attributeName="d" values="M -5 3 Q 0 7, 5 3;M -6 3 Q 0 9, 6 3;M -5 3 Q 0 7, 5 3" dur="2s" repeatCount="indefinite"/>
    </path>
  </g>
</symbol>

  </defs>
</svg>

<!-- ================= SIDEBAR ================= -->
<nav id="sidebar">
  <div class="sidebar-header">
    <!-- Logo completo laterale (barre) -->
    <svg class="logo-ceodoc-sidebar" viewBox="0 0 350 246" aria-hidden="true">
      <defs>
        <linearGradient id="sidebarGrad1" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#1d3557"/><stop offset="50%" stop-color="#2d4a6b"/><stop offset="100%" stop-color="#1a2e4a"/></linearGradient>
        <linearGradient id="sidebarGrad2" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#1d3557"/><stop offset="40%" stop-color="#2d4a6b"/><stop offset="80%" stop-color="#0095ff"/><stop offset="100%" stop-color="#0077cc"/></linearGradient>
        <linearGradient id="sidebarGrad3" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#1d3557"/><stop offset="30%" stop-color="#2d4a6b"/><stop offset="70%" stop-color="#ff6b00"/><stop offset="100%" stop-color="#e55a00"/></linearGradient>
        <linearGradient id="sidebarGrad4" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#ff6b00"/><stop offset="50%" stop-color="#ff8c32"/><stop offset="100%" stop-color="#e55a00"/></linearGradient>
        <linearGradient id="sidebarGrad5" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#ff6b00"/><stop offset="50%" stop-color="#ff9c42"/><stop offset="100%" stop-color="#ffa94d"/></linearGradient>
        <linearGradient id="sidebarGrad6" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#ffa94d"/><stop offset="50%" stop-color="#ffb966"/><stop offset="100%" stop-color="#ff9c42"/></linearGradient>
        <filter id="sidebarBarShadow" x="-50%" y="-50%" width="200%" height="200%"><feDropShadow dx="3" dy="6" stdDeviation="4" flood-color="rgba(0,0,0,0.3)"/></filter>
        <pattern id="sidebarDotPattern" x="0" y="0" width="30" height="30" patternUnits="userSpaceOnUse"><circle cx="3" cy="3" r="1" fill="rgba(255,107,0,0.08)"/></pattern>
        <linearGradient id="sidebarTextGrad" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" stop-color="#ff6b00"/><stop offset="50%" stop-color="#ff8c32"/><stop offset="100%" stop-color="#ff6b00"/></linearGradient>
        <filter id="sidebarTextShadowLight"><feDropShadow dx="1" dy="1" stdDeviation="1.5" flood-color="rgba(0,0,0,0.2)"/></filter>
        <linearGradient id="sidebarAnimatedLineGradient" x1="0%" y1="0%" x2="100%" y2="0%">
          <stop offset="0%" stop-color="#1d3557"><animate attributeName="stop-color" values="#1d3557;#0095ff;#ff6b00;#ff8c32;#ffa94d;#1d3557" dur="6s" repeatCount="indefinite"/></stop>
          <stop offset="20%" stop-color="#0095ff"><animate attributeName="stop-color" values="#0095ff;#ff6b00;#ff8c32;#ffa94d;#1d3557;#0095ff" dur="6s" repeatCount="indefinite"/></stop>
          <stop offset="40%" stop-color="#ff6b00"><animate attributeName="stop-color" values="#ff6b00;#ff8c32;#ffa94d;#1d3557;#0095ff;#ff6b00" dur="6s" repeatCount="indefinite"/></stop>
          <stop offset="60%" stop-color="#ff8c32"><animate attributeName="stop-color" values="#ff8c32;#ffa94d;#1d3557;#0095ff;#ff6b00;#ff8c32" dur="6s" repeatCount="indefinite"/></stop>
          <stop offset="80%" stop-color="#ffa94d"><animate attributeName="stop-color" values="#ffa94d;#1d3557;#0095ff;#ff6b00;#ff8c32;#ffa94d" dur="6s" repeatCount="indefinite"/></stop>
          <stop offset="100%" stop-color="#ffb966"><animate attributeName="stop-color" values="#ffb966;#ffa94d;#ff8c32;#ff6b00;#0095ff;#ffb966" dur="6s" repeatCount="indefinite"/></stop>
      </linearGradient>
      </defs>
      <rect width="100%" height="100%" fill="url(#sidebarDotPattern)" opacity="0.5"/>
      <path d="M0,170 Q60,150 120,170 T240,170 T360,170" fill="none" stroke="url(#sidebarAnimatedLineGradient)" stroke-width="6"/>
      <path d="M0,175 Q60,155 120,175 T240,175 T360,175" fill="none" stroke="#ffa94d" stroke-width="2" opacity="0.3"/>
      <rect x="10" y="135" width="20" height="40" fill="url(#sidebarGrad1)" rx="2" filter="url(#sidebarBarShadow)"/>
      <rect x="60" y="110" width="20" height="60" fill="url(#sidebarGrad2)" rx="2" filter="url(#sidebarBarShadow)"/>
      <rect x="110" y="120" width="20" height="50" fill="url(#sidebarGrad3)" rx="2" filter="url(#sidebarBarShadow)"/>
      <rect x="160" y="100" width="20" height="70" fill="url(#sidebarGrad4)" rx="2" filter="url(#sidebarBarShadow)"/>
      <rect x="210" y="125" width="20" height="45" fill="url(#sidebarGrad5)" rx="2" filter="url(#sidebarBarShadow)"/>
      <rect x="260" y="105" width="20" height="65" fill="url(#sidebarGrad6)" rx="2" filter="url(#sidebarBarShadow)"/>
      <text x="180" y="215" font-family="'Segoe UI','Arial Black',Arial,sans-serif" font-size="30" font-weight="800" fill="url(#sidebarTextGrad)" text-anchor="middle" filter="url(#sidebarTextShadowLight)">ceoDOC.it<tspan font-size="14" baseline-shift="super">  ¬Æ</tspan></text>
      <text x="180" y="242" font-family="'Segoe UI',Arial,sans-serif" font-size="24" font-weight="500" fill="currentColor" text-anchor="middle" filter="url(#sidebarTextShadowLight)">Business Intelligence Platform</text>
    </svg>
  
</div>
  <div class="sidebar-menu" id="sidebar-menu">
    <button class="sidebar-link" data-section="home" onclick="showWelcome()"><svg width="16" height="16"><use href="#i-doc"/></svg> Home</button>
    <button class="sidebar-link" data-section="dashboard" onclick="showDashboard()"><svg width="16" height="16"><use href="#i-chart"/></svg> Dashboard</button>
    <button class="sidebar-link" data-section="anagrafica" onclick="showAnagrafica()"><svg width="16" height="16"><use href="#i-pencil"/></svg> Inserisci Anagrafica</button>
<button class="sidebar-link" data-section="info" onclick="showLib('info&credits.html','Info & Credits')"><svg width="16" height="16"><use href="#i-info"/></svg> Info & Credits</button>
    <button class="sidebar-link" data-section="normativa" onclick="showLib('normativa.html','Normativa')"><svg width="16" height="16"><use href="#i-scale"/></svg> Normativa</button>
    <button class="sidebar-link" data-section="licenze" onclick="showLib('tipologialicenze.html','Tipologia licenze')"><svg width="16" height="16"><use href="#i-lock-license"/></svg> Tipologia licenze</button>
    <button class="sidebar-link" data-section="attiva" onclick="attivaLicenza()"><svg width="16" height="16" style="margin-right:6px"><use href="#i-key"/></svg> Attiva Licenza</button>
  </div>

  <!-- Footer: Chatbot > Anagrafica attiva > link > copyright -->
  <div class="sidebar-footer">
    <button class="sidebar-chat" onclick="openChat()">
      <svg width="28" height="28" style="flex-shrink:0">
        <use href="#i-chatbot"/>
      </svg>
      <div style="font-weight:700">Chiedi a ceoDOC<span style="font-size:10px;vertical-align:super;font-weight:900">¬Æ</span></div>
    </button>

    <div class="active-company" id="active-company">
  <h4>ANAGRAFICA ATTIVA</h4>
  <div class="row"><div class="k">Ragione Sociale</div><div class="v" id="ac-rs">‚Äî</div></div>
  <div class="row"><div class="k">Codice Fiscale</div><div class="v" id="ac-cf">‚Äî</div></div>
  <div class="row"><div class="k">Sede</div><div class="v" id="ac-sede">‚Äî</div></div>
<div class="row"><div class="k">Settore</div><div class="v" id="ac-settore">‚Äî</div></div>
<div style="margin:12px 0;border-top:1px solid #d9ecff"></div>
<div class="row"><div class="k bold">Anagrafiche salvate</div><div class="v bold" id="ac-used">0</div></div>
</div>

    <div class="links">
  <a onclick="showLib('disclaimer.html','Disclaimer')">Disclaimer</a>
  <a onclick="showLib('privacy.html','Privacy')">Privacy</a>
  <a onclick="showLib('cookie.html','Cookie Policy')">Cookie</a>
  <a onclick="showLib('version.html','Versione')" >Versione</a>
</div>

    <div style="margin-top:6px;font-size:.6rem;color:#555;text-align:center">
      ¬© 2025 CSESPHERA SRL<br> Tutti i diritti riservati<br><em>ceoDOC.it¬Æ √® un marchio registrato</em>
    </div>
  </div>
</nav>

<!-- ================= MAIN ================= -->
<main id="main-content">
  <header class="main-header">
    <div class="header-content">
      <svg class="header-logo" id="dynamic-logo" viewBox="0 0 280 110" aria-hidden="true"></svg>
      <div class="header-text">
        <h1 class="header-title" id="header-title">ceoDOC.it</h1>
        <p class="header-subtitle" id="header-subtitle">Business Intelligence Platform</p>
      </div>
      <div class="header-buttons">
        <!-- MODIFICA: Sostituito "Dati Licenza" con "Profilo Utente" -->
        <button onclick="showProfilo()"><svg width="14" height="14"><use href="#i-user"/></svg> Profilo Utente</button>
       <button onclick="apriSelezionaAnagrafica()"><svg width="14" height="14"><use href="#i-users"/></svg> Seleziona Anagrafica</button>
        <!-- MODIFICA: Aggiunto tooltip su backup -->
        <div class="tooltip-wrapper">
<button onclick="esportaBackup()"><svg width="14" height="14"><use href="#i-arrow-up"/></svg> Backup</button>
          <div class="tooltip-content warning">
            <strong>üíæ Backup Importante!</strong><br>
            I dati sono salvati solo nel browser.<br>
            Se cambi PC o browser, perderai tutto.<br>
            Fai backup regolari per non perdere il lavoro!
          </div>
        </div>
<button onclick="ripristinaBackup()"><svg width="14" height="14"><use href="#i-arrow-down"/></svg> Ripristina</button>
<button onclick="toggleDarkMode()" title="Tema scuro/chiaro"><svg width="14" height="14"><use href="#i-theme"/></svg> Tema</button>
        <input id="fileRestore" type="file" accept=".json" style="display:none" onchange="if(this.files[0]) importaBackup(this.files[0])"/>
        <button class="ghost" id="btn-torna-dashboard" style="display:none" onclick="showDashboard()"><svg width="14" height="14"><use href="#i-arrow-left"/></svg>Torna Dashboard</button>
      </div>
    </div>
  </header>

  <section class="content-area">
    <div class="content-card" id="content-card">
      <div id="license-overlay"><div class="msg" id="license-overlay-msg"></div></div>
      <div id="card-content"></div>
    </div>
  </section>
</main>

<!-- ===== PANNELLO CHAT ===== -->
<div id="chat-panel" aria-hidden="true">
  <div id="chat-head">
    <div id="chat-left">
      <svg width="40" height="40" style="flex-shrink:0">
        <use href="#i-chatbot"/>
      </svg>
      <div>
        <div id="chat-title">Chiedi a ceoDOC<span style="font-size:12px;vertical-align:super;font-weight:900">¬Æ</span></div>
        <div id="chat-slogan">Intelligence Platform ‚Äî Anticipa le mosse nel tuo Business</div>
      </div>
    </div>
    <button id="chat-close" onclick="closeChat()">Chiudi</button>
  </div>
  <div id="chat-body">
    <iframe id="chat-iframe" src="" title="Chat ceoDOC"></iframe>
  </div>
</div>

<!-- ================= MODALI ================= -->

<!-- Registrazione Utente (primo accesso) -->
<div id="modalRegistrazione" class="modal-bg hidden">
  <div class="modal-card">
    <h3>Registrazione Utente - Prima Configurazione</h3>
    <div class="legal-notice">
      <strong>‚ö†Ô∏è Dati Fiscali Permanenti</strong><br>
      Questi dati verranno utilizzati per tutti i report e documenti ufficiali.<br>
      Non potranno essere modificati dopo la registrazione.
    </div>
    <div class="grid">
      <div>
        <label>Nome *</label>
        <input type="text" id="regNome" placeholder="Mario" required>
      </div>
      <div>
        <label>Cognome *</label>
        <input type="text" id="regCognome" placeholder="Rossi" required>
      </div>
    </div>
    <div style="margin-top:10px">
      <label>Codice Fiscale *</label>
      <input type="text" id="regCF" placeholder="RSSMRA80A01H501Z" maxlength="16" style="text-transform:uppercase" required>
    </div>
    <div style="margin-top:10px">
      <label>Ruolo/Qualifica *</label>
      <input type="text" id="regRuolo" placeholder="es. Amministratore Delegato" required>
    </div>
    <div style="margin-top:10px">
      <label>Email *</label>
      <input type="email" id="regEmail" placeholder="mario.rossi@azienda.it" required>
    </div>
    <div style="margin-top:20px;display:flex;gap:10px">
      <button onclick="salvaRegistrazione()">
        <svg width="14" height="14" style="vertical-align:-2px;margin-right:6px"><use href="#i-save"/></svg>
        Salva e Procedi
      </button>
    </div>
    <div id="msgRegistrazione" style="color:#d32f2f;margin-top:15px;font-weight:600"></div>
  </div>
</div>

<!-- Attivazione Licenza -->
<div id="modalLicenza" class="modal-bg hidden">
  <div class="modal-card">
    <h3>Attivazione Licenza</h3>
    <div class="legal-notice"><strong>Licenza Personale - Uso Riservato</strong><br>Questa copia √® concessa esclusivamente all'utente autorizzato. Ogni abuso sar√† perseguito.</div>
    <div class="grid">
      <div><label>File licenza (.txt)</label><input type="file" id="fileLicenza" accept=".txt"></div>
      <div><label>Codice licenza (opzionale)</label><input type="text" id="inputLicenza" placeholder="es. BILANCI4_H&Y3L365|cacf-ab-bh"></div>
    </div>
   <div style="margin-top:10px" id="utenteContainer">
  <label>Utente Registrato</label>
  <div id="utenteDisplay" style="padding:10px;background:#f0f0f0;border-radius:8px;font-weight:600">
    <!-- Verr√† popolato da JavaScript -->
  </div>
</div>
    <div style="margin-top:20px;display:flex;gap:10px">
      <button onclick="confermaLicenza()"><svg width="14" height="14" style="vertical-align:-2px;margin-right:6px"><use href="#i-key"/></svg>Attiva Licenza</button>
      <button onclick="chiudiLicenzaModal()" class="secondary"><svg width="14" height="14" style="vertical-align:-2px;margin-right:6px"><use href="#i-x"/></svg>Annulla</button>
    </div>
    <div id="msgLicenza" style="color:#d32f2f;margin-top:15px;font-weight:600"></div>
  </div>
</div>

<!-- MODIFICA: Seleziona / Gestisci Anagrafica con colonna Modifica -->
<div id="modalSelAzienda" class="modal-bg hidden">
  <div class="modal-card" style="width:min(1000px,96%)">
    <h3>Seleziona / Gestisci Anagrafiche</h3>

    <div class="grid" style="grid-template-columns:1fr 1fr 1fr">
      <!-- Carica -->
      <div>
        <label>Carica</label>
        <select id="selAziende" style="width:100%;padding:10px;border:2px solid #e5e7eb;border-radius:10px;font-size:12px"></select>
        <div style="margin-top:10px;display:flex;gap:10px">
          <button onclick="selezionaAnagraficaSalva()">Carica</button>
        </div>
      </div>

      <!-- Modifica -->
      <div>
        <label style="color:#f59e0b">Modifica</label>
        <select id="selAziendeEdit" style="width:100%;padding:10px;border:2px solid #e5e7eb;border-radius:10px;font-size:12px"></select>
        <div style="margin-top:10px;display:flex;gap:10px">
          <button class="secondary" style="background:#fff;border:2px solid #fbbf24;color:#f59e0b" onclick="modificaAnagrafica()">Modifica</button>
        </div>
      </div>

      <!-- Elimina -->
      <div>
        <label style="color:#b91c1c">Elimina</label>
        <select id="selAziendeDel" style="width:100%;padding:10px;border:2px solid #e5e7eb;border-radius:10px;font-size:12px"></select>
        <div style="margin-top:10px;display:flex;gap:10px">
          <button class="secondary" style="background:#fff;border:2px solid #f3b1b1;color:#b50000" onclick="eliminaAnagrafica()">Elimina</button>
        </div>
      </div>
    </div>

    <div id="msgSelAzienda" style="margin-top:10px;color:#d32f2f;font-weight:600"></div>

    <div style="margin-top:14px;display:flex;gap:10px;justify-content:flex-end">
      <button class="secondary" onclick="document.getElementById('modalSelAzienda').classList.add('hidden')">Chiudi</button>
    </div>
  </div>
</div>

<!-- INTEGRAZIONE 2: Modal Profilo Utente -->
<div id="modal-profilo" class="modal-profilo">
  <div class="modal-profilo-content">
    <div class="profilo-header">
  <button class="profilo-close" onclick="chiudiProfilo()">√ó</button>
  <h2 style="margin:0;font-size:24px;font-weight:600">Profilo Utente</h2>
  <p style="margin:5px 0 0 0;font-size:16px;opacity:0.9" id="profiloNomeUtente">‚Äî</p>
</div>
    
    <div class="profilo-body">
  <!-- Dati Fiscali Utente -->
  <div class="profilo-section" id="sezione-dati-utente" style="display:none">
    <h3><svg width="20" height="20"><use href="#i-user"/></svg> Dati Fiscali Registrati</h3>
    <div class="profilo-info-grid">
      <div class="profilo-info-item">
        <div class="profilo-info-label">Nome e Cognome</div>
        <div class="profilo-info-value" id="profiloDatiNome">‚Äî</div>
      </div>
      <div class="profilo-info-item">
        <div class="profilo-info-label">Codice Fiscale</div>
        <div class="profilo-info-value" id="profiloDatiCF">‚Äî</div>
      </div>
      <div class="profilo-info-item">
        <div class="profilo-info-label">Ruolo/Qualifica</div>
        <div class="profilo-info-value" id="profiloDatiRuolo">‚Äî</div>
      </div>
      <div class="profilo-info-item">
        <div class="profilo-info-label">Email</div>
        <div class="profilo-info-value" id="profiloDatiEmail">‚Äî</div>
      </div>
    </div>
  </div>
  
  <!-- Informazioni Licenza -->
  <div class="profilo-section">
        <h3><svg width="20" height="20"><use href="#i-key"/></svg> Licenza Attiva</h3>
        <div class="profilo-info-grid">
          <div class="profilo-info-item">
            <div class="profilo-info-label">Tipo Licenza</div>
            <div class="profilo-info-value" id="profiloTipoLicenza">‚Äî</div>
          </div>
          <div class="profilo-info-item">
            <div class="profilo-info-label">Stato</div>
            <div class="profilo-info-value" id="profiloStato" style="color:#10b981;font-weight:700">‚úÖ Attiva</div>
          </div>
          <div class="profilo-info-item" style="grid-column:1/-1">
            <div class="profilo-info-label">Moduli Abilitati</div>
            <div class="profilo-info-value" id="profiloModuli" style="font-size:14px;line-height:1.5">‚Äî</div>
          </div>
          <div class="profilo-info-item">
            <div class="profilo-info-label">Data Attivazione</div>
            <div class="profilo-info-value" id="profiloDataAttivazione">‚Äî</div>
          </div>
          <div class="profilo-info-item">
            <div class="profilo-info-label">Scadenza</div>
            <div class="profilo-info-value" id="profiloScadenza">‚Äî</div>
          </div>
        </div>
      </div>
      
      <!-- Anagrafiche -->
      <div class="profilo-section">
        <h3><svg width="20" height="20"><use href="#i-chart"/></svg> Anagrafiche</h3>
        <div class="profilo-info-grid">
          <div class="profilo-info-item">
            <div class="profilo-info-label">Salvate</div>
            <div class="profilo-info-value" id="profiloAnagraficheSalvate">0</div>
          </div>
          <div class="profilo-info-item">
            <div class="profilo-info-label">Limite</div>
            <div class="profilo-info-value" id="profiloAnagraficheLimite">Illimitate</div>
          </div>
        </div>
      </div>
      
<!-- Azioni -->
      <div class="profilo-actions">
        <div class="tooltip-wrapper" style="display:inline-block">
          <button class="btn-aggiorna" onclick="aggiornaLicenza()">Cambia Licenza</button>
          <div class="tooltip-content" style="width:250px">Passa a una licenza superiore con pi√π moduli</div>
        </div>
        <div class="tooltip-wrapper" style="display:inline-block">
          <button class="btn-rinnova" onclick="rinnovaOnline()">Rinnova Online</button>
          <div class="tooltip-content" style="width:250px">Rinnova la licenza in scadenza o scaduta</div>
        </div>
        <div class="tooltip-wrapper" style="display:inline-block">
          <button class="btn-controlla" onclick="controllaAggiornamenti()">Controlla<br>Aggiornamenti</button>
          <div class="tooltip-content" style="width:250px">Verifica se ci sono nuove versioni dell'app</div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal Modifica Anagrafica -->
<div id="modalModificaAnagrafica" class="modal-bg hidden">
  <div class="modal-card">
    <h3>Modifica Anagrafica</h3>
    <input type="hidden" id="modifica-id">
    <input type="hidden" id="modifica-cf-originale">
    
    <div class="anagrafica-grid">
      <div class="anagrafica-field">
        <label>Denominazione</label>
        <input id="modifica-denominazione" placeholder="Denominazione">
      </div>
      <div class="anagrafica-field">
        <label>Natura Giuridica</label>
        <select id="modifica-natura">
          <option value="">-- scegli --</option>
          <option value="SC">SC - Societ√† di Capitali</option>
          <option value="SP">SP - Societ√† di Persone</option>
          <option value="DI">DI - Ditta Individuale</option>
        </select>
      </div>
      <div class="anagrafica-field">
        <label>Settore</label>
        <select id="modifica-settore">
  <option value="">-- Seleziona --</option>
  <option value="AGRICOLTURA">Agricoltura</option>
  <option value="INDUSTRIA">Industria</option>
  <option value="EDILIZIA">Edilizia</option>
  <option value="COMMERCIO">Commercio</option>
  <option value="IMMOBILIARE">Immobiliare</option>
  <option value="SERVIZI">Servizi</option>
  <option value="ALTRO">Altro</option>
</select>
      </div>
      <div class="anagrafica-field">
        <label>Sede</label>
        <input id="modifica-sede" placeholder="es. Milano">
      </div>
      <div class="anagrafica-field" id="campo-cf-update" style="display:none">
        <label>Nuovo Codice Fiscale</label>
        <input id="modifica-cf-nuovo" placeholder="Nuovo CF societ√†">
        <small style="color:#f59e0b">Aggiorna CF solo per trasformazione DI ‚Üí Societ√†</small>
      </div>
    </div>
    
    <div style="margin-top:20px;display:flex;gap:10px">
      <button onclick="salvaModificheAnagrafica()">Salva Modifiche</button>
      <button onclick="chiudiModificaAnagrafica()" class="secondary">Annulla</button>
    </div>
  </div>
</div>

<!-- ================= SCRIPT ================= -->
<script>
/* ======================================================
   STORAGE "SAFE"
   ====================================================== */
const memoryStorage={};
function setStorage(k,v){try{localStorage.setItem(k,v);memoryStorage[k]=v}catch(e){memoryStorage[k]=v}}
function getStorage(k){try{const v=localStorage.getItem(k);return v!==null?v:(memoryStorage[k]||null)}catch(e){return memoryStorage[k]||null}}
function removeStorage(k){try{localStorage.removeItem(k)}catch(e){}memoryStorage[k]=null}

/* ======================================================
   NUOVO SISTEMA LICENZE
   ====================================================== */
// ==================================================
// HASH DELLE LICENZE (NON LE LICENZE IN CHIARO)
// ==================================================
const LICENSE_HASHES = [
  "Q1JJU0sxX1hAMzlQXzMw",
  "Q1JJU0sxXzNOUyEyXzMw",
  "Q1JJU0sxXzJYQFAlXzMw",
  "Q1JJU0sxXzVVMUBIXzMw",
  "Q1JJU0sxXzklSzM5XzMw",
  "Q1JJU0sxX0IlRiE5XzMw",
  "Q1JJU0sxXzQjJFJHXzMw",
  "Q1JJU0sxX0dWIUozXzMw",
  "Q1JJU0sxXzkwI0Y5XzMw",
  "Q1JJU0sxX0xAJSYyXzMw",
  "Q1JJU0sxX01BQTMjXzMw",
  "Q1JJU0sxX1VCQFQzXzMw",
  "Q1JJU0sxX1VAOE8kXzMw",
  "Q1JJU0sxX0JAUCY1XzMw",
  "Q1JJU0sxX1JIQFg1XzMw",
  "Q1JJU0sxXzE4JVBYXzMw",
  "Q1JJU0sxXyQwNFVMXzMw",
  "Q1JJU0sxXzA0JVQyXzMw",
  "Q1JJU0sxXzZIOCFTXzMw",
  "Q1JJU0sxXzgyMCRTXzMw",
  "Q1JJU0sxX1Y4JiRIXzMw",
  "Q1JJU0sxXzlZI1Q0XzMw",
  "Q1JJU0sxX0NAM0EwXzMw",
  "Q1JJU0sxX0Y5JThPXzMw",
  "Q1JJU0sxX1pYJTFZXzMw",
  "Q1JJU0sxX0VaQCE1XzMw",
  "Q1JJU0sxXyREQ0Y5XzMw",
  "Q1JJU0sxX1IlWjJLXzMw",
  "Q1JJU0sxXyRDWDBOXzMw",
  "Q1JJU0sxX05ZJjFDXzMw",
  "Q1JJU0sxX04mMjRWXzMw",
  "Q1JJU0sxXzMhVkhTXzMw",
  "Q1JJU0sxXzlTOCZMXzMw",
  "Q1JJU0sxXzgxSEgkXzMw",
  "Q1JJU0sxX05HMSRKXzMw",
  "Q1JJU0sxXzZBRSNKXzMw",
  "Q1JJU0sxXyRPRkwxXzMw",
  "Q1JJU0sxX0ElMkExXzMw",
  "Q1JJU0sxX1chNDlVXzMw",
  "Q1JJU0sxX1RLUiM5XzMw",
  "Q1JJU0sxX01AM1JYXzMw",
  "Q1JJU0sxXzcmMFE0XzMw",
  "Q1JJU0sxXyEmWEQ5XzMw",
  "Q1JJU0sxXzEjRE9EXzMw",
  "Q1JJU0sxX1UkTyM3XzMw",
  "Q1JJU0sxX0RVIUE3XzMw",
  "Q1JJU0sxX0gwVyFaXzMw",
  "Q1JJU0sxX1kmODZJXzMw",
  "Q1JJU0sxXyNQMiYyXzMw",
  "Q1JJU0sxXyFFIUs1XzMw",
  // 50 hash
  "Q1JJU0sxX1ojMEY4XzYw",
  "Q1JJU0sxX0smNiFGXzYw",
  "Q1JJU0sxXyNZRjYhXzYw",
  "Q1JJU0sxXyZQI1Y2XzYw",
  "Q1JJU0sxX0tAVjBVXzYw",
  "Q1JJU0sxXzdRMEBXXzYw",
  "Q1JJU0sxXzMkUzk4XzYw",
  "Q1JJU0sxX0AjVVYzXzYw",
  "Q1JJU0sxX1ghN1chXzYw",
  "Q1JJU0sxX08hNVNFXzYw",
  "Q1JJU0sxXzE4WCZYXzYw",
  "Q1JJU0sxXzUlSEQyXzYw",
  "Q1JJU0sxXzBZM04mXzYw",
  "Q1JJU0sxXyUlS0E1XzYw",
  "Q1JJU0sxX0BURjFaXzYw",
  "Q1JJU0sxXyYkWDNYXzYw",
  "Q1JJU0sxXzdMJTMjXzYw",
  "Q1JJU0sxX00mMSVBXzYw",
  "Q1JJU0sxXzklSjBKXzYw",
  "Q1JJU0sxX1UhQjQkXzYw",
  "Q1JJU0sxX1chSFg5XzYw",
  "Q1JJU0sxXyVaMkBFXzYw",
  "Q1JJU0sxX1cmOCZLXzYw",
  "Q1JJU0sxX0Q0U0BBXzYw",
  "Q1JJU0sxXzZMRyZJXzYw",
  "Q1JJU0sxX09WIzlXXzYw",
  "Q1JJU0sxX083SiExXzYw",
  "Q1JJU0sxX08hMCRUXzYw",
  "Q1JJU0sxX0kwIUdHXzYw",
  "Q1JJU0sxXyNTOSRZXzYw",
  "Q1JJU0sxX0wyUCMlXzYw",
  "Q1JJU0sxX0MhUjU3XzYw",
  "Q1JJU0sxX0QlN0EjXzYw",
  "Q1JJU0sxX04mOEA4XzYw",
  "Q1JJU0sxX1RRRUAzXzYw",
  "Q1JJU0sxX0hMQDU4XzYw",
  "Q1JJU0sxXzBAQ0Y5XzYw",
  "Q1JJU0sxX0A3SyQmXzYw",
  "Q1JJU0sxX1kkVjZFXzYw",
  "Q1JJU0sxX1kkUyQzXzYw",
  "Q1JJU0sxX1g0JlRNXzYw",
  "Q1JJU0sxXzRMVEBYXzYw",
  "Q1JJU0sxX1A3I0UlXzYw",
  "Q1JJU0sxXzc3IVQ5XzYw",
  "Q1JJU0sxX0EkNFZGXzYw",
  "Q1JJU0sxXzkjITVZXzYw",
  "Q1JJU0sxX1AzOCY4XzYw",
  "Q1JJU0sxXyRBVyY1XzYw",
  "Q1JJU0sxXzBEISNDXzYw",
  "Q1JJU0sxX1ImWUMzXzYw",
  // 100 hash
  "Q1JJU0sxXzUjQ0NSXzkw",
  "Q1JJU0sxX0FNQFIwXzkw",
  "Q1JJU0sxX0U0SiNRXzkw",
  "Q1JJU0sxXzVJJlE2Xzkw",
  "Q1JJU0sxX1kjM1NOXzkw",
  "Q1JJU0sxX1FJRkA0Xzkw",
  "Q1JJU0sxX0chNUJNXzkw",
  "Q1JJU0sxX09YMCMxXzkw",
  "Q1JJU0sxX1kwIVRaXzkw",
  "Q1JJU0sxX1AkN0AhXzkw",
  "Q1JJU0sxX0U3QDRSXzkw",
  "Q1JJU0sxXzVOQEghXzkw",
  "Q1JJU0sxXyVNQUwwXzkw",
  "Q1JJU0sxX0hCMkBOXzkw",
  "Q1JJU0sxXzFLUiZVXzkw",
  "Q1JJU0sxXzcwJUQmXzkw",
  "Q1JJU0sxXzclViVQXzkw",
  "Q1JJU0sxXzI3JkRGXzkw",
  "Q1JJU0sxXzBCTEskXzkw",
  "Q1JJU0sxX0o0RkYhXzkw",
  "Q1JJU0sxX0w0UyVKXzkw",
  "Q1JJU0sxX1IzViVIXzkw",
  "Q1JJU0sxX0ZAI0k1Xzkw",
  "Q1JJU0sxXzJVSFkkXzkw",
  "Q1JJU0sxX00yI1kzXzkw",
  "Q1JJU0sxX1lKJTYyXzkw",
  "Q1JJU0sxXzBAWkQwXzkw",
  "Q1JJU0sxX0VBIzIyXzkw",
  "Q1JJU0sxX1VMQEMxXzkw",
  "Q1JJU0sxXzAmRUVEXzkw",
  "Q1JJU0sxXyZHOFlZXzkw",
  "Q1JJU0sxX00lMkxQXzkw",
  "Q1JJU0sxXyVGMU44Xzkw",
  "Q1JJU0sxX1EjM0w0Xzkw",
  "Q1JJU0sxX0s5SiFIXzkw",
  "Q1JJU0sxX1gwJTZCXzkw",
  "Q1JJU0sxX0BURzlVXzkw",
  "Q1JJU0sxX1owU0A1Xzkw",
  "Q1JJU0sxX1QjOU5JXzkw",
  "Q1JJU0sxX1lCNiVEXzkw",
  "Q1JJU0sxX1gwTkIjXzkw",
  "Q1JJU0sxX04kNDJMXzkw",
  "Q1JJU0sxXzdNJURIXzkw",
  "Q1JJU0sxX0wkMlRMXzkw",
  "Q1JJU0sxX0ZENEojXzkw",
  "Q1JJU0sxXzNHWSRDXzkw",
  "Q1JJU0sxX0pAM1BGXzkw",
  "Q1JJU0sxX0YjMFJXXzkw",
  "Q1JJU0sxXzImTEhCXzkw",
  "Q1JJU0sxX05QNiU2Xzkw",
  // 150 hash
  "Q1JJU0sxX0BNJSU1XzE4MA==",
  "Q1JJU0sxX0QjWlY3XzE4MA==",
  "Q1JJU0sxX00mTVgyXzE4MA==",
  "Q1JJU0sxXzYlMCNZXzE4MA==",
  "Q1JJU0sxXzUhRiZJXzE4MA==",
  "Q1JJU0sxX0kkN0xRXzE4MA==",
  "Q1JJU0sxXzZCQEcjXzE4MA==",
  "Q1JJU0sxX1BOIzNOXzE4MA==",
  "Q1JJU0sxX1lPWiQ5XzE4MA==",
  "Q1JJU0sxX0gxQyUkXzE4MA==",
  "Q1JJU0sxX1UjOTdXXzE4MA==",
  "Q1JJU0sxXzg0MCNVXzE4MA==",
  "Q1JJU0sxX0FAMEZDXzE4MA==",
  "Q1JJU0sxXzUjNkNVXzE4MA==",
  "Q1JJU0sxX1EhTFYwXzE4MA==",
  "Q1JJU0sxX01UMCQ0XzE4MA==",
  "Q1JJU0sxXyQ2IThBXzE4MA==",
  "Q1JJU0sxXzhKJURTXzE4MA==",
  "Q1JJU0sxX1FGITJWXzE4MA==",
  "Q1JJU0sxXyFWJlcyXzE4MA==",
  "Q1JJU0sxX0MkJU0zXzE4MA==",
  "Q1JJU0sxX0xCJDA5XzE4MA==",
  "Q1JJU0sxX1AyJTE1XzE4MA==",
  "Q1JJU0sxX1U4IVpWXzE4MA==",
  "Q1JJU0sxX1NKI0A0XzE4MA==",
  "Q1JJU0sxX09UMCNaXzE4MA==",
  "Q1JJU0sxX0FASzdGXzE4MA==",
  "Q1JJU0sxX1hEITMyXzE4MA==",
  "Q1JJU0sxX1hZRiE1XzE4MA==",
  "Q1JJU0sxXyVRTkk4XzE4MA==",
  "Q1JJU0sxXyE1SiMxXzE4MA==",
  "Q1JJU0sxXzNNJTckXzE4MA==",
  "Q1JJU0sxXzU0TUBOXzE4MA==",
  "Q1JJU0sxX0cjRjAxXzE4MA==",
  "Q1JJU0sxX04mMUJZXzE4MA==",
  "Q1JJU0sxXyZFQDRDXzE4MA==",
  "Q1JJU0sxX1hQJjlYXzE4MA==",
  "Q1JJU0sxX0A5WlZQXzE4MA==",
  "Q1JJU0sxXyQ2T1RaXzE4MA==",
  "Q1JJU0sxX0VFIVg4XzE4MA==",
  "Q1JJU0sxX0clS0U1XzE4MA==",
  "Q1JJU0sxX0QlTkw3XzE4MA==",
  "Q1JJU0sxXzRQIVRSXzE4MA==",
  "Q1JJU0sxX1c3VSVBXzE4MA==",
  "Q1JJU0sxX0clSSM5XzE4MA==",
  "Q1JJU0sxX08hNSE4XzE4MA==",
  "Q1JJU0sxX002MSRHXzE4MA==",
  "Q1JJU0sxXzJBJjFFXzE4MA==",
  "Q1JJU0sxX01PWiM1XzE4MA==",
  "Q1JJU0sxXyVNNTlVXzE4MA==",
  // 200 hash
  "Q1JJU0sxX1ohMCRSXzM2NQ==",
  "Q1JJU0sxXzRDNyZKXzM2NQ==",
  "Q1JJU0sxX0YlOFEzXzM2NQ==",
  "Q1JJU0sxXzYxSSZUXzM2NQ==",
  "Q1JJU0sxXyFBRCQ2XzM2NQ==",
  "Q1JJU0sxXyU3JEZPXzM2NQ==",
  "Q1JJU0sxX1QlNUBaXzM2NQ==",
  "Q1JJU0sxXyFJWFI2XzM2NQ==",
  "Q1JJU0sxX1QyJFRaXzM2NQ==",
  "Q1JJU0sxX1lFM0BZXzM2NQ==",
  "Q1JJU0sxX1lZQEw1XzM2NQ==",
  "Q1JJU0sxXyY2ITBCXzM2NQ==",
  "Q1JJU0sxXyZEOEVMXzM2NQ==",
  "Q1JJU0sxXzQjOUBLXzM2NQ==",
  "Q1JJU0sxX05AMkpQXzM2NQ==",
  "Q1JJU0sxX0NNIVU0XzM2NQ==",
  "Q1JJU0sxX0dAMTZWXzM2NQ==",
  "Q1JJU0sxX0xAUDRDXzM2NQ==",
  "Q1JJU0sxX1pAOEhZXzM2NQ==",
  "Q1JJU0sxX0hHJkM1XzM2NQ==",
  "Q1JJU0sxX1pIJFQzXzM2NQ==",
  "Q1JJU0sxX0RRJTUwXzM2NQ==",
  "Q1JJU0sxX1ImM0NAXzM2NQ==",
  "Q1JJU0sxXyZNJTJJXzM2NQ==",
  "Q1JJU0sxXzg4JUU2XzM2NQ==",
  "Q1JJU0sxX0taJTE2XzM2NQ==",
  "Q1JJU0sxX1klSUY2XzM2NQ==",
  "Q1JJU0sxX0pAVUYyXzM2NQ==",
  "Q1JJU0sxX0YwJTg5XzM2NQ==",
  "Q1JJU0sxXzEjRDFHXzM2NQ==",
  "Q1JJU0sxX0pOMiZFXzM2NQ==",
  "Q1JJU0sxX01OSiY5XzM2NQ==",
  "Q1JJU0sxX0tCIzFKXzM2NQ==",
  "Q1JJU0sxX1ckNU8lXzM2NQ==",
  "Q1JJU0sxX1FMQEw0XzM2NQ==",
  "Q1JJU0sxX0EmMEcyXzM2NQ==",
  "Q1JJU0sxX0swJUlOXzM2NQ==",
  "Q1JJU0sxX1IwQFJXXzM2NQ==",
  "Q1JJU0sxX1cjNkpYXzM2NQ==",
  "Q1JJU0sxX1ZJNSRGXzM2NQ==",
  "Q1JJU0sxXzFII0U2XzM2NQ==",
  "Q1JJU0sxX0BNSzcyXzM2NQ==",
  "Q1JJU0sxX1AlUTNGXzM2NQ==",
  "Q1JJU0sxXzcmTTM3XzM2NQ==",
  "Q1JJU0sxX044WSRNXzM2NQ==",
  "Q1JJU0sxX1hANDVBXzM2NQ==",
  "Q1JJU0sxXzQwIzFaXzM2NQ==",
  "Q1JJU0sxX0BWNDdPXzM2NQ==",
  "Q1JJU0sxXzBANiFHXzM2NQ==",
  "Q1JJU0sxX0glM1NGXzM2NQ==",
  // 250 hash
  "QklMQU5DSTRfRlUwJlhfMzA=",
  "QklMQU5DSTRfJEwmOTRfMzA=",
  "QklMQU5DSTRfREwjN1hfMzA=",
  "QklMQU5DSTRfNUA2SThfMzA=",
  "QklMQU5DSTRfISYzWSFfMzA=",
  "QklMQU5DSTRfOEBZIVRfMzA=",
  "QklMQU5DSTRfS0ZUQDZfMzA=",
  "QklMQU5DSTRfQyRDWjJfMzA=",
  "QklMQU5DSTRfRE0kUDRfMzA=",
  "QklMQU5DSTRfOTIzVCFfMzA=",
  "QklMQU5DSTRfSldWQDNfMzA=",
  "QklMQU5DSTRfRiZROVdfMzA=",
  "QklMQU5DSTRfSlckITZfMzA=",
  "QklMQU5DSTRfNSVFMFRfMzA=",
  "QklMQU5DSTRfQUYzJjZfMzA=",
  "QklMQU5DSTRfUzMlWEVfMzA=",
  "QklMQU5DSTRfSyQ0JFVfMzA=",
  "QklMQU5DSTRfMzQyJVhfMzA=",
  "QklMQU5DSTRfJFA1TDNfMzA=",
  "QklMQU5DSTRfSSUjMTlfMzA=",
  "QklMQU5DSTRfUTVTNCFfMzA=",
  "QklMQU5DSTRfJVBXN0BfMzA=",
  "QklMQU5DSTRfJDlMIzBfMzA=",
  "QklMQU5DSTRfOTFSIUtfMzA=",
  "QklMQU5DSTRfSTZNIzhfMzA=",
  "QklMQU5DSTRfRCM4TkxfMzA=",
  "QklMQU5DSTRfVUAwTDhfMzA=",
  "QklMQU5DSTRfMU8kIUlfMzA=",
  "QklMQU5DSTRfMlolRVdfMzA=",
  "QklMQU5DSTRfTjJRJldfMzA=",
  "QklMQU5DSTRfOCQlTlNfMzA=",
  "QklMQU5DSTRfQyQkOSNfMzA=",
  "QklMQU5DSTRfSjVLQExfMzA=",
  "QklMQU5DSTRfRiNVMFRfMzA=",
  "QklMQU5DSTRfTyRIMDlfMzA=",
  "QklMQU5DSTRfSiFVOVhfMzA=",
  "QklMQU5DSTRfSUE5IzVfMzA=",
  "QklMQU5DSTRfM1YkWDRfMzA=",
  "QklMQU5DSTRfVzBSJVNfMzA=",
  "QklMQU5DSTRfMzkwJUlfMzA=",
  "QklMQU5DSTRfVVAlMDJfMzA=",
  "QklMQU5DSTRfJDhAQkJfMzA=",
  "QklMQU5DSTRfN0BMVSRfMzA=",
  "QklMQU5DSTRfWSYzM0FfMzA=",
  "QklMQU5DSTRfTDZARktfMzA=",
  "QklMQU5DSTRfSlFFJjRfMzA=",
  "QklMQU5DSTRfTSFHME9fMzA=",
  "QklMQU5DSTRfUiM4QFhfMzA=",
  "QklMQU5DSTRfWjglMVBfMzA=",
  "QklMQU5DSTRfI1A2TkJfMzA=",
  // 300 hash
  "QklMQU5DSTRfITRHUEVfNjA=",
  "QklMQU5DSTRfOEhUJjlfNjA=",
  "QklMQU5DSTRfJEU1MkpfNjA=",
  "QklMQU5DSTRfMiUlWDhfNjA=",
  "QklMQU5DSTRfSzFLJUpfNjA=",
  "QklMQU5DSTRfWDA4JElfNjA=",
  "QklMQU5DSTRfIyVRMjVfNjA=",
  "QklMQU5DSTRfJTNUMFNfNjA=",
  "QklMQU5DSTRfWiQ0QENfNjA=",
  "QklMQU5DSTRfUDhXJCNfNjA=",
  "QklMQU5DSTRfMFMhNVNfNjA=",
  "QklMQU5DSTRfQiUzWSNfNjA=",
  "QklMQU5DSTRfOVYhJldfNjA=",
  "QklMQU5DSTRfNVQyQFlfNjA=",
  "QklMQU5DSTRfNFhATE9fNjA=",
  "QklMQU5DSTRfQ0kkMk5fNjA=",
  "QklMQU5DSTRfUzVAUUxfNjA=",
  "QklMQU5DSTRfOEwlU1RfNjA=",
  "QklMQU5DSTRfRCNTOUxfNjA=",
  "QklMQU5DSTRfViU3TzBfNjA=",
  "QklMQU5DSTRfQVg4JDlfNjA=",
  "QklMQU5DSTRfWiFYNTNfNjA=",
  "QklMQU5DSTRfTTY2IUxfNjA=",
  "QklMQU5DSTRfRSE2ITdfNjA=",
  "QklMQU5DSTRfWSVIRzZfNjA=",
  "QklMQU5DSTRfNyRBT1ZfNjA=",
  "QklMQU5DSTRfIVJGOFdfNjA=",
  "QklMQU5DSTRfJkxKTjBfNjA=",
  "QklMQU5DSTRfMFFAOFBfNjA=",
  "QklMQU5DSTRfUTVCI0hfNjA=",
  "QklMQU5DSTRfSkAwViRfNjA=",
  "QklMQU5DSTRfRyMxQFFfNjA=",
  "QklMQU5DSTRfI1lUTzdfNjA=",
  "QklMQU5DSTRfNTNEJUZfNjA=",
  "QklMQU5DSTRfSyNON0hfNjA=",
  "QklMQU5DSTRfJEU1QDRfNjA=",
  "QklMQU5DSTRfNkIwJUZfNjA=",
  "QklMQU5DSTRfVjkzJUtfNjA=",
  "QklMQU5DSTRfQjglS0ZfNjA=",
  "QklMQU5DSTRfRTcySCRfNjA=",
  "QklMQU5DSTRfTSE0VlFfNjA=",
  "QklMQU5DSTRfMDhEJEtfNjA=",
  "QklMQU5DSTRfOTIlTEFfNjA=",
  "QklMQU5DSTRfIzUkQUxfNjA=",
  "QklMQU5DSTRfMVQxI0JfNjA=",
  "QklMQU5DSTRfTTQ0JkpfNjA=",
  "QklMQU5DSTRfI0E4TjBfNjA=",
  "QklMQU5DSTRfRSQ5UEVfNjA=",
  "QklMQU5DSTRfMiMhTzNfNjA=",
  "QklMQU5DSTRfQyNZMzVfNjA=",
  // 350 hash
  "QklMQU5DSTRfOEwkQUNfOTA=",
  "QklMQU5DSTRfMkJUJU9fOTA=",
  "QklMQU5DSTRfNCY4IURfOTA=",
  "QklMQU5DSTRfTDRANE1fOTA=",
  "QklMQU5DSTRfSyUlNVNfOTA=",
  "QklMQU5DSTRfMiMkQEZfOTA=",
  "QklMQU5DSTRfUTA5IVFfOTA=",
  "QklMQU5DSTRfMyRSTFBfOTA=",
  "QklMQU5DSTRfN0UwI0lfOTA=",
  "QklMQU5DSTRfRlAmODhfOTA=",
  "QklMQU5DSTRfViVaUjNfOTA=",
  "QklMQU5DSTRfUDkkOEtfOTA=",
  "QklMQU5DSTRfOSZXN1FfOTA=",
  "QklMQU5DSTRfVTFCJTNfOTA=",
  "QklMQU5DSTRfREA4RVRfOTA=",
  "QklMQU5DSTRfS0g1JkRfOTA=",
  "QklMQU5DSTRfNCM0IVJfOTA=",
  "QklMQU5DSTRfSDE2QFlfOTA=",
  "QklMQU5DSTRfUlA3JFpfOTA=",
  "QklMQU5DSTRfI1gzWDhfOTA=",
  "QklMQU5DSTRfJVgxJlNfOTA=",
  "QklMQU5DSTRfUyE1REZfOTA=",
  "QklMQU5DSTRfRVAlMjVfOTA=",
  "QklMQU5DSTRfViY1MCRfOTA=",
  "QklMQU5DSTRfOCNEM0BfOTA=",
  "QklMQU5DSTRfSDMlWVlfOTA=",
  "QklMQU5DSTRfSiU3M0xfOTA=",
  "QklMQU5DSTRfWCE4WDJfOTA=",
  "QklMQU5DSTRfSjImSlFfOTA=",
  "QklMQU5DSTRfQDVLTU5fOTA=",
  "QklMQU5DSTRfUTIwJTBfOTA=",
  "QklMQU5DSTRfJEYzMyNfOTA=",
  "QklMQU5DSTRfTkEjNUNfOTA=",
  "QklMQU5DSTRfTCM2QCRfOTA=",
  "QklMQU5DSTRfWjYlJDdfOTA=",
  "QklMQU5DSTRfUCYxMFNfOTA=",
  "QklMQU5DSTRfTkA3ViFfOTA=",
  "QklMQU5DSTRfNiVBSFpfOTA=",
  "QklMQU5DSTRfI0pSNExfOTA=",
  "QklMQU5DSTRfTlQjQDlfOTA=",
  "QklMQU5DSTRfSjglTDJfOTA=",
  "QklMQU5DSTRfN1hCJERfOTA=",
  "QklMQU5DSTRfTCM1OVVfOTA=",
  "QklMQU5DSTRfV0AlOFFfOTA=",
  "QklMQU5DSTRfRVZAUTJfOTA=",
  "QklMQU5DSTRfWTlONSRfOTA=",
  "QklMQU5DSTRfTiRLJDZfOTA=",
  "QklMQU5DSTRfQlozI1NfOTA=",
  "QklMQU5DSTRfRCYwVDhfOTA=",
  "QklMQU5DSTRfI1k4TDFfOTA=",
  // 400 hash
  "QklMQU5DSTRfM0cmUyFfMTgw",
  "QklMQU5DSTRfSyUxRU5fMTgw",
  "QklMQU5DSTRfQiFXOTlfMTgw",
  "QklMQU5DSTRfRlElNkJfMTgw",
  "QklMQU5DSTRfIzdGMDFfMTgw",
  "QklMQU5DSTRfUkA1NCZfMTgw",
  "QklMQU5DSTRfN1gjTiFfMTgw",
  "QklMQU5DSTRfMUc0RCVfMTgw",
  "QklMQU5DSTRfWUk0JiRfMTgw",
  "QklMQU5DSTRfUkclNDhfMTgw",
  "QklMQU5DSTRfRzElRUlfMTgw",
  "QklMQU5DSTRfViElNlVfMTgw",
  "QklMQU5DSTRfMVE2Jk1fMTgw",
  "QklMQU5DSTRfOFlVJUJfMTgw",
  "QklMQU5DSTRfUkomRDVfMTgw",
  "QklMQU5DSTRfSyRQVTVfMTgw",
  "QklMQU5DSTRfIzNIUjBfMTgw",
  "QklMQU5DSTRfMVQhQkZfMTgw",
  "QklMQU5DSTRfMlA5JURfMTgw",
  "QklMQU5DSTRfTUAzS1RfMTgw",
  "QklMQU5DSTRfQkQwI1VfMTgw",
  "QklMQU5DSTRfRDUkUEBfMTgw",
  "QklMQU5DSTRfJDIwS0ZfMTgw",
  "QklMQU5DSTRfMSYkUFhfMTgw",
  "QklMQU5DSTRfSjU3JVZfMTgw",
  "QklMQU5DSTRfS0k5IUhfMTgw",
  "QklMQU5DSTRfU0BLOTBfMTgw",
  "QklMQU5DSTRfITdATCRfMTgw",
  "QklMQU5DSTRfRDRWJElfMTgw",
  "QklMQU5DSTRfUzZZVSFfMTgw",
  "QklMQU5DSTRfJiNBNUlfMTgw",
  "QklMQU5DSTRfOUlARUZfMTgw",
  "QklMQU5DSTRfRzhUJFBfMTgw",
  "QklMQU5DSTRfTyU5OSRfMTgw",
  "QklMQU5DSTRfJkgyWjZfMTgw",
  "QklMQU5DSTRfUkQmNDhfMTgw",
  "QklMQU5DSTRfNCNDSkZfMTgw",
  "QklMQU5DSTRfSTNAM09fMTgw",
  "QklMQU5DSTRfN0xNNkBfMTgw",
  "QklMQU5DSTRfNUBUVDFfMTgw",
  "QklMQU5DSTRfITkmSzlfMTgw",
  "QklMQU5DSTRfIzRAQiVfMTgw",
  "QklMQU5DSTRfTVglNk9fMTgw",
  "QklMQU5DSTRfWCM0WDdfMTgw",
  "QklMQU5DSTRfQiExNEBfMTgw",
  "QklMQU5DSTRfISFZMDRfMTgw",
  "QklMQU5DSTRfMCFJITBfMTgw",
  "QklMQU5DSTRfSzczJUlfMTgw",
  "QklMQU5DSTRfMkdZRCFfMTgw",
  "QklMQU5DSTRfTUA2I0NfMTgw",
  // 450 hash
  "QklMQU5DSTRfOCRVNkZfMzY1",
  "QklMQU5DSTRfUkYjODRfMzY1",
  "QklMQU5DSTRfSzM3I0RfMzY1",
  "QklMQU5DSTRfSjMhRFlfMzY1",
  "QklMQU5DSTRfIVImODVfMzY1",
  "QklMQU5DSTRfITklSVdfMzY1",
  "QklMQU5DSTRfIUAyQ1RfMzY1",
  "QklMQU5DSTRfSyQ3UFFfMzY1",
  "QklMQU5DSTRfNzQmRSZfMzY1",
  "QklMQU5DSTRfNkRaJllfMzY1",
  "QklMQU5DSTRfV0BGQDVfMzY1",
  "QklMQU5DSTRfITZMWVZfMzY1",
  "QklMQU5DSTRfJFIlMEVfMzY1",
  "QklMQU5DSTRfJDEzJk5fMzY1",
  "QklMQU5DSTRfQ0A4RVNfMzY1",
  "QklMQU5DSTRfVzclRkpfMzY1",
  "QklMQU5DSTRfTk5AJDRfMzY1",
  "QklMQU5DSTRfTTM2NiVfMzY1",
  "QklMQU5DSTRfNzYjV1dfMzY1",
  "QklMQU5DSTRfVVYjJDVfMzY1",
  "QklMQU5DSTRfUkA2JjVfMzY1",
  "QklMQU5DSTRfT1ZAVTJfMzY1",
  "QklMQU5DSTRfRVFPJDlfMzY1",
  "QklMQU5DSTRfMyFON1BfMzY1",
  "QklMQU5DSTRfI1UzJSZfMzY1",
  "QklMQU5DSTRfWDQlOTVfMzY1",
  "QklMQU5DSTRfJDEjMUdfMzY1",
  "QklMQU5DSTRfSDMyQyRfMzY1",
  "QklMQU5DSTRfWCZBNTlfMzY1",
  "QklMQU5DSTRfJVdFMVNfMzY1",
  "QklMQU5DSTRfRTI1JkhfMzY1",
  "QklMQU5DSTRfQUA0JUdfMzY1",
  "QklMQU5DSTRfI1E4MklfMzY1",
  "QklMQU5DSTRfMSVZSVBfMzY1",
  "QklMQU5DSTRfUko4UyRfMzY1",
  "QklMQU5DSTRfVlYmOElfMzY1",
  "QklMQU5DSTRfJjcjNkdfMzY1",
  "QklMQU5DSTRfRiE0TU1fMzY1",
  "QklMQU5DSTRfRyUwWjJfMzY1",
  "QklMQU5DSTRfRiE4TlhfMzY1",
  "QklMQU5DSTRfQkdPQDdfMzY1",
  "QklMQU5DSTRfNTdRQDlfMzY1",
  "QklMQU5DSTRfVEE2I1FfMzY1",
  "QklMQU5DSTRfViRYODlfMzY1",
  "QklMQU5DSTRfMCFBQUVfMzY1",
  "QklMQU5DSTRfWFYmWTdfMzY1",
  "QklMQU5DSTRfNSE3ViNfMzY1",
  "QklMQU5DSTRfVTNTJiFfMzY1",
  "QklMQU5DSTRfMCU0VERfMzY1",
  "QklMQU5DSTRfMlU2I0tfMzY1",
  // 500 hash
  "Q09NUExJQU5DRTVfRiY3QDJfMzA=",
  "Q09NUExJQU5DRTVfNiVYJUhfMzA=",
  "Q09NUExJQU5DRTVfRVMyNSVfMzA=",
  "Q09NUExJQU5DRTVfJUFCRDZfMzA=",
  "Q09NUExJQU5DRTVfNVYhNzJfMzA=",
  "Q09NUExJQU5DRTVfIUNSJTRfMzA=",
  "Q09NUExJQU5DRTVfNEBHU1dfMzA=",
  "Q09NUExJQU5DRTVfRCUzS01fMzA=",
  "Q09NUExJQU5DRTVfUCY2MkBfMzA=",
  "Q09NUExJQU5DRTVfMzc2JFlfMzA=",
  "Q09NUExJQU5DRTVfUTVHIzNfMzA=",
  "Q09NUExJQU5DRTVfTCVJUjNfMzA=",
  "Q09NUExJQU5DRTVfWExNITFfMzA=",
  "Q09NUExJQU5DRTVfQiFIQjlfMzA=",
  "Q09NUExJQU5DRTVfTzZQTSZfMzA=",
  "Q09NUExJQU5DRTVfVzRVJFlfMzA=",
  "Q09NUExJQU5DRTVfVEA1S0tfMzA=",
  "Q09NUExJQU5DRTVfUSFSMVpfMzA=",
  "Q09NUExJQU5DRTVfVyM2MktfMzA=",
  "Q09NUExJQU5DRTVfI0JESzlfMzA=",
  "Q09NUExJQU5DRTVfTyRTSzRfMzA=",
  "Q09NUExJQU5DRTVfSzhATzNfMzA=",
  "Q09NUExJQU5DRTVfNVAkSUJfMzA=",
  "Q09NUExJQU5DRTVfWDVGWiNfMzA=",
  "Q09NUExJQU5DRTVfNVJaI0pfMzA=",
  "Q09NUExJQU5DRTVfVSMwN0xfMzA=",
  "Q09NUExJQU5DRTVfMTIhJldfMzA=",
  "Q09NUExJQU5DRTVfRyUxS0BfMzA=",
  "Q09NUExJQU5DRTVfQ0FSITZfMzA=",
  "Q09NUExJQU5DRTVfWUwmODhfMzA=",
  "Q09NUExJQU5DRTVfNEMkVlRfMzA=",
  "Q09NUExJQU5DRTVfJTJHIVVfMzA=",
  "Q09NUExJQU5DRTVfSjUjQUxfMzA=",
  "Q09NUExJQU5DRTVfVEtAOFhfMzA=",
  "Q09NUExJQU5DRTVfNDAlTFJfMzA=",
  "Q09NUExJQU5DRTVfNCZSUUVfMzA=",
  "Q09NUExJQU5DRTVfQDQ0R0dfMzA=",
  "Q09NUExJQU5DRTVfSTIkMURfMzA=",
  "Q09NUExJQU5DRTVfQSYzMVJfMzA=",
  "Q09NUExJQU5DRTVfMEBTS0lfMzA=",
  "Q09NUExJQU5DRTVfM0cjSTBfMzA=",
  "Q09NUExJQU5DRTVfMyZCMCNfMzA=",
  "Q09NUExJQU5DRTVfSSM5TUhfMzA=",
  "Q09NUExJQU5DRTVfTjA1JUtfMzA=",
  "Q09NUExJQU5DRTVfMkgjTFJfMzA=",
  "Q09NUExJQU5DRTVfVzUjJFJfMzA=",
  "Q09NUExJQU5DRTVfS1NEMkBfMzA=",
  "Q09NUExJQU5DRTVfJDhUQUFfMzA=",
  "Q09NUExJQU5DRTVfRiE1SldfMzA=",
  "Q09NUExJQU5DRTVfIzZVQEVfMzA=",
  // 550 hash
  "Q09NUExJQU5DRTVfVCUwR05fNjA=",
  "Q09NUExJQU5DRTVfNEMmSVJfNjA=",
  "Q09NUExJQU5DRTVfQSMjTDhfNjA=",
  "Q09NUExJQU5DRTVfRSY2UU5fNjA=",
  "Q09NUExJQU5DRTVfJFpUOUJfNjA=",
  "Q09NUExJQU5DRTVfMUQzJFpfNjA=",
  "Q09NUExJQU5DRTVfVSVPNTBfNjA=",
  "Q09NUExJQU5DRTVfSVk5ITJfNjA=",
  "Q09NUExJQU5DRTVfNkNANENfNjA=",
  "Q09NUExJQU5DRTVfTzhZJFFfNjA=",
  "Q09NUExJQU5DRTVfMTJSIVlfNjA=",
  "Q09NUExJQU5DRTVfVSM0JUFfNjA=",
  "Q09NUExJQU5DRTVfTkA4VFRfNjA=",
  "Q09NUExJQU5DRTVfRyUhRTNfNjA=",
  "Q09NUExJQU5DRTVfWEA5WTNfNjA=",
  "Q09NUExJQU5DRTVfNyNNTyVfNjA=",
  "Q09NUExJQU5DRTVfMiFXUFhfNjA=",
  "Q09NUExJQU5DRTVfWDdXI0xfNjA=",
  "Q09NUExJQU5DRTVfTjQlR0BfNjA=",
  "Q09NUExJQU5DRTVfODFKJk9fNjA=",
  "Q09NUExJQU5DRTVfV0A0RyRfNjA=",
  "Q09NUExJQU5DRTVfMCQwOFJfNjA=",
  "Q09NUExJQU5DRTVfNiRGVCRfNjA=",
  "Q09NUExJQU5DRTVfVSYyOU5fNjA=",
  "Q09NUExJQU5DRTVfSCVMNlJfNjA=",
  "Q09NUExJQU5DRTVfSEYkM1dfNjA=",
  "Q09NUExJQU5DRTVfQFowVDZfNjA=",
  "Q09NUExJQU5DRTVfWiZCUzlfNjA=",
  "Q09NUExJQU5DRTVfNVklODBfNjA=",
  "Q09NUExJQU5DRTVfRyQxIyVfNjA=",
  "Q09NUExJQU5DRTVfT0hDJDZfNjA=",
  "Q09NUExJQU5DRTVfSVM0VCVfNjA=",
  "Q09NUExJQU5DRTVfTCQ1JFdfNjA=",
  "Q09NUExJQU5DRTVfSSElNVdfNjA=",
  "Q09NUExJQU5DRTVfNlBPRCNfNjA=",
  "Q09NUExJQU5DRTVfTyEwNyRfNjA=",
  "Q09NUExJQU5DRTVfTiM2RiRfNjA=",
  "Q09NUExJQU5DRTVfOUkjOUBfNjA=",
  "Q09NUExJQU5DRTVfNCZXIU1fNjA=",
  "Q09NUExJQU5DRTVfJSUlWTdfNjA=",
  "Q09NUExJQU5DRTVfWiUwWCRfNjA=",
  "Q09NUExJQU5DRTVfMlEjJVlfNjA=",
  "Q09NUExJQU5DRTVfSkEmWjRfNjA=",
  "Q09NUExJQU5DRTVfMjZPVSFfNjA=",
  "Q09NUExJQU5DRTVfN0QkQTFfNjA=",
  "Q09NUExJQU5DRTVfWCVNRTlfNjA=",
  "Q09NUExJQU5DRTVfOUBAWSFfNjA=",
  "Q09NUExJQU5DRTVfVDkxQFZfNjA=",
  "Q09NUExJQU5DRTVfREgzQFNfNjA=",
  "Q09NUExJQU5DRTVfVyZJMVRfNjA=",
  // 600 hash
  "Q09NUExJQU5DRTVfR0gyJFRfOTA=",
  "Q09NUExJQU5DRTVfMCFWNkNfOTA=",
  "Q09NUExJQU5DRTVfQSQzNTVfOTA=",
  "Q09NUExJQU5DRTVfTE4kOFFfOTA=",
  "Q09NUExJQU5DRTVfJSNOTTdfOTA=",
  "Q09NUExJQU5DRTVfITIhTE5fOTA=",
  "Q09NUExJQU5DRTVfMjg4JkxfOTA=",
  "Q09NUExJQU5DRTVfUSY5IUZfOTA=",
  "Q09NUExJQU5DRTVfRSRON1dfOTA=",
  "Q09NUExJQU5DRTVfVEI4ViFfOTA=",
  "Q09NUExJQU5DRTVfTyNFM0NfOTA=",
  "Q09NUExJQU5DRTVfNE0lSzlfOTA=",
  "Q09NUExJQU5DRTVfWTJSIUNfOTA=",
  "Q09NUExJQU5DRTVfJCM1RDJfOTA=",
  "Q09NUExJQU5DRTVfMU1QNSRfOTA=",
  "Q09NUExJQU5DRTVfJURPMVFfOTA=",
  "Q09NUExJQU5DRTVfUyY4TlRfOTA=",
  "Q09NUExJQU5DRTVfI1ozVDJfOTA=",
  "Q09NUExJQU5DRTVfTCE5NTNfOTA=",
  "Q09NUExJQU5DRTVfIUsmJjFfOTA=",
  "Q09NUExJQU5DRTVfITBYQFlfOTA=",
  "Q09NUExJQU5DRTVfUSU1VDVfOTA=",
  "Q09NUExJQU5DRTVfJjEmVlpfOTA=",
  "Q09NUExJQU5DRTVfTyY5TlRfOTA=",
  "Q09NUExJQU5DRTVfVCMxIU9fOTA=",
  "Q09NUExJQU5DRTVfWDkmN1ZfOTA=",
  "Q09NUExJQU5DRTVfRCYxJERfOTA=",
  "Q09NUExJQU5DRTVfVlcxITFfOTA=",
  "Q09NUExJQU5DRTVfQSQ1Jk9fOTA=",
  "Q09NUExJQU5DRTVfQU03IVhfOTA=",
  "Q09NUExJQU5DRTVfVkkhOVFfOTA=",
  "Q09NUExJQU5DRTVfSEA5UVRfOTA=",
  "Q09NUExJQU5DRTVfSUkkNDNfOTA=",
  "Q09NUExJQU5DRTVfTjI1QEZfOTA=",
  "Q09NUExJQU5DRTVfOE41JSRfOTA=",
  "Q09NUExJQU5DRTVfIVczSFpfOTA=",
  "Q09NUExJQU5DRTVfJkBXNjJfOTA=",
  "Q09NUExJQU5DRTVfViU3R0dfOTA=",
  "Q09NUExJQU5DRTVfV04jSjhfOTA=",
  "Q09NUExJQU5DRTVfUSQxQCFfOTA=",
  "Q09NUExJQU5DRTVfMkE5MyZfOTA=",
  "Q09NUExJQU5DRTVfQjU0JVdfOTA=",
  "Q09NUExJQU5DRTVfTTBPJFFfOTA=",
  "Q09NUExJQU5DRTVfVCUxOUpfOTA=",
  "Q09NUExJQU5DRTVfMjUhUkxfOTA=",
  "Q09NUExJQU5DRTVfWCY3NlZfOTA=",
  "Q09NUExJQU5DRTVfWSFOTjZfOTA=",
  "Q09NUExJQU5DRTVfSUA0Vk1fOTA=",
  "Q09NUExJQU5DRTVfQSMzMiVfOTA=",
  "Q09NUExJQU5DRTVfVDMjUkhfOTA=",
  // 650 hash
  "Q09NUExJQU5DRTVfVyVTMFRfMTgw",
  "Q09NUExJQU5DRTVfVUg0QFNfMTgw",
  "Q09NUExJQU5DRTVfJkBAQzhfMTgw",
  "Q09NUExJQU5DRTVfMjRFRSFfMTgw",
  "Q09NUExJQU5DRTVfMTBYI0FfMTgw",
  "Q09NUExJQU5DRTVfRlcjVDVfMTgw",
  "Q09NUExJQU5DRTVfMUA5V1pfMTgw",
  "Q09NUExJQU5DRTVfN00lWCVfMTgw",
  "Q09NUExJQU5DRTVfR1cxQFJfMTgw",
  "Q09NUExJQU5DRTVfQzhGIUJfMTgw",
  "Q09NUExJQU5DRTVfVlNHJjRfMTgw",
  "Q09NUExJQU5DRTVfNFNaNSFfMTgw",
  "Q09NUExJQU5DRTVfITUlWlRfMTgw",
  "Q09NUExJQU5DRTVfN0VAM1RfMTgw",
  "Q09NUExJQU5DRTVfUyQmTTNfMTgw",
  "Q09NUExJQU5DRTVfNjUhSkJfMTgw",
  "Q09NUExJQU5DRTVfMiVXMFhfMTgw",
  "Q09NUExJQU5DRTVfVkA5NDBfMTgw",
  "Q09NUExJQU5DRTVfIURAOUdfMTgw",
  "Q09NUExJQU5DRTVfTFUmNDRfMTgw",
  "Q09NUExJQU5DRTVfME9UJjRfMTgw",
  "Q09NUExJQU5DRTVfTlJEJjJfMTgw",
  "Q09NUExJQU5DRTVfM1ckOVlfMTgw",
  "Q09NUExJQU5DRTVfIUM0NVpfMTgw",
  "Q09NUExJQU5DRTVfMFBAQSNfMTgw",
  "Q09NUExJQU5DRTVfVFVARTdfMTgw",
  "Q09NUExJQU5DRTVfJjdCMkpfMTgw",
  "Q09NUExJQU5DRTVfNkMxJFFfMTgw",
  "Q09NUExJQU5DRTVfVSU3JSFfMTgw",
  "Q09NUExJQU5DRTVfUSQ1JUFfMTgw",
  "Q09NUExJQU5DRTVfVVojMEVfMTgw",
  "Q09NUExJQU5DRTVfVUIkMUZfMTgw",
  "Q09NUExJQU5DRTVfTk0mMCFfMTgw",
  "Q09NUExJQU5DRTVfIyVJVDRfMTgw",
  "Q09NUExJQU5DRTVfI1hESTZfMTgw",
  "Q09NUExJQU5DRTVfVkFBJDhfMTgw",
  "Q09NUExJQU5DRTVfTCYzUjNfMTgw",
  "Q09NUExJQU5DRTVfTkAlM0NfMTgw",
  "Q09NUExJQU5DRTVfI1ImQzBfMTgw",
  "Q09NUExJQU5DRTVfQSEzJkpfMTgw",
  "Q09NUExJQU5DRTVfQjklUDZfMTgw",
  "Q09NUExJQU5DRTVfUyE2SDJfMTgw",
  "Q09NUExJQU5DRTVfQ0A0QVZfMTgw",
  "Q09NUExJQU5DRTVfQ0cwJEhfMTgw",
  "Q09NUExJQU5DRTVfWDQjJSZfMTgw",
  "Q09NUExJQU5DRTVfNEszUCZfMTgw",
  "Q09NUExJQU5DRTVfM0clMFhfMTgw",
  "Q09NUExJQU5DRTVfNSNMMyZfMTgw",
  "Q09NUExJQU5DRTVfR0slNEpfMTgw",
  "Q09NUExJQU5DRTVfMEUyJEZfMTgw",
  // 700 hash
  "Q09NUExJQU5DRTVfR1c5JDNfMzY1",
  "Q09NUExJQU5DRTVfJlRJJTBfMzY1",
  "Q09NUExJQU5DRTVfWDEmMktfMzY1",
  "Q09NUExJQU5DRTVfWCQ1VzNfMzY1",
  "Q09NUExJQU5DRTVfJjA2WSNfMzY1",
  "Q09NUExJQU5DRTVfNCMxJVJfMzY1",
  "Q09NUExJQU5DRTVfQEVNSDlfMzY1",
  "Q09NUExJQU5DRTVfIyZFNFdfMzY1",
  "Q09NUExJQU5DRTVfJFE4IVZfMzY1",
  "Q09NUExJQU5DRTVfNUdDJSFfMzY1",
  "Q09NUExJQU5DRTVfI1JaNURfMzY1",
  "Q09NUExJQU5DRTVfNSQ1VlpfMzY1",
  "Q09NUExJQU5DRTVfSyFLWTJfMzY1",
  "Q09NUExJQU5DRTVfMlYkRzFfMzY1",
  "Q09NUExJQU5DRTVfVSUwRFlfMzY1",
  "Q09NUExJQU5DRTVfMEcmSkBfMzY1",
  "Q09NUExJQU5DRTVfQ0oyJktfMzY1",
  "Q09NUExJQU5DRTVfM0o4QEZfMzY1",
  "Q09NUExJQU5DRTVfJDhYRjlfMzY1",
  "Q09NUExJQU5DRTVfMiNNUEBfMzY1",
  "Q09NUExJQU5DRTVfTyMzMURfMzY1",
  "Q09NUExJQU5DRTVfJCNPMUpfMzY1",
  "Q09NUExJQU5DRTVfJUsyNjZfMzY1",
  "Q09NUExJQU5DRTVfJEQjJDZfMzY1",
  "Q09NUExJQU5DRTVfTSNBN0dfMzY1",
  "Q09NUExJQU5DRTVfNyVYWDZfMzY1",
  "Q09NUExJQU5DRTVfI0FKMkVfMzY1",
  "Q09NUExJQU5DRTVfUyZDRDlfMzY1",
  "Q09NUExJQU5DRTVfQSEkMDhfMzY1",
  "Q09NUExJQU5DRTVfWTAzIVFfMzY1",
  "Q09NUExJQU5DRTVfNjU4QFlfMzY1",
  "Q09NUExJQU5DRTVfNFUhVDhfMzY1",
  "Q09NUExJQU5DRTVfRiQlNiVfMzY1",
  "Q09NUExJQU5DRTVfMSRJN1RfMzY1",
  "Q09NUExJQU5DRTVfSEIkOVpfMzY1",
  "Q09NUExJQU5DRTVfRSQwIUFfMzY1",
  "Q09NUExJQU5DRTVfVyMkQzNfMzY1",
  "Q09NUExJQU5DRTVfTSRNUDZfMzY1",
  "Q09NUExJQU5DRTVfISRXTzZfMzY1",
  "Q09NUExJQU5DRTVfNyM4T1VfMzY1",
  "Q09NUExJQU5DRTVfRDdMQEJfMzY1",
  "Q09NUExJQU5DRTVfNSVROUtfMzY1",
  "Q09NUExJQU5DRTVfVEQwJVFfMzY1",
  "Q09NUExJQU5DRTVfV08hNDRfMzY1",
  "Q09NUExJQU5DRTVfJU5LMSZfMzY1",
  "Q09NUExJQU5DRTVfNEM1JlZfMzY1",
  "Q09NUExJQU5DRTVfNEBGQTZfMzY1",
  "Q09NUExJQU5DRTVfRkMjOVBfMzY1",
  "Q09NUExJQU5DRTVfQEE0REpfMzY1",
  "Q09NUExJQU5DRTVfQFNJNlJfMzY1",
  // 750 hash
  "UExBTk5JTkczX0cjMVlMXzMw",
  "UExBTk5JTkczXzlOTVolXzMw",
  "UExBTk5JTkczX04mNFkyXzMw",
  "UExBTk5JTkczXzVJJUQ2XzMw",
  "UExBTk5JTkczX05PJDYjXzMw",
  "UExBTk5JTkczX1E1NCRFXzMw",
  "UExBTk5JTkczX1IkRThJXzMw",
  "UExBTk5JTkczXzFYUiFYXzMw",
  "UExBTk5JTkczXzcmIUQmXzMw",
  "UExBTk5JTkczX1QhMDdNXzMw",
  "UExBTk5JTkczXzI2Rk0mXzMw",
  "UExBTk5JTkczX1QlNU5UXzMw",
  "UExBTk5JTkczX1JJQSExXzMw",
  "UExBTk5JTkczX0MhMTdAXzMw",
  "UExBTk5JTkczXzUmTFAzXzMw",
  "UExBTk5JTkczXzYkVE5ZXzMw",
  "UExBTk5JTkczXzIkOFJCXzMw",
  "UExBTk5JTkczXzJOJVRMXzMw",
  "UExBTk5JTkczXzMhUFFXXzMw",
  "UExBTk5JTkczX0wyMSZIXzMw",
  "UExBTk5JTkczXyRJMEkhXzMw",
  "UExBTk5JTkczXzgmMlBWXzMw",
  "UExBTk5JTkczX1YxIVdYXzMw",
  "UExBTk5JTkczXzglR1lIXzMw",
  "UExBTk5JTkczX0NOQTkjXzMw",
  "UExBTk5JTkczX1ojTFU2XzMw",
  "UExBTk5JTkczXzNGJDZCXzMw",
  "UExBTk5JTkczX1lZJE84XzMw",
  "UExBTk5JTkczX0s4JlozXzMw",
  "UExBTk5JTkczXyE3VDZNXzMw",
  "UExBTk5JTkczX1ojMjBYXzMw",
  "UExBTk5JTkczXyRVNFM5XzMw",
  "UExBTk5JTkczXyFYWDUjXzMw",
  "UExBTk5JTkczXzRCUUBGXzMw",
  "UExBTk5JTkczX04zNSZKXzMw",
  "UExBTk5JTkczXyFFJlUzXzMw",
  "UExBTk5JTkczX1BDIUQzXzMw",
  "UExBTk5JTkczX0EjJCUwXzMw",
  "UExBTk5JTkczX1ckOUo0XzMw",
  "UExBTk5JTkczX1JOOSFRXzMw",
  "UExBTk5JTkczX0shRjAlXzMw",
  "UExBTk5JTkczX1dAMDAyXzMw",
  "UExBTk5JTkczX1JDMjQjXzMw",
  "UExBTk5JTkczXzg0NiRYXzMw",
  "UExBTk5JTkczXyVOWjRDXzMw",
  "UExBTk5JTkczX1FUQDA1XzMw",
  "UExBTk5JTkczXzdCNUkjXzMw",
  "UExBTk5JTkczXyRYSkwzXzMw",
  "UExBTk5JTkczX0IhMzckXzMw",
  "UExBTk5JTkczX0chMldHXzMw",
  // 800 hash
  "UExBTk5JTkczXyZYMVowXzYw",
  "UExBTk5JTkczX1FJJDYwXzYw",
  "UExBTk5JTkczX0FXJDNOXzYw",
  "UExBTk5JTkczX01LMyVJXzYw",
  "UExBTk5JTkczX0EkMjNIXzYw",
  "UExBTk5JTkczXzlDJUtMXzYw",
  "UExBTk5JTkczX1QhVkg3XzYw",
  "UExBTk5JTkczX1AkIThEXzYw",
  "UExBTk5JTkczX0IjNVQ0XzYw",
  "UExBTk5JTkczXyQhM1gmXzYw",
  "UExBTk5JTkczX0YmQTA2XzYw",
  "UExBTk5JTkczX0ohVDY4XzYw",
  "UExBTk5JTkczX1lWITROXzYw",
  "UExBTk5JTkczX0UmMUslXzYw",
  "UExBTk5JTkczX1RAME42XzYw",
  "UExBTk5JTkczX1RJRjMmXzYw",
  "UExBTk5JTkczX0FLJUMxXzYw",
  "UExBTk5JTkczXzFXNCNJXzYw",
  "UExBTk5JTkczX1A3IVpLXzYw",
  "UExBTk5JTkczXyZHJVo2XzYw",
  "UExBTk5JTkczX0RLSiYxXzYw",
  "UExBTk5JTkczX0A4UTZLXzYw",
  "UExBTk5JTkczX1hMMiEyXzYw",
  "UExBTk5JTkczX0gkSTcyXzYw",
  "UExBTk5JTkczX1UjMlFKXzYw",
  "UExBTk5JTkczXzQkRVlYXzYw",
  "UExBTk5JTkczXzczIVcxXzYw",
  "UExBTk5JTkczXzFDQEFWXzYw",
  "UExBTk5JTkczX0s1IU1TXzYw",
  "UExBTk5JTkczXzhYWjgmXzYw",
  "UExBTk5JTkczX083QDY4XzYw",
  "UExBTk5JTkczXzkkQlU3XzYw",
  "UExBTk5JTkczXzhBJlJQXzYw",
  "UExBTk5JTkczXzkjWlJJXzYw",
  "UExBTk5JTkczX1gjMEJFXzYw",
  "UExBTk5JTkczX1lLMkA3XzYw",
  "UExBTk5JTkczX0kwRSVKXzYw",
  "UExBTk5JTkczXzNTJUA2XzYw",
  "UExBTk5JTkczX1Q4TzJAXzYw",
  "UExBTk5JTkczXzQ0OSFPXzYw",
  "UExBTk5JTkczX00xQEtMXzYw",
  "UExBTk5JTkczXzdVQDdUXzYw",
  "UExBTk5JTkczX0lXITJZXzYw",
  "UExBTk5JTkczXzIkVzE0XzYw",
  "UExBTk5JTkczXzcmR1FBXzYw",
  "UExBTk5JTkczXyEjNSZJXzYw",
  "UExBTk5JTkczXyNGVCE3XzYw",
  "UExBTk5JTkczX0wmQTJRXzYw",
  "UExBTk5JTkczXzNRQDZAXzYw",
  "UExBTk5JTkczXyNQTkE5XzYw",
  // 850 hash
  "UExBTk5JTkczX1MjN0UzXzkw",
  "UExBTk5JTkczXyM1TTlTXzkw",
  "UExBTk5JTkczX0dEITdNXzkw",
  "UExBTk5JTkczX1ckUEE1Xzkw",
  "UExBTk5JTkczX0EjOVhYXzkw",
  "UExBTk5JTkczX0pWNTAkXzkw",
  "UExBTk5JTkczX0gmUTVXXzkw",
  "UExBTk5JTkczX1QlNTMhXzkw",
  "UExBTk5JTkczX000QDgwXzkw",
  "UExBTk5JTkczXzQ4QFdCXzkw",
  "UExBTk5JTkczX0hBQDM1Xzkw",
  "UExBTk5JTkczX1IjSzk0Xzkw",
  "UExBTk5JTkczXyZHS08yXzkw",
  "UExBTk5JTkczX1AmOUw1Xzkw",
  "UExBTk5JTkczX0RAOEtSXzkw",
  "UExBTk5JTkczX1QkMUBSXzkw",
  "UExBTk5JTkczX1JIMEBQXzkw",
  "UExBTk5JTkczXzkjTlVGXzkw",
  "UExBTk5JTkczX08jSzlNXzkw",
  "UExBTk5JTkczXzYkTUFRXzkw",
  "UExBTk5JTkczX0gmMCNJXzkw",
  "UExBTk5JTkczX1chMTNSXzkw",
  "UExBTk5JTkczXyNaM1pGXzkw",
  "UExBTk5JTkczX0sjMFoxXzkw",
  "UExBTk5JTkczXyNFSUswXzkw",
  "UExBTk5JTkczXyVVN1BFXzkw",
  "UExBTk5JTkczX1ZNUEA3Xzkw",
  "UExBTk5JTkczX0RVNEYlXzkw",
  "UExBTk5JTkczX1ZZNEA3Xzkw",
  "UExBTk5JTkczXzFFIUoyXzkw",
  "UExBTk5JTkczX09RNCZaXzkw",
  "UExBTk5JTkczXzVAWiYyXzkw",
  "UExBTk5JTkczX1dDNiE4Xzkw",
  "UExBTk5JTkczX09OIzc4Xzkw",
  "UExBTk5JTkczX1FSN0UjXzkw",
  "UExBTk5JTkczX05NNDkkXzkw",
  "UExBTk5JTkczXyZUQlQ2Xzkw",
  "UExBTk5JTkczXzRBJkw2Xzkw",
  "UExBTk5JTkczX0sjIUszXzkw",
  "UExBTk5JTkczXzkkNFRFXzkw",
  "UExBTk5JTkczXzU3MyFaXzkw",
  "UExBTk5JTkczXyYkQiM1Xzkw",
  "UExBTk5JTkczX0xAIzU4Xzkw",
  "UExBTk5JTkczXzFFJDdVXzkw",
  "UExBTk5JTkczX1AkOFVNXzkw",
  "UExBTk5JTkczX1MhNzI2Xzkw",
  "UExBTk5JTkczX1RII0E2Xzkw",
  "UExBTk5JTkczX0xWQEAyXzkw",
  "UExBTk5JTkczXyY1QSVNXzkw",
  "UExBTk5JTkczX0QhNFBUXzkw",
  // 900 hash
  "UExBTk5JTkczXzQmVFMmXzE4MA==",
  "UExBTk5JTkczX1AkNCUlXzE4MA==",
  "UExBTk5JTkczX0IjNTlCXzE4MA==",
  "UExBTk5JTkczXyU1N0IxXzE4MA==",
  "UExBTk5JTkczX00jN08wXzE4MA==",
  "UExBTk5JTkczX0pZRTIkXzE4MA==",
  "UExBTk5JTkczX04lMUc0XzE4MA==",
  "UExBTk5JTkczX0slTzVYXzE4MA==",
  "UExBTk5JTkczXyFMMyNQXzE4MA==",
  "UExBTk5JTkczXzI3JFpDXzE4MA==",
  "UExBTk5JTkczX0U0ITlaXzE4MA==",
  "UExBTk5JTkczXyU5TEY4XzE4MA==",
  "UExBTk5JTkczX0wxI1BSXzE4MA==",
  "UExBTk5JTkczX0cyOSVMXzE4MA==",
  "UExBTk5JTkczXyFGJDE0XzE4MA==",
  "UExBTk5JTkczX1pBQCEwXzE4MA==",
  "UExBTk5JTkczX0RTJTZUXzE4MA==",
  "UExBTk5JTkczXzVGUiY0XzE4MA==",
  "UExBTk5JTkczXyU5VzlRXzE4MA==",
  "UExBTk5JTkczX0c0QEs4XzE4MA==",
  "UExBTk5JTkczXyFCSiY4XzE4MA==",
  "UExBTk5JTkczX0IwQE1OXzE4MA==",
  "UExBTk5JTkczX04jMkgkXzE4MA==",
  "UExBTk5JTkczXzJWTSFXXzE4MA==",
  "UExBTk5JTkczXzNPRCROXzE4MA==",
  "UExBTk5JTkczXzNBJkVTXzE4MA==",
  "UExBTk5JTkczX1Q1JlhCXzE4MA==",
  "UExBTk5JTkczX0BBWiE3XzE4MA==",
  "UExBTk5JTkczXzVIViQmXzE4MA==",
  "UExBTk5JTkczX1BSIzVMXzE4MA==",
  "UExBTk5JTkczX0EhOFFVXzE4MA==",
  "UExBTk5JTkczXyQ2T1VQXzE4MA==",
  "UExBTk5JTkczXzUmMFZUXzE4MA==",
  "UExBTk5JTkczXyQ5VSZVXzE4MA==",
  "UExBTk5JTkczX1ElQVI0XzE4MA==",
  "UExBTk5JTkczXyRVWCYwXzE4MA==",
  "UExBTk5JTkczX1FAJVUxXzE4MA==",
  "UExBTk5JTkczXzVRJTYkXzE4MA==",
  "UExBTk5JTkczXyFATTlEXzE4MA==",
  "UExBTk5JTkczX0whIU41XzE4MA==",
  "UExBTk5JTkczX1ckNVVRXzE4MA==",
  "UExBTk5JTkczXzBPOEBWXzE4MA==",
  "UExBTk5JTkczX0QzTyRXXzE4MA==",
  "UExBTk5JTkczX0YwSiEmXzE4MA==",
  "UExBTk5JTkczXzZLI1NMXzE4MA==",
  "UExBTk5JTkczX00hMElAXzE4MA==",
  "UExBTk5JTkczXzIhVUVFXzE4MA==",
  "UExBTk5JTkczXzAmTEVXXzE4MA==",
  "UExBTk5JTkczXzJARjdPXzE4MA==",
  "UExBTk5JTkczXyZVMiEwXzE4MA==",
  // 950 hash
  "UExBTk5JTkczX0cmJUk3XzM2NQ==",
  "UExBTk5JTkczXzVGVyNLXzM2NQ==",
  "UExBTk5JTkczX04xI1haXzM2NQ==",
  "UExBTk5JTkczX0BKVCEwXzM2NQ==",
  "UExBTk5JTkczXyVBIUoxXzM2NQ==",
  "UExBTk5JTkczX01QOCFTXzM2NQ==",
  "UExBTk5JTkczXzJPJiUhXzM2NQ==",
  "UExBTk5JTkczX1JGWSMxXzM2NQ==",
  "UExBTk5JTkczXzUlRkMyXzM2NQ==",
  "UExBTk5JTkczX1FAOCZOXzM2NQ==",
  "UExBTk5JTkczX0pDNSQlXzM2NQ==",
  "UExBTk5JTkczX0RCOSQ4XzM2NQ==",
  "UExBTk5JTkczX1QlNiEhXzM2NQ==",
  "UExBTk5JTkczXyM2QCZaXzM2NQ==",
  "UExBTk5JTkczX1kmNTg2XzM2NQ==",
  "UExBTk5JTkczXzY1I00mXzM2NQ==",
  "UExBTk5JTkczX1k4NyNPXzM2NQ==",
  "UExBTk5JTkczXzUlRk43XzM2NQ==",
  "UExBTk5JTkczXzcyIVFJXzM2NQ==",
  "UExBTk5JTkczXyZRMFdYXzM2NQ==",
  "UExBTk5JTkczXzZUJENYXzM2NQ==",
  "UExBTk5JTkczXzkkOE9AXzM2NQ==",
  "UExBTk5JTkczX0UhTkQ3XzM2NQ==",
  "UExBTk5JTkczXzMlNEtGXzM2NQ==",
  "UExBTk5JTkczXzMlRDVYXzM2NQ==",
  "UExBTk5JTkczX04lV0E5XzM2NQ==",
  "UExBTk5JTkczXzMmUTRMXzM2NQ==",
  "UExBTk5JTkczX0VQOUBBXzM2NQ==",
  "UExBTk5JTkczX1okJjUyXzM2NQ==",
  "UExBTk5JTkczXyNFUjVPXzM2NQ==",
  "UExBTk5JTkczX1Y2NCFWXzM2NQ==",
  "UExBTk5JTkczX0g1UjMhXzM2NQ==",
  "UExBTk5JTkczX04mNCQzXzM2NQ==",
  "UExBTk5JTkczX0RIUiYwXzM2NQ==",
  "UExBTk5JTkczX0QmMU45XzM2NQ==",
  "UExBTk5JTkczX0pXMkUmXzM2NQ==",
  "UExBTk5JTkczX1I5IUBaXzM2NQ==",
  "UExBTk5JTkczX1QkMzRYXzM2NQ==",
  "UExBTk5JTkczX0U3MCFDXzM2NQ==",
  "UExBTk5JTkczXyUhWlA5XzM2NQ==",
  "UExBTk5JTkczX1NTITQjXzM2NQ==",
  "UExBTk5JTkczXzkkODNDXzM2NQ==",
  "UExBTk5JTkczX0RNWSEyXzM2NQ==",
  "UExBTk5JTkczXzRaITdVXzM2NQ==",
  "UExBTk5JTkczX1QwUSZDXzM2NQ==",
  "UExBTk5JTkczX1YwMDAmXzM2NQ==",
  "UExBTk5JTkczXzMhOUU2XzM2NQ==",
  "UExBTk5JTkczXzhTJjlXXzM2NQ==",
  "UExBTk5JTkczX0AlRjA2XzM2NQ==",
  "UExBTk5JTkczXzZARUBUXzM2NQ==",
  // 1000 hash
  "RlVMTDE1XyFQVDk0XzMw",
  "RlVMTDE1X1VMJTAkXzMw",
  "RlVMTDE1X0IkN0o3XzMw",
  "RlVMTDE1XzFUNiNUXzMw",
  "RlVMTDE1X01AMiRXXzMw",
  "RlVMTDE1X1U3MDMmXzMw",
  "RlVMTDE1X0FAQjhGXzMw",
  "RlVMTDE1XzJSNiFMXzMw",
  "RlVMTDE1XyVJUVk3XzMw",
  "RlVMTDE1XzIlMlNCXzMw",
  "RlVMTDE1XyM5IVcwXzMw",
  "RlVMTDE1X082MEBUXzMw",
  "RlVMTDE1X0VRNyZDXzMw",
  "RlVMTDE1X0AxUUAyXzMw",
  "RlVMTDE1X1BBMSNBXzMw",
  "RlVMTDE1X0U4VEBCXzMw",
  "RlVMTDE1XzhSJEFBXzMw",
  "RlVMTDE1XyVEUTk2XzMw",
  "RlVMTDE1XzUjS1I1XzMw",
  "RlVMTDE1X1lLQDNZXzMw",
  "RlVMTDE1XyE0TEM1XzMw",
  "RlVMTDE1X1MlNlAkXzMw",
  "RlVMTDE1X0cjODBLXzMw",
  "RlVMTDE1X1UkVDkzXzMw",
  "RlVMTDE1X1JUJSEyXzMw",
  "RlVMTDE1X0cmNUFNXzMw",
  "RlVMTDE1XzVNQUUhXzMw",
  "RlVMTDE1X1UjOEM2XzMw",
  "RlVMTDE1X0QwI09VXzMw",
  "RlVMTDE1X1hAIzZPXzMw",
  "RlVMTDE1X1AkRjZKXzMw",
  "RlVMTDE1X0BDNyFXXzMw",
  "RlVMTDE1X0s1NCVOXzMw",
  "RlVMTDE1X0w2QEwyXzMw",
  "RlVMTDE1XzdAQTRFXzMw",
  "RlVMTDE1X1RAOUA2XzMw",
  "RlVMTDE1X0s2NyNXXzMw",
  "RlVMTDE1XzdXQFFNXzMw",
  "RlVMTDE1XzIlWlIzXzMw",
  "RlVMTDE1X0c0JTdJXzMw",
  "RlVMTDE1XzBKNiZHXzMw",
  "RlVMTDE1XzgjTyYyXzMw",
  "RlVMTDE1X1MhNzk4XzMw",
  "RlVMTDE1X0JXJDIkXzMw",
  "RlVMTDE1XzkkT0YhXzMw",
  "RlVMTDE1XyUyU0YzXzMw",
  "RlVMTDE1XyVRNUs3XzMw",
  "RlVMTDE1XyFWM0k4XzMw",
  "RlVMTDE1XyVDQzdKXzMw",
  "RlVMTDE1XzgjMEM3XzMw",
  // 1050 hash
  "RlVMTDE1X09JJTlGXzYw",
  "RlVMTDE1XzFAQ1hOXzYw",
  "RlVMTDE1XzNAQURPXzYw",
  "RlVMTDE1X0g3SCVRXzYw",
  "RlVMTDE1X0U4MCU2XzYw",
  "RlVMTDE1X0AzRzBEXzYw",
  "RlVMTDE1X0QzMUA4XzYw",
  "RlVMTDE1XzAxVCRXXzYw",
  "RlVMTDE1X1dYNSVEXzYw",
  "RlVMTDE1XzU2NCVWXzYw",
  "RlVMTDE1X1ZGIUk1XzYw",
  "RlVMTDE1X1JKITJaXzYw",
  "RlVMTDE1X0tWIzVTXzYw",
  "RlVMTDE1X0cjNFRHXzYw",
  "RlVMTDE1XzAlQFBUXzYw",
  "RlVMTDE1X1hLOSZKXzYw",
  "RlVMTDE1XyRURVQ5XzYw",
  "RlVMTDE1X1UhJDY3XzYw",
  "RlVMTDE1X1IkT1kyXzYw",
  "RlVMTDE1XyQmIUwzXzYw",
  "RlVMTDE1X05AVVYwXzYw",
  "RlVMTDE1X1olNE8hXzYw",
  "RlVMTDE1X1okM0BGXzYw",
  "RlVMTDE1XzBAWEJXXzYw",
  "RlVMTDE1X0clUVMzXzYw",
  "RlVMTDE1XzdCITBHXzYw",
  "RlVMTDE1X0BFREg1XzYw",
  "RlVMTDE1XyRWTUI1XzYw",
  "RlVMTDE1X0AwJFpDXzYw",
  "RlVMTDE1X0kjMFBAXzYw",
  "RlVMTDE1X0dLJTcwXzYw",
  "RlVMTDE1X0Y1OSVFXzYw",
  "RlVMTDE1X1A1JjNFXzYw",
  "RlVMTDE1X0QzIzlIXzYw",
  "RlVMTDE1XzVFSCYjXzYw",
  "RlVMTDE1X1AlNUhGXzYw",
  "RlVMTDE1X0o5JUVTXzYw",
  "RlVMTDE1X0dQUSEyXzYw",
  "RlVMTDE1X0hLJEUwXzYw",
  "RlVMTDE1X1FWJDJIXzYw",
  "RlVMTDE1X1c1IUJQXzYw",
  "RlVMTDE1X1UlOVZZXzYw",
  "RlVMTDE1XzRHIzIlXzYw",
  "RlVMTDE1X1M2TiRNXzYw",
  "RlVMTDE1X1Y4MyUmXzYw",
  "RlVMTDE1X0IhSzBEXzYw",
  "RlVMTDE1XzM4IUBIXzYw",
  "RlVMTDE1X0cjMDglXzYw",
  "RlVMTDE1Xzg0I0hJXzYw",
  "RlVMTDE1XzlBJU5SXzYw",
  // 1100 hash
  "RlVMTDE1X0cjNFcjXzkw",
  "RlVMTDE1X0AjNCNDXzkw",
  "RlVMTDE1X08jITY1Xzkw",
  "RlVMTDE1X1YlMU8xXzkw",
  "RlVMTDE1X1gmOVkkXzkw",
  "RlVMTDE1X01YITBOXzkw",
  "RlVMTDE1XzZSNyFCXzkw",
  "RlVMTDE1X0khOEBKXzkw",
  "RlVMTDE1XyYxVk01Xzkw",
  "RlVMTDE1X1Q2WSVOXzkw",
  "RlVMTDE1XyNLSiM2Xzkw",
  "RlVMTDE1XyRZNSRDXzkw",
  "RlVMTDE1XyRKSzQ5Xzkw",
  "RlVMTDE1X0VAMTIwXzkw",
  "RlVMTDE1X1hHJjc0Xzkw",
  "RlVMTDE1X1AhNjhAXzkw",
  "RlVMTDE1X0A2I0oyXzkw",
  "RlVMTDE1XyFVNlUmXzkw",
  "RlVMTDE1X09EN1NAXzkw",
  "RlVMTDE1X1E4IUgmXzkw",
  "RlVMTDE1XyNMR1cwXzkw",
  "RlVMTDE1XzFFJEYyXzkw",
  "RlVMTDE1XyNNITlTXzkw",
  "RlVMTDE1X0YmOVBHXzkw",
  "RlVMTDE1X0NAMDNEXzkw",
  "RlVMTDE1X0Q1M0ohXzkw",
  "RlVMTDE1X1dPNEBHXzkw",
  "RlVMTDE1X00kMCQxXzkw",
  "RlVMTDE1XyEzIUUlXzkw",
  "RlVMTDE1X0BFUjZIXzkw",
  "RlVMTDE1XyUkOU9ZXzkw",
  "RlVMTDE1X0s5QSVDXzkw",
  "RlVMTDE1X1VJMEBRXzkw",
  "RlVMTDE1X0tAOCNTXzkw",
  "RlVMTDE1X0dLRiU5Xzkw",
  "RlVMTDE1XzklJFhOXzkw",
  "RlVMTDE1X0U5ITg3Xzkw",
  "RlVMTDE1X0E0SyNLXzkw",
  "RlVMTDE1X0c4SkIkXzkw",
  "RlVMTDE1XzZVTSMlXzkw",
  "RlVMTDE1XzZQNyRQXzkw",
  "RlVMTDE1X0c2MjMmXzkw",
  "RlVMTDE1X1Y1TiM5Xzkw",
  "RlVMTDE1XyNLVyY5Xzkw",
  "RlVMTDE1X0FFJEswXzkw",
  "RlVMTDE1X0slUlA5Xzkw",
  "RlVMTDE1X0lVMSRNXzkw",
  "RlVMTDE1XyExQSFOXzkw",
  "RlVMTDE1X1FANjNGXzkw",
  "RlVMTDE1X1YmMkRWXzkw",
  // 1150 hash
  "RlVMTDE1XzNZNDImXzE4MA==",
  "RlVMTDE1XzQ4JFNTXzE4MA==",
  "RlVMTDE1X1NYIzQ4XzE4MA==",
  "RlVMTDE1X0c2WCYhXzE4MA==",
  "RlVMTDE1X0BGNTVWXzE4MA==",
  "RlVMTDE1X1AhJFowXzE4MA==",
  "RlVMTDE1XzJAOCNIXzE4MA==",
  "RlVMTDE1X0AmWUExXzE4MA==",
  "RlVMTDE1X05AQjYxXzE4MA==",
  "RlVMTDE1X0omOCY3XzE4MA==",
  "RlVMTDE1XzhAUEw5XzE4MA==",
  "RlVMTDE1X0cyI01YXzE4MA==",
  "RlVMTDE1XzVNV0AxXzE4MA==",
  "RlVMTDE1X0slMlZQXzE4MA==",
  "RlVMTDE1X0cyITZaXzE4MA==",
  "RlVMTDE1X0MlRSEzXzE4MA==",
  "RlVMTDE1XyRPOCEyXzE4MA==",
  "RlVMTDE1X1JLQEQyXzE4MA==",
  "RlVMTDE1XyE1QFJGXzE4MA==",
  "RlVMTDE1X0wkQDE4XzE4MA==",
  "RlVMTDE1X0ZAMTAxXzE4MA==",
  "RlVMTDE1X0Q3WUckXzE4MA==",
  "RlVMTDE1XzMlVUY4XzE4MA==",
  "RlVMTDE1XzNJJUkjXzE4MA==",
  "RlVMTDE1XzghNCZTXzE4MA==",
  "RlVMTDE1XyRDRkI0XzE4MA==",
  "RlVMTDE1X00zJjZCXzE4MA==",
  "RlVMTDE1Xzk4JVpIXzE4MA==",
  "RlVMTDE1X0o2NiNXXzE4MA==",
  "RlVMTDE1X0VXRDIkXzE4MA==",
  "RlVMTDE1X1kmMFpYXzE4MA==",
  "RlVMTDE1XyZZUjBYXzE4MA==",
  "RlVMTDE1X0hBJkk5XzE4MA==",
  "RlVMTDE1X1pSNyFXXzE4MA==",
  "RlVMTDE1X0MlUjFIXzE4MA==",
  "RlVMTDE1X1RLI1A3XzE4MA==",
  "RlVMTDE1X1QjODZTXzE4MA==",
  "RlVMTDE1X1MhMThYXzE4MA==",
  "RlVMTDE1XzZFIU9PXzE4MA==",
  "RlVMTDE1X1RUMEBOXzE4MA==",
  "RlVMTDE1X1VaMSUhXzE4MA==",
  "RlVMTDE1X04xIUU3XzE4MA==",
  "RlVMTDE1XzlNJEtPXzE4MA==",
  "RlVMTDE1X1UyVyZPXzE4MA==",
  "RlVMTDE1X1U3QEFBXzE4MA==",
  "RlVMTDE1X00jVzghXzE4MA==",
  "RlVMTDE1X1Y4WSRUXzE4MA==",
  "RlVMTDE1X0NVNiFMXzE4MA==",
  "RlVMTDE1X09ZJU44XzE4MA==",
  "RlVMTDE1X00kNTQ1XzE4MA==",
  // 1200 hash
  "RlVMTDE1X0wlWjkmXzM2NQ==",
  "RlVMTDE1X1BMJDdAXzM2NQ==",
  "RlVMTDE1XyFWMTFBXzM2NQ==",
  "RlVMTDE1X0IkVDEyXzM2NQ==",
  "RlVMTDE1X0dAQTAhXzM2NQ==",
  "RlVMTDE1XzFOUyZAXzM2NQ==",
  "RlVMTDE1X1EhMCUyXzM2NQ==",
  "RlVMTDE1X01ONyRHXzM2NQ==",
  "RlVMTDE1XzY2I1FNXzM2NQ==",
  "RlVMTDE1XzczNCFCXzM2NQ==",
  "RlVMTDE1X0VIIzZBXzM2NQ==",
  "RlVMTDE1XzAzI0VVXzM2NQ==",
  "RlVMTDE1X0MjMTc5XzM2NQ==",
  "RlVMTDE1XzZNQiZCXzM2NQ==",
  "RlVMTDE1X0YkMFJSXzM2NQ==",
  "RlVMTDE1X1ElMkZOXzM2NQ==",
  "RlVMTDE1X0RRQyMzXzM2NQ==",
  "RlVMTDE1X1pAOSNRXzM2NQ==",
  "RlVMTDE1X0AyNlAxXzM2NQ==",
  "RlVMTDE1X1haJkY2XzM2NQ==",
  "RlVMTDE1XzdRJVMyXzM2NQ==",
  "RlVMTDE1XzIyRCNFXzM2NQ==",
  "RlVMTDE1XyRJVSY1XzM2NQ==",
  "RlVMTDE1XzklTkQyXzM2NQ==",
  "RlVMTDE1X0JUJjkxXzM2NQ==",
  "RlVMTDE1X002OSFIXzM2NQ==",
  "RlVMTDE1XzY2WlkkXzM2NQ==",
  "RlVMTDE1XyRCJTVTXzM2NQ==",
  "RlVMTDE1XyNOQDVPXzM2NQ==",
  "RlVMTDE1X01ANVExXzM2NQ==",
  "RlVMTDE1X1U5QDFCXzM2NQ==",
  "RlVMTDE1X1QxJiVZXzM2NQ==",
  "RlVMTDE1X1c0JjRPXzM2NQ==",
  "RlVMTDE1X0c5MSVMXzM2NQ==",
  "RlVMTDE1XzlCJDNPXzM2NQ==",
  "RlVMTDE1XyY2WiEzXzM2NQ==",
  "RlVMTDE1X0Q5Jk5OXzM2NQ==",
  "RlVMTDE1X0JKNyNOXzM2NQ==",
  "RlVMTDE1XzYkWFk2XzM2NQ==",
  "RlVMTDE1X0gjOTFBXzM2NQ==",
  "RlVMTDE1X0FHITI5XzM2NQ==",
  "RlVMTDE1X0FINSVTXzM2NQ==",
  "RlVMTDE1X0wjSTBPXzM2NQ==",
  "RlVMTDE1XzY1RyExXzM2NQ==",
  "RlVMTDE1X0UlM1FOXzM2NQ==",
  "RlVMTDE1XzRSQEBOXzM2NQ==",
  "RlVMTDE1X0tFMkglXzM2NQ==",
  "RlVMTDE1X1BIWEAwXzM2NQ==",
  "RlVMTDE1X0FQQTkhXzM2NQ==",
  "RlVMTDE1X0YyIzhVXzM2NQ=="
  // 1250 hash
];

// Totale: 1250 hash di licenze predefinite
// ==================================================

// Mappatura per decodifica data
const DATE_MAP = {
  'a':'0', 'b':'1', 'c':'2', 'd':'3', 'e':'4',
  'f':'5', 'g':'6', 'h':'7', 'i':'8', 'j':'9'
};

// Moduli per tipo licenza
const LICENSE_MODULES = {
  'CRISK1': ['anacrisk', 'creaPAMM','creaVERB', 'creaREPORT'],
  'BILANCI4': ['anabilCONS', 'anabilINFR', 'importaFT', 'creaSCAD', 'creaVERB', 'creaREPORT'],
  'COMPLIANCE5': ['anaadeguati', 'anaESG', 'creaBM', 'creaAS', 'creaORG', 'creaVERB', 'creaREPORT'],
  'PLANNING3': ['creaBP', 'creaSCEN', 'creaPAMM', 'creaVERB', 'creaREPORT'],
  'FULL15': ['ALL']
};

let licenzaAttiva = false;
let licenzaCorrente = null;
let licenzaInfo = null;
let activeIframe = null;

// Funzione per validare la licenza
// Funzione per validare la licenza usando hash
function isValidLicense(licenseCode) {
  const baseLicense = licenseCode.split('|')[0];
  // Genera hash della licenza base inserita
  const licenseHash = btoa(baseLicense);
  // Verifica se l'hash √® nella lista
  return LICENSE_HASHES.includes(licenseHash);
}

// Funzione per estrarre informazioni dalla licenza
function parseLicense(licenseCode) {
  const parts = licenseCode.split('|');
  if (parts.length !== 2) return null;
  
  const baseLicense = parts[0];
  const encodedDate = parts[1];
  
  // Estrai tipo e durata con il nuovo formato
  const match = baseLicense.match(/^(.+?)_(.+?)_(\d+)$/);
  if (!match) return null;
  
  return {
    type: match[1],
    code: match[2],
    duration: parseInt(match[3]),
    encodedDate: encodedDate,
    fullCode: licenseCode,
moduli: LICENSE_MODULES[match[1]] || []  // ‚Üê AGGIUNGI QUESTA RIGA
};

}

// Funzione per decodificare la data
function decodeDate(encodedDate) {
  let decoded = encodedDate;
  for (const [letter, number] of Object.entries(DATE_MAP)) {
    decoded = decoded.replace(new RegExp(letter, 'g'), number);
  }
  return decoded;
}

// Funzione per verificare se la licenza √® scaduta
function isLicenseExpired(licenseInfo) {
  if (!licenseInfo || !licenseInfo.encodedDate) return true;
  
  const activationDate = decodeDate(licenseInfo.encodedDate);
  // Assicurati che la data sia nel formato corretto YYYY-MM-DD
  const [year, month, day] = activationDate.split('-');
  const activation = new Date(parseInt(year), parseInt(month) - 1, parseInt(day));
  
  const today = new Date();
  today.setHours(0, 0, 0, 0); // Resetta l'ora per confronto corretto
  activation.setHours(0, 0, 0, 0);
  
  const daysPassed = Math.floor((today - activation) / (1000 * 60 * 60 * 24));
  
  return daysPassed > licenseInfo.duration;
}

// Funzione per ottenere i giorni rimanenti
function getDaysRemaining(licenseInfo) {
  if (!licenseInfo || !licenseInfo.encodedDate) return 0;
  
  const activationDate = decodeDate(licenseInfo.encodedDate);
  const [year, month, day] = activationDate.split('-');
  const activation = new Date(parseInt(year), parseInt(month) - 1, parseInt(day));
  
  const today = new Date();
  today.setHours(0, 0, 0, 0);
  activation.setHours(0, 0, 0, 0);
  
  const daysPassed = Math.floor((today - activation) / (1000 * 60 * 60 * 24));
  const remaining = licenseInfo.duration - daysPassed;
  
  return Math.max(0, remaining);
}

// Riga 1166 - DOPO getDaysRemaining
function checkLicenseExpiration() {
  if (!licenzaInfo) return;
  
  const daysRemaining = getDaysRemaining(licenzaInfo);
  
  if (daysRemaining <= 10 && daysRemaining > 0) {
    showExpirationWarning(daysRemaining);
  }
}

function showExpirationWarning(days) {
  const warning = document.createElement('div');
  warning.style.cssText = `
    position: fixed;
    top: 20px;
    right: 20px;
    background: #fff3cd;
    border: 1px solid #ffeaa7;
    color: #856404;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    z-index: 9999;
    max-width: 400px;
  `;
  
  warning.innerHTML = `
    <h4 style="margin:0 0 10px 0">‚ö†Ô∏è Licenza in scadenza</h4>
    <p>La tua licenza scadr√† tra <strong>${days} giorni</strong>.</p>
    <p>Dopo la scadenza potrai solo visualizzare i report salvati.</p>
    <button onclick="rinnovaOnline()" style="background:var(--ceo-orange);color:white;padding:8px 16px;border-radius:8px;margin-right:10px">
      Rinnova Ora
    </button>
    <button onclick="this.parentElement.remove()" style="background:#fff;color:#666;padding:8px 16px;border-radius:8px">
      Chiudi
    </button>
  `;
  
  document.body.appendChild(warning);
}

/* ======================================================
   FUNZIONI LICENZA
   ====================================================== */

function getAnagraficaUsage() {
  let used = 0;
  try {
    used = JSON.parse(getStorage('ceodoc_aziende') || '[]').length;
  } catch(e) {
    used = 0;
  }
  return { used };
}

/* ======================================================
   HEADER DINAMICO
   ====================================================== */
function updateHeaderContent(title,subtitle){
  document.getElementById('header-title').textContent=title||'';
  document.getElementById('header-subtitle').textContent=subtitle||'';
  const dynamicLogo=document.getElementById('dynamic-logo');
  const logoBarreOnly=`
    <defs>
      <linearGradient id="headerGrad1" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#1d3557"/><stop offset="50%" stop-color="#2d4a6b"/><stop offset="100%" stop-color="#1a2e4a"/></linearGradient>
      <linearGradient id="headerGrad2" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#1d3557"/><stop offset="40%" stop-color="#2d4a6b"/><stop offset="80%" stop-color="#0095ff"/><stop offset="100%" stop-color="#0077cc"/></linearGradient>
      <linearGradient id="headerGrad3" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#1d3557"/><stop offset="30%" stop-color="#2d4a6b"/><stop offset="70%" stop-color="#ff6b00"/><stop offset="100%" stop-color="#e55a00"/></linearGradient>
      <linearGradient id="headerGrad4" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#ff6b00"/><stop offset="50%" stop-color="#ff8c32"/><stop offset="100%" stop-color="#e55a00"/></linearGradient>
      <linearGradient id="headerGrad5" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#ff6b00"/><stop offset="50%" stop-color="#ff9c42"/><stop offset="100%" stop-color="#ffa94d"/></linearGradient>
      <linearGradient id="headerGrad6" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#ffa94d"/><stop offset="50%" stop-color="#ffb966"/><stop offset="100%" stop-color="#ff9c42"/></linearGradient>
      <filter id="headerBarShadow" x="-50%" y="-50%" width="200%" height="200%"><feDropShadow dx="2" dy="4" stdDeviation="3" flood-color="rgba(0,0,0,0.3)"/></filter>
      <linearGradient id="headerAnimatedLineGradient" x1="0%" y1="0%" x2="100%" y2="0%">
        <stop offset="0%" stop-color="#1d3557"><animate attributeName="stop-color" values="#1d3557;#0095ff;#ff6b00;#ff8c32;#ffa94d;#1d3557" dur="6s" repeatCount="indefinite"/></stop>
        <stop offset="20%" stop-color="#0095ff"><animate attributeName="stop-color" values="#0095ff;#ff6b00;#ff8c32;#ffa94d;#1d3557;#0095ff" dur="6s" repeatCount="indefinite"/></stop>
        <stop offset="40%" stop-color="#ff6b00"><animate attributeName="stop-color" values="#ff6b00;#ff8c32;#ffa94d;#1d3557;#0095ff;#ff6b00" dur="6s" repeatCount="indefinite"/></stop>
        <stop offset="60%" stop-color="#ff8c32"><animate attributeName="stop-color" values="#ff8c32;#ffa94d;#1d3557;#0095ff;#ff6b00;#ff8c32" dur="6s" repeatCount="indefinite"/></stop>
        <stop offset="80%" stop-color="#ffa94d"><animate attributeName="stop-color" values="#ffa94d;#1d3557;#0095ff;#ff6b00;#ff8c32;#ffa94d" dur="6s" repeatCount="indefinite"/></stop>
        <stop offset="100%" stop-color="#ffb966"><animate attributeName="stop-color" values="#ffb966;#ffa94d;#ff8c32;#ff6b00;#0095ff;#ffb966" dur="6s" repeatCount="indefinite"/></stop>
    </linearGradient>
<!-- Freccia su (upload/backup) -->
<symbol id="i-arrow-up" viewBox="0 0 24 24">
  <path fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" d="M12 19V5M5 12l7-7 7 7"/>
</symbol>

<!-- Freccia gi√π (download/ripristina) -->
<symbol id="i-arrow-down" viewBox="0 0 24 24">
  <path fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" d="M12 5v14M19 12l-7 7-7-7"/>
</symbol>

<!-- Gruppo utenti (2-3 persone) -->
<symbol id="i-users" viewBox="0 0 24 24">
  <path fill="currentColor" d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5s-3 1.34-3 3 1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/>
</symbol>
<!-- Tema: Contrasto -->
<symbol id="i-theme" viewBox="0 0 24 24">
  <circle cx="12" cy="12" r="10" fill="none" stroke="currentColor" stroke-width="2"/>
  <path d="M12 2 A10 10 0 0 1 12 22 z" fill="currentColor"/>
  <circle cx="12" cy="8" r="2" fill="white"/>
  <circle cx="12" cy="16" r="2" fill="currentColor"/>
</symbol>
   </defs>
    <path d="M0,85 Q40,75 80,85 T160,85 T240,85" fill="none" stroke="url(#headerAnimatedLineGradient)" stroke-width="4"/>
    <path d="M0,88 Q40,78 80,88 T160,88 T240,88" fill="none" stroke="#ffa94d" stroke-width="2" opacity="0.3"/>
    <rect x="20" y="65" width="16" height="30" fill="url(#headerGrad1)" rx="2" filter="url(#headerBarShadow)"/>
    <rect x="50" y="55" width="16" height="40" fill="url(#headerGrad2)" rx="2" filter="url(#headerBarShadow)"/>
    <rect x="80" y="60" width="16" height="35" fill="url(#headerGrad3)" rx="2" filter="url(#headerBarShadow)"/>
    <rect x="110" y="50" width="16" height="45" fill="url(#headerGrad4)" rx="2" filter="url(#headerBarShadow)"/>
    <rect x="140" y="62" width="16" height="33" fill="url(#headerGrad5)" rx="2" filter="url(#headerBarShadow)"/>
    <rect x="170" y="52" width="16" height="43" fill="url(#headerGrad6)" rx="2" filter="url(#headerBarShadow)"/>
  `;
  dynamicLogo.innerHTML=logoBarreOnly;
}

/* ======================================================
   NAVIGAZIONE
   ====================================================== */
function updateSidebarActive(section) {
  document.querySelectorAll('#sidebar-menu .sidebar-link').forEach(b => b.classList.remove('active'));
  const btn = document.querySelector('#sidebar-menu .sidebar-link[data-section="' + section + '"]');
  if (btn) btn.classList.add('active');
}

function resetView() {
  try {
    if (activeIframe) {
      activeIframe.src = 'about:blank';
      activeIframe.remove();
      activeIframe = null;
    }
  } catch(_) {}
  
  const card = document.getElementById('content-card');
  card.classList.remove('expanded', 'blocked');
  document.getElementById('license-overlay').style.display = 'none';
  document.getElementById('btn-torna-dashboard').style.display = 'none';
  document.getElementById('card-content').innerHTML = '';
}

/* ======================================================
   SCHERMATE PRINCIPALI
   ====================================================== */
function showWelcome() {
  resetView();
  updateSidebarActive('home');
  updateHeaderContent('ceoDOC.it', 'Business Intelligence Platform');
  
  const card = document.querySelector('.content-card');
  if (card) card.classList.remove('expanded');
  document.getElementById('btn-torna-dashboard').style.display = 'none';
  
  function row(icon, label) {
    return `<li class="welcome-bullet">
      <span class="dot"><svg width="20" height="20"><use href="${icon}"/></svg></span>
      <span style="font-weight:700" class="welcome-label">${label}</span>
    </li>`;
  }
  
  document.getElementById('card-content').innerHTML = `
    <div class="welcome-content">
      <h2 class="welcome-title">Business Intelligence Platform</h2>
      <p>Piattaforma completa per la gestione aziendale e l'analisi finanziaria avanzata.</p>
      <ul style="list-style:none;padding:0;max-width:760px;margin:0 auto;text-align:left">
        ${row('#i-chart', 'Analisi bilanci e centrale rischi')}
        ${row('#i-doc', 'Check-list conformit√† normativa')}
        ${row('#i-lock', 'Parametri ESG e sostenibilit√†')}
        ${row('#i-key', 'Suite finanziaria')}
        ${row('#i-pencil', 'Business plan, Organigrammi e workflow')}
        ${row('#i-save', 'Report automatici e documentazione')}
      </ul>
      <p style="margin-top:24px;">
        <strong>Per iniziare:</strong>
        <a href="#" onclick="attivaLicenza();return false;" style="color:var(--ceo-orange);text-decoration:underline;font-weight:800">Attiva la licenza</a>
        e accedi alla Dashboard.
      </p>
    </div>
  `;
}

function showDashboard() {
  resetView();
  updateSidebarActive('dashboard');
  updateHeaderContent('Dashboard', 'Tutte le Funzioni Business Intelligence');
  
  const html = `
    <div class="dashboard-grid">${createDashboardButtons()}</div>
    <div style="display:flex;justify-content:center;width:100%;padding:0 20px;margin-top:40px">
      <div class="dashboard-footer">
        <svg width="14" height="14" style="margin-right:8px"><use href="#i-warn"/></svg>
        <span><strong>ceoDOC.it</strong> pu√≤ contenere imprecisioni: verifica sempre le informazioni importanti. 
        <a onclick="showLib('disclaimer.html','Disclaimer')" style="text-decoration:underline;cursor:pointer;font-weight:600">Vedi Disclaimer</a>.</span>
      </div>
    </div>`;
  
  document.getElementById('card-content').innerHTML = html;
  renderLicenseOverlayIfNeeded();
}

// Verifica se l'utente pu√≤ accedere al modulo
function canAccessModule(moduleId) {
  // Se non c'√® licenza attiva, nessun accesso
  if (!licenzaAttiva || !licenzaInfo) {
    return false;
  }
  
  // Se la licenza √® scaduta, nessun accesso
  if (isLicenseExpired(licenzaInfo)) {
    return false;
  }
  
  // Se ha FULL15, accesso a tutto
  if (licenzaInfo.moduli && licenzaInfo.moduli.includes('ALL')) {
    return true;
  }
  
  // Altrimenti verifica se il modulo √® nella lista
  return licenzaInfo.moduli && licenzaInfo.moduli.includes(moduleId);
}

function createDashboardButtons() {
  const functions = [
    {id:'anacrisk', label:'Analisi<br>Centrale Rischi', path:'centralerischi/anacrisk.html', color:'#ff6b00'},
    {id:'anabilCONS', label:'Analisi Bilancio<br>Consuntivo', path:'bilanci/anabilCONS.html', color:'#0095ff'},
    {id:'anabilINFR', label:'Analisi Bilancio<br>Infrannuale', path:'bilanci/anabilINFR.html', color:'#28a745'},
    {id:'importaFT', label:'Importa<br>Fatture per DSCR', path:'fattureclifor/importaFT.html', color:'#ffc107'},
    {id:'creaSCAD', label:'Crea<br>Scadenzario', path:'scadenziari/creaSCAD.html', color:'#e74c3c'},
    {id:'anaadeguati', label:'Analisi<br>Adeguati Assetti', path:'checkadeguati/anaadeguati.html', color:'#17a2b8'},
    {id:'anaESG', label:'Analisi<br>ESG', path:'checkESG/anaESG.html', color:'#6f42c1'},
    {id:'creaBM', label:'Crea<br>Business Model', path:'businessmodel/creaBM.html', color:'#e83e8c'},
    {id:'creaAS', label:'Analisi<br>SWOT', path:'analisiswot/creaAS.html', color:'#fd7e14'},
    {id:'creaORG', label:'Crea<br>Organigramma', path:'organigramma/creaORG.html', color:'#20c997'},
    {id:'creaBP', label:'Crea<br>Business Plan', path:'busplan/creaBP.html', color:'#9b59b6'},
    {id:'creaPAMM', label:'Suite<br>Finanziaria', path:'pianoprestiti/creaPAMM.html', color:'#6610f2'},
    {id:'creaSCEN', label:'Crea<br>Scenari', path:'busplan/creaSCEN.html', color:'#0ea5e9'},
    {id:'creaVERB', label:'Crea<br>Verbale', path:'verbali/creaVERB.html', color:'#495057'},
    {id:'creaREPORT', label:'Crea<br>Report', path:'report/creaREPORT.html', color:'#f39c12'}
  ];
  
  return functions.map(f => {
    const ok = canAccessModule(f.id);
    const style = ok ? '' : 'opacity:.5;cursor:not-allowed;';
    return `<button class="btn-circular" onclick="loadFunction('archivio/${f.path}','${f.label}','${f.id}')" style="${style}">
      <div class="icon" style="background:${f.color}">
        <svg width="34" height="34" viewBox="0 0 100 100" aria-hidden="true">
          <circle cx="50" cy="50" r="44" fill="none" stroke="rgba(255,255,255,.4)" stroke-width="10"/>
          <circle cx="50" cy="50" r="28" fill="none" stroke="rgba(255,255,255,.6)" stroke-width="6"/>
          <circle cx="50" cy="50" r="6" fill="#fff"/>
        </svg>
      </div>
      <span>${f.label}</span>
    </button>`;
  }).join('');
}

/* ======================================================
   CARICAMENTO MODULI
   ====================================================== */
function loadFunction(fullPath, label, moduleId) {
  if (!licenzaAttiva) {
    attivaLicenza();
    return;
  }
  
  if (!canAccessModule(moduleId)) {
    alert('Questa funzione non √® inclusa nella tua licenza');
    return;
  }
  
  const titles = {
    anacrisk: ['Centrale Rischi', 'MCC Rating Analysis Protocol'],
    anabilCONS: ['Analisi Bilancio Consuntivo', 'Genera report dettagliati e dashboard interattive'],
    anabilINFR: ['Analisi Bilancio Infrannuale', 'Evidenzia punti di forza, debolezza e tendenze'],
    importaFT: ['Importa Fatture per DSCR', 'Clienti/Fornitori'],
    creaSCAD: ['Scadenzario', 'Gestione scadenze'],
    anaadeguati: ['Analisi Adeguati Assetti', 'Controlli e checklist'],
    anaESG: ['Analisi ESG', 'Indicatori e KPI'],
    creaBM: ['Business Model', 'Struttura del valore'],
    creaAS: ['Analisi SWOT', 'Punti di forza/debolezza'],
    creaORG: ['Organigramma', 'Struttura e responsabilit√†'],
    creaBP: ['Business Plan', 'Piano strategico e finanziario'],
    creaPAMM: ['Suite Finanziaria', 'Analisi Professionale All-in-One'],
    creaSCEN: ['Crea Scenari', 'What-if e simulazioni'],
    creaVERB: ['Verbali', 'Gestione riunioni'],
    creaREPORT: ['Report', 'Composizione e stampa']
  };
  
  updateHeaderContent(titles[moduleId]?.[0] || 'Modulo', titles[moduleId]?.[1] || label.replace('<br>', ' '));
  
  resetView();
  document.getElementById('content-card').classList.add('expanded');
  
  const iframe = document.createElement('iframe');
  iframe.src = fullPath;
  iframe.style.width = '100%';
  iframe.style.height = '800px';
  iframe.style.border = 'none';
  iframe.style.borderRadius = '10px';
  iframe.setAttribute('loading', 'eager');
  
  activeIframe = iframe;
  const c = document.getElementById('card-content');
  c.innerHTML = '';
  c.appendChild(iframe);
  document.getElementById('btn-torna-dashboard').style.display = 'inline-block';
  
  wireIframe(iframe, moduleId);
}

/* ======================================================
   ANAGRAFICA
   ====================================================== */
function showAnagrafica() {
  resetView();
  updateSidebarActive('anagrafica');
  updateHeaderContent('Anagrafica', 'Inserimento Dati Aziendali');
  
  if (!licenzaAttiva) {
    showAnagraficaMessage('lock', 'Licenza Richiesta',
      'Per utilizzare questa funzione √® necessario attivare una licenza valida.',
      '<button class="anagrafica-btn" onclick="attivaLicenza()"><svg width="14" height="14" style="vertical-align:-2px;margin-right:6px"><use href="#i-key"/></svg>Attiva Licenza</button>'
    );
    return;
  }
  
  document.getElementById('card-content').innerHTML = `
    <div style="max-width:900px;margin:0 auto">
      <div class="anagrafica-buttons">
  <button class="anagrafica-btn" onclick="showAnagraficaForm('bilancio')"><svg width="14" height="14" style="vertical-align:-2px;margin-right:6px"><use href="#i-chart"/></svg>Import da Bilancio XBRL</button>
  <button class="anagrafica-btn" onclick="showAnagraficaForm('excel')"><svg width="14" height="14" style="vertical-align:-2px;margin-right:6px"><use href="#i-file"/></svg>Import da Excel</button>
  <button class="anagrafica-btn" onclick="showAnagraficaForm('cr')"><svg width="14" height="14" style="vertical-align:-2px;margin-right:6px"><use href="#i-bank"/></svg>Import da Centrale Rischi</button>
  <button class="anagrafica-btn" onclick="showAnagraficaForm('manuale')"><svg width="14" height="14" style="vertical-align:-2px;margin-right:6px"><use href="#i-pencil"/></svg>Inserimento Manuale</button>
</div>
      <div id="anagrafica-form-container" style="margin-top:18px"></div>
    </div>`;
}

function showAnagraficaMessage(icon, title, message, action) {
  document.getElementById('card-content').innerHTML = `
    <div class="construction-page" style="text-align:center;padding:60px">
      <svg width="54" height="54"><use href="#i-${icon}"/></svg>
      <h2 style="color:var(--ceo-orange);font-size:2rem;margin-bottom:20px">${title}</h2>
      <p style="opacity:.8">${message}</p>
      ${action}
    </div>`;
}

function showAnagraficaForm(tipo) {
  const titoli = {
    bilancio: 'Importazione da Bilancio XBRL',
    cr: 'Importazione da Centrale Rischi',
    manuale: 'Inserimento Manuale Completo'
  };
  
  const container = document.getElementById('anagrafica-form-container');
  if (!container) return;
  
  let html = '<div style="background:#f8f9fa;padding:25px;border-radius:15px;border:2px solid #ddd">';
  html += '<h3 style="color:var(--ceo-blue);margin-bottom:20px">' + titoli[tipo] + '</h3>';
  
  if (tipo === 'bilancio') {
  html += '<div style="margin-bottom:20px"><label>File XBRL</label><input type="file" id="fileXBRL" accept=".xbrl,.xml" onchange="importaXBRL(this.files[0])" style="width:100%;padding:10px;border:2px solid #ddd;border-radius:8px"></div>';
}
if (tipo === 'excel') {
  html += '<div style="margin-bottom:20px"><label>File Excel (.xls, .xlsx)</label><input type="file" id="fileExcel" accept=".xls,.xlsx" style="width:100%;padding:10px;border:2px solid #ddd;border-radius:8px"></div>';
}
  if (tipo === 'cr') {
    html += '<div style="margin-bottom:20px"><label>File Centrale Rischi (.pdf,.txt)</label><input type="file" id="fileCR" accept=".pdf,.txt" style="width:100%;padding:10px;border:2px solid #ddd;border-radius:8px"></div>';
  }
  
  // Campi form uniformati
html += '<div class="anagrafica-grid">';

// Ragione Sociale (campo largo)
html += '<div class="anagrafica-field" style="grid-column:span 2"><label>Ragione Sociale*</label><input id="ragioneSociale" placeholder="Denominazione completa"></div>';

// CF e Sede
html += '<div class="anagrafica-field"><label>Codice Fiscale*</label><input id="codiceFiscale" placeholder="11 caratteri" maxlength="16"></div>';
html += '<div class="anagrafica-field"><label>Sede</label><input id="sede" placeholder="Citt√† o indirizzo"></div>';

// Natura Giuridica e Settore
html += '<div class="anagrafica-field"><label>Natura Giuridica*</label><select id="naturaGiuridica"><option value="SC" selected>SC - Societ√† di Capitali</option></select></div>';
html += '<div class="anagrafica-field"><label>Settore*</label><select id="settore"><option value="">-- Seleziona --</option><option value="AGRICOLTURA">Agricoltura</option><option value="INDUSTRIA">Industria</option><option value="EDILIZIA">Edilizia</option><option value="COMMERCIO">Commercio</option><option value="IMMOBILIARE">Immobiliare</option><option value="SERVIZI">Servizi</option><option value="ALTRO">Altro</option></select></div>';

// Codice ATECO 2025 (campo largo)
html += '<div class="anagrafica-field" style="grid-column:span 2"><label>Codice ATECO 2025</label><select id="codiceAteco"><option value="">-- Seleziona Codice ATECO --</option>';

// SEZIONE A - AGRICOLTURA
html += '<optgroup label="A - AGRICOLTURA, SILVICOLTURA E PESCA">';
html += '<option value="01.11">01.11 - Coltivazione cereali</option>';
html += '<option value="01.13">01.13 - Coltivazione ortaggi</option>';
html += '<option value="01.21">01.21 - Coltivazione uva</option>';
html += '<option value="01.25">01.25 - Coltivazione frutta</option>';
html += '<option value="01.41">01.41 - Allevamento bovini da latte</option>';
html += '<option value="01.47">01.47 - Allevamento pollame</option>';
html += '<option value="01.50">01.50 - Coltivazioni e allevamento misti</option>';
html += '<option value="01.61">01.61 - Attivit√† di supporto agricoltura</option>';
html += '<option value="02.10">02.10 - Silvicoltura</option>';
html += '<option value="03.11">03.11 - Pesca marina</option>';
html += '</optgroup>';

// SEZIONE B - ESTRAZIONE
html += '<optgroup label="B - ATTIVIT√Ä ESTRATTIVE">';
html += '<option value="08.11">08.11 - Estrazione pietre</option>';
html += '<option value="08.12">08.12 - Estrazione ghiaia e sabbia</option>';
html += '</optgroup>';

// SEZIONE C - MANIFATTURA
html += '<optgroup label="C - ATTIVIT√Ä MANIFATTURIERE">';
html += '<option value="10.11">10.11 - Lavorazione carni</option>';
html += '<option value="10.71">10.71 - Panificazione</option>';
html += '<option value="10.73">10.73 - Produzione paste alimentari</option>';
html += '<option value="11.01">11.01 - Distillazione alcolici</option>';
html += '<option value="11.05">11.05 - Produzione birra</option>';
html += '<option value="13.10">13.10 - Filatura fibre tessili</option>';
html += '<option value="13.92">13.92 - Confezionamento biancheria</option>';
html += '<option value="14.11">14.11 - Confezione abbigliamento pelle</option>';
html += '<option value="14.13">14.13 - Confezione abbigliamento</option>';
html += '<option value="15.12">15.12 - Fabbricazione articoli viaggio</option>';
html += '<option value="15.20">15.20 - Fabbricazione calzature</option>';
html += '<option value="16.10">16.10 - Taglio e piallatura legno</option>';
html += '<option value="16.23">16.23 - Fabbricazione serramenti legno</option>';
html += '<option value="18.12">18.12 - Altra stampa</option>';
html += '<option value="20.30">20.30 - Fabbricazione pitture</option>';
html += '<option value="22.29">22.29 - Altri articoli plastica</option>';
html += '<option value="23.61">23.61 - Fabbricazione prodotti calcestruzzo</option>';
html += '<option value="25.11">25.11 - Fabbricazione strutture metalliche</option>';
html += '<option value="25.62">25.62 - Lavori meccanica generale</option>';
html += '<option value="27.40">27.40 - Fabbricazione apparecchi illuminazione</option>';
html += '<option value="28.10">28.10 - Fabbricazione macchinari uso generale</option>';
html += '<option value="31.01">31.01 - Fabbricazione mobili ufficio</option>';
html += '<option value="31.09">31.09 - Fabbricazione altri mobili</option>';
html += '<option value="32.99">32.99 - Altre industrie manifatturiere</option>';
html += '</optgroup>';

// SEZIONE D - ENERGIA
html += '<optgroup label="D - ENERGIA ELETTRICA, GAS">';
html += '<option value="35.11">35.11 - Produzione energia elettrica</option>';
html += '<option value="35.14">35.14 - Commercio energia elettrica</option>';
html += '</optgroup>';

// SEZIONE E - ACQUA E RIFIUTI
html += '<optgroup label="E - ACQUA, RIFIUTI E RISANAMENTO">';
html += '<option value="36.00">36.00 - Raccolta e depurazione acqua</option>';
html += '<option value="38.11">38.11 - Raccolta rifiuti non pericolosi</option>';
html += '<option value="38.32">38.32 - Recupero materiali selezionati</option>';
html += '</optgroup>';

// SEZIONE F - COSTRUZIONI
html += '<optgroup label="F - COSTRUZIONI">';
html += '<option value="41.10">41.10 - Sviluppo progetti immobiliari</option>';
html += '<option value="41.20">41.20 - Costruzione edifici</option>';
html += '<option value="42.11">42.11 - Costruzione strade</option>';
html += '<option value="43.11">43.11 - Demolizione</option>';
html += '<option value="43.12">43.12 - Preparazione cantiere</option>';
html += '<option value="43.21">43.21 - Installazione impianti elettrici</option>';
html += '<option value="43.22">43.22 - Impianti idraulici e riscaldamento</option>';
html += '<option value="43.29">43.29 - Altri lavori installazione</option>';
html += '<option value="43.31">43.31 - Intonacatura</option>';
html += '<option value="43.32">43.32 - Posa infissi</option>';
html += '<option value="43.33">43.33 - Rivestimento pavimenti e muri</option>';
html += '<option value="43.34">43.34 - Tinteggiatura e posa vetri</option>';
html += '<option value="43.39">43.39 - Altri lavori completamento</option>';
html += '<option value="43.91">43.91 - Coperture tetti</option>';
html += '</optgroup>';

// SEZIONE G - COMMERCIO
html += '<optgroup label="G - COMMERCIO INGROSSO E DETTAGLIO">';
html += '<option value="45.11">45.11 - Commercio auto</option>';
html += '<option value="45.20">45.20 - Manutenzione autoveicoli</option>';
html += '<option value="45.31">45.31 - Commercio ingrosso parti auto</option>';
html += '<option value="45.32">45.32 - Commercio dettaglio parti auto</option>';
html += '<option value="46.11">46.11 - Intermediari materie prime</option>';
html += '<option value="46.19">46.19 - Intermediari vari prodotti</option>';
html += '<option value="46.21">46.21 - Commercio ingrosso cereali</option>';
html += '<option value="46.31">46.31 - Commercio ingrosso frutta</option>';
html += '<option value="46.34">46.34 - Commercio ingrosso bevande</option>';
html += '<option value="46.41">46.41 - Commercio ingrosso tessili</option>';
html += '<option value="46.42">46.42 - Commercio ingrosso abbigliamento</option>';
html += '<option value="46.61">46.61 - Commercio ingrosso macchinari agricoli</option>';
html += '<option value="46.69">46.69 - Commercio ingrosso altri macchinari</option>';
html += '<option value="46.71">46.71 - Commercio ingrosso combustibili</option>';
html += '<option value="46.73">46.73 - Commercio ingrosso legname</option>';
html += '<option value="46.74">46.74 - Commercio ingrosso ferramenta</option>';
html += '<option value="46.90">46.90 - Commercio ingrosso non specializzato</option>';
html += '<option value="47.11">47.11 - Commercio dettaglio non specializzato</option>';
html += '<option value="47.19">47.19 - Altri esercizi non specializzati</option>';
html += '<option value="47.21">47.21 - Commercio dettaglio frutta verdura</option>';
html += '<option value="47.22">47.22 - Commercio dettaglio carni</option>';
html += '<option value="47.24">47.24 - Commercio dettaglio pane</option>';
html += '<option value="47.30">47.30 - Commercio dettaglio carburanti</option>';
html += '<option value="47.51">47.51 - Commercio dettaglio tessili</option>';
html += '<option value="47.52">47.52 - Commercio dettaglio ferramenta</option>';
html += '<option value="47.59">47.59 - Commercio dettaglio mobili</option>';
html += '<option value="47.61">47.61 - Commercio dettaglio libri</option>';
html += '<option value="47.71">47.71 - Commercio dettaglio abbigliamento</option>';
html += '<option value="47.72">47.72 - Commercio dettaglio calzature</option>';
html += '<option value="47.91">47.91 - Commercio per corrispondenza</option>';
html += '</optgroup>';

// SEZIONE H - TRASPORTO
html += '<optgroup label="H - TRASPORTO E MAGAZZINAGGIO">';
html += '<option value="49.31">49.31 - Trasporto terrestre passeggeri urbano</option>';
html += '<option value="49.32">49.32 - Trasporto con taxi</option>';
html += '<option value="49.41">49.41 - Trasporto merci su strada</option>';
html += '<option value="52.10">52.10 - Magazzinaggio</option>';
html += '<option value="52.21">52.21 - Attivit√† supporto trasporti terrestri</option>';
html += '<option value="52.24">52.24 - Movimentazione merci</option>';
html += '<option value="53.20">53.20 - Servizi postali e corriere</option>';
html += '</optgroup>';

// SEZIONE I - ALLOGGIO E RISTORAZIONE
html += '<optgroup label="I - ALLOGGIO E RISTORAZIONE">';
html += '<option value="55.10">55.10 - Alberghi</option>';
html += '<option value="55.20">55.20 - Alloggi vacanze</option>';
html += '<option value="55.30">55.30 - Campeggi</option>';
html += '<option value="56.10">56.10 - Ristoranti</option>';
html += '<option value="56.21">56.21 - Catering</option>';
html += '<option value="56.30">56.30 - Bar</option>';
html += '</optgroup>';

// SEZIONE J - INFORMAZIONE E COMUNICAZIONE
html += '<optgroup label="J - INFORMAZIONE E COMUNICAZIONE">';
html += '<option value="58.11">58.11 - Edizione libri</option>';
html += '<option value="59.11">59.11 - Produzione cinematografica</option>';
html += '<option value="60.10">60.10 - Trasmissioni radiofoniche</option>';
html += '<option value="61.10">61.10 - Telecomunicazioni fisse</option>';
html += '<option value="62.01">62.01 - Produzione software</option>';
html += '<option value="62.02">62.02 - Consulenza informatica</option>';
html += '<option value="62.03">62.03 - Gestione strutture informatiche</option>';
html += '<option value="62.09">62.09 - Altre attivit√† informatiche</option>';
html += '<option value="63.11">63.11 - Elaborazione dati</option>';
html += '<option value="63.12">63.12 - Portali web</option>';
html += '</optgroup>';

// SEZIONE K - FINANZA E ASSICURAZIONI
html += '<optgroup label="K - ATTIVIT√Ä FINANZIARIE E ASSICURATIVE">';
html += '<option value="64.19">64.19 - Altre intermediazioni monetarie</option>';
html += '<option value="64.92">64.92 - Altre attivit√† creditizie</option>';
html += '<option value="65.11">65.11 - Assicurazioni vita</option>';
html += '<option value="66.12">66.12 - Intermediazione negoziazione titoli</option>';
html += '<option value="66.19">66.19 - Altre attivit√† ausiliarie finanza</option>';
html += '<option value="66.22">66.22 - Agenti e broker assicurazioni</option>';
html += '</optgroup>';

// SEZIONE L - IMMOBILIARE
html += '<optgroup label="L - ATTIVIT√Ä IMMOBILIARI">';
html += '<option value="68.10">68.10 - Compravendita immobili</option>';
html += '<option value="68.20">68.20 - Affitto e gestione immobili</option>';
html += '<option value="68.31">68.31 - Agenzie immobiliari</option>';
html += '<option value="68.32">68.32 - Amministrazione condomini</option>';
html += '</optgroup>';

// SEZIONE M - ATTIVIT√Ä PROFESSIONALI
html += '<optgroup label="M - ATTIVIT√Ä PROFESSIONALI E TECNICHE">';
html += '<option value="69.10">69.10 - Attivit√† legali</option>';
html += '<option value="69.20">69.20 - Contabilit√† e consulenza fiscale</option>';
html += '<option value="70.10">70.10 - Direzione aziendale</option>';
html += '<option value="70.21">70.21 - Pubbliche relazioni</option>';
html += '<option value="70.22">70.22 - Consulenza gestionale</option>';
html += '<option value="71.11">71.11 - Attivit√† studi architettura</option>';
html += '<option value="71.12">71.12 - Attivit√† studi ingegneria</option>';
html += '<option value="71.20">71.20 - Collaudi e analisi tecniche</option>';
html += '<option value="72.19">72.19 - Ricerca e sviluppo scientifico</option>';
html += '<option value="73.11">73.11 - Agenzie pubblicitarie</option>';
html += '<option value="73.20">73.20 - Ricerche di mercato</option>';
html += '<option value="74.10">74.10 - Design specializzato</option>';
html += '<option value="74.20">74.20 - Attivit√† fotografiche</option>';
html += '<option value="74.30">74.30 - Traduzione e interpretariato</option>';
html += '<option value="74.90">74.90 - Altre attivit√† professionali</option>';
html += '</optgroup>';

// SEZIONE N - NOLEGGIO E SERVIZI
html += '<optgroup label="N - NOLEGGIO E SERVIZI DI SUPPORTO">';
html += '<option value="77.11">77.11 - Noleggio auto</option>';
html += '<option value="77.21">77.21 - Noleggio attrezzature sportive</option>';
html += '<option value="77.31">77.31 - Noleggio macchinari agricoli</option>';
html += '<option value="77.32">77.32 - Noleggio macchinari edili</option>';
html += '<option value="78.10">78.10 - Agenzie ricerca personale</option>';
html += '<option value="78.20">78.20 - Agenzie lavoro temporaneo</option>';
html += '<option value="79.11">79.11 - Agenzie viaggio</option>';
html += '<option value="79.12">79.12 - Tour operator</option>';
html += '<option value="80.10">80.10 - Servizi vigilanza</option>';
html += '<option value="80.20">80.20 - Servizi sistemi sicurezza</option>';
html += '<option value="81.10">81.10 - Servizi integrati gestione edifici</option>';
html += '<option value="81.21">81.21 - Pulizia generale edifici</option>';
html += '<option value="81.30">81.30 - Cura e manutenzione paesaggio</option>';
html += '<option value="82.11">82.11 - Servizi amministrativi integrati</option>';
html += '<option value="82.19">82.19 - Fotocopiatura e preparazione documenti</option>';
html += '<option value="82.30">82.30 - Organizzazione convegni e fiere</option>';
html += '<option value="82.91">82.91 - Recupero crediti</option>';
html += '<option value="82.92">82.92 - Imballaggio e confezionamento</option>';
html += '<option value="82.99">82.99 - Altri servizi supporto imprese</option>';
html += '</optgroup>';

// SEZIONE P - ISTRUZIONE
html += '<optgroup label="P - ISTRUZIONE">';
html += '<option value="85.10">85.10 - Istruzione prescolastica</option>';
html += '<option value="85.41">85.41 - Istruzione post-secondaria non universitaria</option>';
html += '<option value="85.52">85.52 - Formazione culturale</option>';
html += '<option value="85.53">85.53 - Scuole guida</option>';
html += '<option value="85.59">85.59 - Altri servizi istruzione</option>';
html += '<option value="85.60">85.60 - Attivit√† supporto istruzione</option>';
html += '</optgroup>';

// SEZIONE Q - SANIT√Ä
html += '<optgroup label="Q - SANIT√Ä E ASSISTENZA SOCIALE">';
html += '<option value="86.10">86.10 - Servizi ospedalieri</option>';
html += '<option value="86.21">86.21 - Servizi studi medici generici</option>';
html += '<option value="86.22">86.22 - Studi medici specialistici</option>';
html += '<option value="86.23">86.23 - Attivit√† studi odontoiatrici</option>';
html += '<option value="86.90">86.90 - Altri servizi assistenza sanitaria</option>';
html += '<option value="87.10">87.10 - Strutture assistenza infermieristica residenziale</option>';
html += '<option value="88.10">88.10 - Assistenza sociale anziani e disabili</option>';
html += '<option value="88.91">88.91 - Servizi asili nido</option>';
html += '</optgroup>';

// SEZIONE R - ARTE E INTRATTENIMENTO
html += '<optgroup label="R - ATTIVIT√Ä ARTISTICHE E INTRATTENIMENTO">';
html += '<option value="90.01">90.01 - Rappresentazioni artistiche</option>';
html += '<option value="90.02">90.02 - Attivit√† supporto rappresentazioni</option>';
html += '<option value="90.03">90.03 - Creazioni artistiche</option>';
html += '<option value="91.01">91.01 - Biblioteche e archivi</option>';
html += '<option value="91.02">91.02 - Musei</option>';
html += '<option value="92.00">92.00 - Attivit√† lotterie e scommesse</option>';
html += '<option value="93.11">93.11 - Gestione impianti sportivi</option>';
html += '<option value="93.12">93.12 - Attivit√† club sportivi</option>';
html += '<option value="93.13">93.13 - Palestre</option>';
html += '<option value="93.21">93.21 - Parchi divertimento</option>';
html += '<option value="93.29">93.29 - Altri intrattenimenti</option>';
html += '</optgroup>';

// SEZIONE S - ALTRI SERVIZI
html += '<optgroup label="S - ALTRE ATTIVIT√Ä DI SERVIZI">';
html += '<option value="94.11">94.11 - Organizzazioni economiche e datoriali</option>';
html += '<option value="94.12">94.12 - Attivit√† associazioni professionali</option>';
html += '<option value="94.20">94.20 - Attivit√† sindacati</option>';
html += '<option value="94.91">94.91 - Attivit√† organizzazioni religiose</option>';
html += '<option value="94.99">94.99 - Altre organizzazioni associative</option>';
html += '<option value="95.11">95.11 - Riparazione computer</option>';
html += '<option value="95.12">95.12 - Riparazione apparecchi comunicazione</option>';
html += '<option value="95.21">95.21 - Riparazione elettronica consumo</option>';
html += '<option value="95.22">95.22 - Riparazione elettrodomestici</option>';
html += '<option value="95.23">95.23 - Riparazione calzature</option>';
html += '<option value="95.24">95.24 - Riparazione mobili</option>';
html += '<option value="95.25">95.25 - Riparazione orologi e gioielli</option>';
html += '<option value="95.29">95.29 - Riparazione altri beni personali</option>';
html += '<option value="96.01">96.01 - Lavanderie</option>';
html += '<option value="96.02">96.02 - Parrucchieri e estetisti</option>';
html += '<option value="96.03">96.03 - Servizi pompe funebri</option>';
html += '<option value="96.04">96.04 - Servizi centri benessere</option>';
html += '<option value="96.09">96.09 - Altri servizi persona</option>';
html += '</optgroup>';

html += '</select></div>';
  
  html += '<div class="anagrafica-buttons" style="margin-top:14px">';
  html += '<button class="anagrafica-btn" id="btn-salva-anagrafica"><svg width="14" height="14" style="vertical-align:-2px;margin-right:6px"><use href="#i-save"/></svg>Salva Anagrafica</button>';
  html += '<button class="anagrafica-btn secondary" onclick="showAnagrafica()"><svg width="14" height="14" style="vertical-align:-2px;margin-right:6px"><use href="#i-x"/></svg>Annulla</button>';
  html += '</div>';
  html += '</div>';
  
  container.innerHTML = html;
  
  // Event listeners
  setTimeout(function() {
    const btnSalva = document.getElementById('btn-salva-anagrafica');
    if (btnSalva) {
      btnSalva.onclick = function() {
        salvaAnagrafica(tipo);
      };
    }
    
    if (tipo === 'cr') {
      const fileCR = document.getElementById('fileCR');
      if (fileCR) {
        fileCR.onchange = function() {
          if (this.files[0]) parsePDFCentraleRischi(this.files[0]);
        };
      }
    }
if (tipo === 'bilancio') {
  const fileXBRL = document.querySelector('input[type="file"]');
  if (fileXBRL) {
    fileXBRL.onchange = async function() {
      if (this.files[0]) await importaXBRL(this.files[0]);
    };
  }
}

if (tipo === 'excel') {
  const fileExcel = document.getElementById('fileExcel');
  if (fileExcel) {
    fileExcel.onchange = async function() {
      if (this.files[0]) await importaExcel(this.files[0]);
    };
  }
}
  }, 100);
}

// IMPORT PDF CENTRALE RISCHI (versione che funziona)
async function parsePDFCentraleRischi(file) {
  if (!file) return;
  
  try {
    // Carica PDF.js se necessario
    if (typeof pdfjsLib === 'undefined') {
      const script = document.createElement('script');
      script.src = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js';
      document.head.appendChild(script);
      await new Promise(r => script.onload = r);
      pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js';
    }
    
    const arrayBuffer = await file.arrayBuffer();
    const pdf = await pdfjsLib.getDocument({data: arrayBuffer}).promise;
    const page = await pdf.getPage(1);
    const textContent = await page.getTextContent();
    const text = textContent.items.map(item => item.str).join(' ');
    
    // Controlla se il PDF √® valido
    if (text.length < 50) {
      alert('‚ö†Ô∏è Verifica che il file PDF non sia corrotto.\nApri e verifica se si visualizza correttamente.');
      return;
    }
    
    const upper = text.replace(/\s+/g, " ").toUpperCase();
    
    // Cerca CF e pulisci zeri iniziali
    const cfMatch = upper.match(/\b(0*(\d{11}))\b/);
    
    if (cfMatch) {
      // Prendi solo gli ultimi 11 numeri senza zeri iniziali
      const codiceFiscale = cfMatch[2] || cfMatch[1];
      document.getElementById('codiceFiscale').value = codiceFiscale;
      
      const cfIndex = upper.indexOf(cfMatch[0]);
      const before = upper.slice(0, cfIndex);
      const after = upper.slice(cfIndex + cfMatch[0].length);
      
      // Denominazione
      const denomBlock = before.split("CCIAA:")[1];
      const denominazione = denomBlock
        ? denomBlock.replace(/\b\d{5,15}\b/g, "").trim()
        : "";
      
      if (denominazione) {
        document.getElementById('ragioneSociale').value = denominazione;
      }
      
      // Sede
      const sedeMatch = after.match(/SEDE(?:\s+LEGALE)?[:\s\-]*([A-Z√Ä-√ô'\s]{3,40})/i)
                      || after.match(/\b([A-Z']{3,})\b/);
      if (sedeMatch) {
        document.getElementById('sede').value = sedeMatch[1];
      }
      
      // SC di default per CR
      document.getElementById('naturaGiuridica').value = 'SC';
      
      alert('Dati estratti dal PDF. Verifica e completa i campi.');
    } else {
      alert('‚ö†Ô∏è Nessun dato anagrafico trovato.\nVerifica che il file PDF non sia corrotto.');
    }
    
  } catch (error) {
    alert('‚ùå Errore lettura PDF.\nVerifica che il file PDF non sia corrotto.');
  }
}

// IMPORT XBRL
async function importaXBRL(file) {
  if (!file) return;
  try {
    const text = await file.text();
    const parser = new DOMParser();
    const xmlDoc = parser.parseFromString(text, "text/xml");
    
    const getDato = (tag) => {
      const prefixes = ['itcc-ci:', ''];
      for (let prefix of prefixes) {
        const els = xmlDoc.getElementsByTagName(prefix + tag);
        if (els.length > 0) return els[0].textContent.trim();
      }
      return '';
    };
    
    document.getElementById('ragioneSociale').value = getDato('DatiAnagraficiDenominazione');
    document.getElementById('codiceFiscale').value = getDato('DatiAnagraficiCodiceFiscale');
    document.getElementById('sede').value = getDato('DatiAnagraficiSede');
    document.getElementById('naturaGiuridica').value = 'SC';
    
    alert('Dati importati da XBRL');
  } catch (e) {
    alert('Errore import XBRL');
  }
}

// IMPORT EXCEL
async function importaExcel(file) {
  if (!file) return;
  try {
    if (typeof XLSX === 'undefined') {
      const script = document.createElement('script');
      script.src = 'https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js';
      document.head.appendChild(script);
      await new Promise(r => script.onload = r);
    }
    
    const buffer = await file.arrayBuffer();
    const workbook = XLSX.read(new Uint8Array(buffer), {type: 'array'});
    const sheetT0000 = workbook.Sheets['T0000'] || workbook.Sheets['t0000'];
    
    if (!sheetT0000) {
      alert('Foglio T0000 non trovato');
      return;
    }
    
    // Celle corrette
    const denominazione = sheetT0000['D12'] ? sheetT0000['D12'].v : '';
    const sede = sheetT0000['D13'] ? sheetT0000['D13'].v : '';
    const cf = sheetT0000['D18'] ? sheetT0000['D18'].v : '';
    
    if (denominazione) document.getElementById('ragioneSociale').value = denominazione;
    if (sede) document.getElementById('sede').value = sede;
    if (cf) document.getElementById('codiceFiscale').value = cf.toString();
    document.getElementById('naturaGiuridica').value = 'SC';
    
    alert('Dati importati da Excel');
  } catch (e) {
    alert('Errore import Excel');
  }
}

function salvaAnagrafica(tipo) {
  const v = id => (document.getElementById(id)?.value || '').trim();
  const ragioneSociale = v('ragioneSociale');
  
  if (!ragioneSociale) {
    alert('Inserisci almeno la ragione sociale');
    return;
  }
  
  const anagrafica = {
  id: Date.now().toString(),
  fonte: tipo,
  ragioneSociale: ragioneSociale,
  cf: v('codiceFiscale'),
  piva: v('codiceFiscale'), // Usa CF come PIVA
  sede: v('sede'),
  naturaGiuridica: v('naturaGiuridica'),
  settore: v('settore'),
  codiceAteco: v('codiceAteco'),
  dataInserimento: new Date().toISOString().slice(0, 10),
  dataModifica: null
};
  
  const usedAfter = saveAziendaToList(anagrafica);
  setAnagraficaAttiva(anagrafica);
  
  alert(`Anagrafica "${ragioneSociale}" salvata. Anagrafiche salvate: ${usedAfter}`);
  showAnagrafica();
}

function saveAziendaToList(anagrafica) {
  let aziende = [];
  try {
    aziende = JSON.parse(getStorage('ceodoc_aziende') || '[]');
  } catch(e) {
    aziende = [];
  }
  
  // Evita duplicati
  const exists = aziende.some(a =>
    (a.cf && a.cf === anagrafica.cf) ||
    (a.ragioneSociale.toLowerCase() === anagrafica.ragioneSociale.toLowerCase())
  );
  
  if (!exists) {
    aziende.push(anagrafica);
    setStorage('ceodoc_aziende', JSON.stringify(aziende));
    setStorage('ceodoc_anagrafiche_count', String(aziende.length));
  }
  
  return aziende.length;
}

function setAnagraficaAttiva(anagrafica) {
  setStorage('ceodoc_anagrafica_attiva', JSON.stringify(anagrafica));
  updateAnagraficaAttivaUI();
}

/* ======================================================
   LIBRERIA
   ====================================================== */
function showLib(file, title) {
  resetView();
  updateHeaderContent(title || 'Documento', '');
  document.getElementById('content-card').classList.add('expanded');
  
  const iframe = document.createElement('iframe');
  iframe.src = 'archivio/libs/' + file;
  iframe.style.width = '100%';
  iframe.style.height = '800px';
  iframe.style.border = 'none';
  iframe.style.borderRadius = '10px';
  
  activeIframe = iframe;
  document.getElementById('card-content').appendChild(iframe);
  document.getElementById('btn-torna-dashboard').style.display = 'none';
}


/* ======================================================
   REGISTRAZIONE UTENTE (PRIMO ACCESSO)
   ====================================================== */
function salvaRegistrazione() {
  const nome = document.getElementById('regNome').value.trim();
  const cognome = document.getElementById('regCognome').value.trim();
  const cf = document.getElementById('regCF').value.trim().toUpperCase();
  const ruolo = document.getElementById('regRuolo').value.trim();
  const email = document.getElementById('regEmail').value.trim();
  const msg = document.getElementById('msgRegistrazione');
  
  // Validazione
  if (!nome || !cognome || !cf || !ruolo || !email) {
    msg.textContent = 'Compila tutti i campi obbligatori';
    return;
  }
  
  // Validazione CF (16 caratteri)
  if (cf.length !== 16) {
    msg.textContent = 'Codice Fiscale deve essere di 16 caratteri';
    return;
  }
  
  // Validazione email base
  if (!email.includes('@') || !email.includes('.')) {
    msg.textContent = 'Email non valida';
    return;
  }
  
  // Salva dati utente
  const userData = {
    nome: nome,
    cognome: cognome,
    nomeCompleto: `${nome} ${cognome}`,
    cf: cf,
    ruolo: ruolo,
    email: email,
    dataRegistrazione: new Date().toISOString()
  };
  
  setStorage('ceodoc_user_data', JSON.stringify(userData));
  
  // Chiudi modal registrazione e apri modal licenza
  document.getElementById('modalRegistrazione').classList.add('hidden');
  msg.textContent = '';
  
  // Ora mostra il modal licenza
  setTimeout(() => {
    attivaLicenza();
  }, 100);
}

function getUserData() {
  try {
    return JSON.parse(getStorage('ceodoc_user_data') || 'null');
  } catch(e) {
    return null;
  }
}

/* ======================================================
   LICENZA
   ====================================================== */
function attivaLicenza() {
  // Verifica se l'utente √® registrato
  const userData = getUserData();
  if (!userData) {
    // Se non √® registrato, mostra prima la registrazione
    document.getElementById('modalRegistrazione').classList.remove('hidden');
    return;
  }
  
  document.getElementById('modalLicenza').classList.remove('hidden');
  document.getElementById('inputLicenza').value = '';
  document.getElementById('msgLicenza').textContent = '';
  
  // Mostra i dati utente nel container
  const utenteDisplay = document.getElementById('utenteDisplay');
  if (utenteDisplay) {
    utenteDisplay.innerHTML = `${userData.nomeCompleto} - ${userData.ruolo}`;
  }
}

function chiudiLicenzaModal() {
  document.getElementById('modalLicenza').classList.add('hidden');
  document.getElementById('msgLicenza').textContent = '';
}

function confermaLicenza() {
  const manuale = document.getElementById('inputLicenza').value.trim();
  const file = document.getElementById('fileLicenza').files[0];
  
  // Prendi i dati utente salvati invece che dal campo input
  const userData = getUserData();
  const utente = userData ? userData.nomeCompleto : 'Utente';
  
  const msg = document.getElementById('msgLicenza');
  
  if (file) {
    const reader = new FileReader();
    reader.onload = function(e) {
      const content = e.target.result;
      // Cerca il codice licenza nel file
      const match = content.match(/CODICE LICENZA:\s*([^\s]+)/);
      if (match) {
        const licenseCode = match[1].trim();
        processaLicenza(licenseCode, utente, msg, true);
      } else {
        msg.textContent = 'File licenza non valido';
      }
    };
    reader.readAsText(file);
    return;
  }
  
  if (!manuale) {
    msg.textContent = 'Inserisci licenza o seleziona file licenza.txt';
    return;
  }
  
  processaLicenza(manuale, utente, msg, true);
}

function processaLicenza(fullCode, utente, msg, closeAfter) {
  const parsed = parseLicense(fullCode);
  
  if (!parsed) {
    msg.textContent = 'Licenza non valida.';
    return;
  }
  
if (isLicenseExpired(parsed)) {
    msg.textContent = 'Licenza scaduta.';
    return;
  }
  
  licenzaCorrente = {
    code: fullCode,
    utente: utente,
    attivazione: parsed.dataAttivazione
  };
  
  licenzaInfo = parsed;
  licenzaAttiva = true;
  
  setStorage('ceodoc_licenza', JSON.stringify(licenzaCorrente));
  setStorage('ceodoc_licenza_info', JSON.stringify(licenzaInfo));
  
  if (msg) {
    msg.style.color = '#2e7d32';
    msg.textContent = 'Licenza attivata con successo!';
  }
  
  if (closeAfter) {
    setTimeout(function() {
      chiudiLicenzaModal();
      showWelcome();
    }, 600);
  }
}

function renderLicenseOverlayIfNeeded() {
  const card = document.getElementById('content-card');
  const overlay = document.getElementById('license-overlay');
  const msgBox = document.getElementById('license-overlay-msg');
  
  card.classList.remove('blocked');
  overlay.style.display = 'none';
  
  if (!licenzaCorrente || !licenzaInfo) return;
  
  // Usa la stessa logica di isLicenseExpired
  const activationDate = decodeDate(licenzaInfo.encodedDate);
  const [year, month, day] = activationDate.split('-');
  const activation = new Date(parseInt(year), parseInt(month) - 1, parseInt(day));
  activation.setHours(0, 0, 0, 0);
  
  const today = new Date();
  today.setHours(0, 0, 0, 0);
  
  const daysPassed = Math.floor((today - activation) / (1000 * 60 * 60 * 24));
  const isExpired = daysPassed > licenzaInfo.duration;
  
  if (isExpired) {
    msgBox.innerHTML = `
      <strong>Licenza Scaduta</strong><br>
      <a href="#" onclick="showProfilo();return false;" style="color:#ff6b00;text-decoration:underline">
        Da Profilo Utente
      </a> 
      aggiorna la licenza per poter accedere.
    `;
    overlay.style.display = 'flex';
    card.classList.add('blocked');
  }
}

/* ======================================================
   ANAGRAFICHE UI
   ====================================================== */
function updateAnagraficaAttivaUI() {
  const a = JSON.parse(getStorage('ceodoc_anagrafica_attiva') || 'null') || {};
  document.getElementById('ac-rs').textContent = (a.ragioneSociale || '').trim() || '‚Äî';
  document.getElementById('ac-cf').textContent = (a.cf || '').trim() || '‚Äî';
  document.getElementById('ac-sede').textContent = (a.sede || '').trim() || '‚Äî';
  document.getElementById('ac-settore').textContent = (a.settore || '').trim() || '‚Äî';
  
  const usage = getAnagraficaUsage();
  document.getElementById('ac-used').textContent = usage.used;
}

function apriSelezionaAnagrafica() {
  const raw = getStorage('ceodoc_aziende') || '[]';
  let arr = [];
  try {
    arr = JSON.parse(raw);
  } catch(e) {
    arr = [];
  }
  
  const mk = (x, i) => `<option value="${i}">${x.ragioneSociale || '‚Äî'} | CF: ${x.cf || '‚Äî'} | P.IVA: ${x.piva || '‚Äî'} | ${x.naturaGiuridica || '‚Äî'} | ${x.settore || '‚Äî'} | ${x.sede || '‚Äî'}</option>`;
  
  const selLoad = document.getElementById('selAziende');
  const selEdit = document.getElementById('selAziendeEdit');
  const selDel = document.getElementById('selAziendeDel');
  
  selLoad.innerHTML = arr.length ? arr.map(mk).join('') : '<option value="">(Vuoto)</option>';
  selEdit.innerHTML = arr.length ? arr.map(mk).join('') : '<option value="">(Vuoto)</option>';
  selDel.innerHTML = arr.length ? arr.map(mk).join('') : '<option value="">(Vuoto)</option>';
  
  document.getElementById('msgSelAzienda').textContent = arr.length ? '' : 'Nessuna anagrafica salvata';
  document.getElementById('modalSelAzienda').classList.remove('hidden');
}

function selezionaAnagraficaSalva() {
  const raw = getStorage('ceodoc_aziende') || '[]';
  let arr = [];
  try {
    arr = JSON.parse(raw);
  } catch(e) {
    arr = [];
  }
  
  const idx = parseInt((document.getElementById('selAziende').value || '-1'), 10);
  if (isNaN(idx) || idx < 0 || idx >= arr.length) {
    document.getElementById('msgSelAzienda').textContent = 'Selezione non valida';
    return;
  }
  
  setAnagraficaAttiva(arr[idx]);
  document.getElementById('modalSelAzienda').classList.add('hidden');
}

function modificaAnagrafica() {
  const raw = getStorage('ceodoc_aziende') || '[]';
  let arr = [];
  try {
    arr = JSON.parse(raw);
  } catch(e) {
    arr = [];
  }
  
  const idx = parseInt((document.getElementById('selAziendeEdit').value || '-1'), 10);
  if (isNaN(idx) || idx < 0 || idx >= arr.length) {
    document.getElementById('msgSelAzienda').textContent = 'Selezione non valida';
    return;
  }
  
  const az = arr[idx];
  
  // Popola modal modifica
  document.getElementById('modifica-id').value = az.id || idx;
  document.getElementById('modifica-cf-originale').value = az.cf || '';
  document.getElementById('modifica-denominazione').value = az.ragioneSociale || '';
  document.getElementById('modifica-natura').value = az.naturaGiuridica || '';
  document.getElementById('modifica-settore').value = az.settore || '';
  document.getElementById('modifica-sede').value = az.sede || '';
  
  // Mostra campo CF solo se DI
  document.getElementById('campo-cf-update').style.display = 'none';
  
  // Listener per mostrare campo CF quando DI diventa SC/SP
  document.getElementById('modifica-natura').onchange = function() {
    const naturaOriginale = az.naturaGiuridica || '';
    const nuovaNatura = this.value;
    
    if (naturaOriginale === 'DI' && (nuovaNatura === 'SC' || nuovaNatura === 'SP')) {
      document.getElementById('campo-cf-update').style.display = 'block';
    } else {
      document.getElementById('campo-cf-update').style.display = 'none';
      document.getElementById('modifica-cf-nuovo').value = '';
    }
  };
  
  // Chiudi modal selezione e apri modal modifica
  document.getElementById('modalSelAzienda').classList.add('hidden');
  document.getElementById('modalModificaAnagrafica').classList.remove('hidden');
}

function salvaModificheAnagrafica() {
  const id = document.getElementById('modifica-id').value;
  const cfOriginale = document.getElementById('modifica-cf-originale').value;
  
  const raw = getStorage('ceodoc_aziende') || '[]';
  let arr = [];
  try {
    arr = JSON.parse(raw);
  } catch(e) {
    arr = [];
  }
  
  // Trova anagrafica da modificare
  const idx = arr.findIndex(a => (a.id === id) || (a.cf === cfOriginale));
  if (idx === -1) {
    alert('Anagrafica non trovata');
    return;
  }
  
  // Aggiorna campi modificabili
  arr[idx].ragioneSociale = document.getElementById('modifica-denominazione').value;
  arr[idx].naturaGiuridica = document.getElementById('modifica-natura').value;
  arr[idx].settore = document.getElementById('modifica-settore').value;
  arr[idx].sede = document.getElementById('modifica-sede').value;
  
  // Se c'√® nuovo CF (trasformazione DI -> societ√†)
  const nuovoCF = document.getElementById('modifica-cf-nuovo').value.trim();
  if (nuovoCF) {
    arr[idx].cf = nuovoCF;
  }
  
  arr[idx].dataModifica = new Date().toISOString();
  
  // Salva modifiche
  setStorage('ceodoc_aziende', JSON.stringify(arr));
  
  // Se √® l'anagrafica attiva, aggiorna
  const attiva = JSON.parse(getStorage('ceodoc_anagrafica_attiva') || 'null');
  if (attiva && (attiva.id === id || attiva.cf === cfOriginale)) {
    setAnagraficaAttiva(arr[idx]);
  }
  
  alert('Anagrafica modificata con successo');
  chiudiModificaAnagrafica();
}

function chiudiModificaAnagrafica() {
  document.getElementById('modalModificaAnagrafica').classList.add('hidden');
}

function eliminaAnagrafica() {
  const raw = getStorage('ceodoc_aziende') || '[]';
  let arr = [];
  try {
    arr = JSON.parse(raw);
  } catch(e) {
    arr = [];
  }
  
  const idx = parseInt((document.getElementById('selAziendeDel').value || '-1'), 10);
  if (isNaN(idx) || idx < 0 || idx >= arr.length) {
    document.getElementById('msgSelAzienda').textContent = 'Selezione non valida';
    return;
  }
  
  const az = arr[idx];
  if (!confirm(`Eliminare:\n${(az.ragioneSociale || '‚Äî')} ‚Äî ${(az.cf || '‚Äî')}\nOperazione irreversibile.`)) return;
  
  arr.splice(idx, 1);
  setStorage('ceodoc_aziende', JSON.stringify(arr));
  setStorage('ceodoc_anagrafiche_count', String(arr.length));
  
  const cur = JSON.parse(getStorage('ceodoc_anagrafica_attiva') || 'null');
  const norm = function(s) {
    return (s || '').toString().trim().toLowerCase().replace(/‚Äî/g, '');
  };
  
  if (!arr.length || (cur && (norm(cur.ragioneSociale) === norm(az.ragioneSociale) || norm(cur.cf) === norm(az.cf)))) {
    setStorage('ceodoc_anagrafica_attiva', JSON.stringify(null));
  }
  
  updateAnagraficaAttivaUI();
  apriSelezionaAnagrafica();
  
  const msg = document.getElementById('msgSelAzienda');
  msg.style.color = '#065f46';
  msg.textContent = 'Anagrafica eliminata.';
}

/* ======================================================
   CHAT
   ====================================================== */
function openChat() {
  const p = document.getElementById('chat-panel');
  const f = document.getElementById('chat-iframe');
  if (!f.src) f.src = 'archivio/libs/chiediaceodoc.html';
  p.classList.add('open');
}

function closeChat() {
  document.getElementById('chat-panel').classList.remove('open');
}

document.addEventListener('keydown', function(e) {
  if (e.key === 'Escape') closeChat();
});

/* ======================================================
   UTILITY
   ====================================================== */
function showAlert(title, msg) {
  const bg = document.createElement('div');
  bg.className = 'modal-bg';
  bg.innerHTML = `
    <div class="modal-card" style="max-width:560px">
      <h3>${title}</h3>
      <div style="line-height:1.6;color:#333">${msg}</div>
      <div style="margin-top:14px;text-align:center">
        <button onclick="this.closest('.modal-bg').remove()">OK</button>
      </div>
    </div>`;
  document.body.appendChild(bg);
}

/* ======================================================
   INTEGRAZIONI - 1. PROTEZIONE AGGIORNAMENTI
   ====================================================== */
function controllaAggiornamenti() {
  window.open('https://ceodoc.it/aggiornamenti', '_blank');
}

/* ======================================================
   INTEGRAZIONI - 2. PROFILO UTENTE
   ====================================================== */
function showProfilo() {
  updateProfiloData();
  document.getElementById('modal-profilo').style.display = 'flex';
}

function chiudiProfilo() {
  document.getElementById('modal-profilo').style.display = 'none';
}

function updateProfiloData() {
  // Prendi i dati utente completi
  const userData = getUserData();
  
  // Mostra nome completo nell'header
  if (userData) {
    document.getElementById('profiloNomeUtente').textContent = `${userData.nomeCompleto} - ${userData.ruolo}`;
  } else {
    document.getElementById('profiloNomeUtente').textContent = licenzaCorrente?.utente || 'Utente';
  }

// Popola sezione dati fiscali se esistono
  if (userData) {
    document.getElementById('sezione-dati-utente').style.display = 'block';
    document.getElementById('profiloDatiNome').textContent = userData.nomeCompleto;
    document.getElementById('profiloDatiCF').textContent = userData.cf;
    document.getElementById('profiloDatiRuolo').textContent = userData.ruolo;
    document.getElementById('profiloDatiEmail').textContent = userData.email;
  } else {
    document.getElementById('sezione-dati-utente').style.display = 'none';
  }
  
  if (licenzaInfo && licenzaCorrente) {
    // Tipo licenza
    const tipoDescrittivo = {
      'CRISK1': 'Centrale Rischi & Suite Finanziaria',
      'BILANCI4': 'Pacchetto Bilanci & Scadenziario',
      'COMPLIANCE5': 'Business Model & Compliance & ESG',
      'PLANNING3': 'Business Plan & Scenari',
      'FULL15': 'Completo - Tutti i Moduli'
    };
    
    // USA type NON tipo
    document.getElementById('profiloTipoLicenza').textContent = tipoDescrittivo[licenzaInfo.type] || licenzaInfo.type || '‚Äî';
    
    // Moduli - LISTA ESPLICITA
    const moduliNomi = {
      'anacrisk': 'Analisi Centrale Rischi',
      'anabilCONS': 'Analisi Bilancio Consuntivo',
      'anabilINFR': 'Analisi Bilancio Infrannuale',
      'importaFT': 'Importa Fatture per DSCR',
      'creaSCAD': 'Crea Scadenzario',
      'anaadeguati': 'Analisi Adeguati Assetti',
      'anaESG': 'Analisi ESG',
      'creaBM': 'Crea Business Model',
      'creaAS': 'Analisi SWOT',
      'creaORG': 'Crea Organigramma',
      'creaBP': 'Crea Business Plan',
      'creaPAMM': 'Suite Finanziaria',
      'creaSCEN': 'Crea Scenari',
      'creaVERB': 'Crea Verbale',
      'creaREPORT': 'Crea Report'
    };
    
    let moduliText = '';
    if (licenzaInfo.moduli && licenzaInfo.moduli.includes('ALL')) {
      // Per FULL15 elenchiamo tutti i moduli
      moduliText = Object.values(moduliNomi).join(', ');
    } else if (licenzaInfo.moduli) {
      // Per altre licenze solo i moduli abilitati
      const moduliAttivi = licenzaInfo.moduli
        .map(m => moduliNomi[m] || m)
        .filter(m => m !== undefined);
      moduliText = moduliAttivi.join(', ');
    }
    document.getElementById('profiloModuli').textContent = moduliText || '‚Äî';
    
    // Date - PARSING CORRETTO
    const activationDate = decodeDate(licenzaInfo.encodedDate);
    const [year, month, day] = activationDate.split('-');
    const attivazione = new Date(parseInt(year), parseInt(month) - 1, parseInt(day));
    attivazione.setHours(0, 0, 0, 0);
    
    document.getElementById('profiloDataAttivazione').textContent = attivazione.toLocaleDateString('it-IT');
    
    // USA duration NON giorni
    const scadenza = new Date(attivazione.getTime() + licenzaInfo.duration * 86400000);
    const oggi = new Date();
    oggi.setHours(0, 0, 0, 0);
    
    const giorniRimasti = Math.floor((scadenza - oggi) / 86400000);
    
    // Testo scadenza
    let testoScadenza = scadenza.toLocaleDateString('it-IT');
    if (giorniRimasti > 0) {
      testoScadenza += ` (${giorniRimasti} giorni rimanenti)`;
    } else if (giorniRimasti === 0) {
      testoScadenza += ` (SCADE OGGI)`;
    } else {
      testoScadenza += ` (SCADUTA da ${Math.abs(giorniRimasti)} giorni)`;
    }
    document.getElementById('profiloScadenza').textContent = testoScadenza;
    
    // Stato
    if (giorniRimasti > 0) {
      document.getElementById('profiloStato').textContent = '‚úÖ Attiva';
      document.getElementById('profiloStato').style.color = '#10b981';
    } else {
      document.getElementById('profiloStato').textContent = '‚ùå Scaduta';
      document.getElementById('profiloStato').style.color = '#ef4444';
    }
  } else {
    // Valori predefiniti se non c'√® licenza
    document.getElementById('profiloTipoLicenza').textContent = '‚Äî';
    document.getElementById('profiloModuli').textContent = '‚Äî';
    document.getElementById('profiloDataAttivazione').textContent = '‚Äî';
    document.getElementById('profiloScadenza').textContent = '‚Äî';
    document.getElementById('profiloStato').textContent = 'Non attiva';
    document.getElementById('profiloStato').style.color = '#6b7280';
  }
  
  // Anagrafiche
  const usage = getAnagraficaUsage();
  document.getElementById('profiloAnagraficheSalvate').textContent = usage.used;
  document.getElementById('profiloAnagraficheLimite').textContent = 'Illimitate';
}

function aggiornaLicenza() {
  chiudiProfilo();  // Chiudi profilo
  attivaLicenza();  // Apri modal attivazione licenza
}

function rinnovaOnline() {
  window.open('https://ceodoc.it/rinnovalicenza', '_blank');
}

function controllaAggiornamenti() {
  window.open('https://ceodoc.it/controlloaggiornamenti', '_blank');
}

/* ======================================================
   INTEGRAZIONI - 4. REMINDER BACKUP
   ====================================================== */
function checkBackupReminder() {
  const ultimoBackup = getStorage('ceodoc_ultimo_backup');
  if (!ultimoBackup) return;
  
  const ultimaData = new Date(ultimoBackup);
  const oggi = new Date();
  const giorniPassati = Math.floor((oggi - ultimaData) / (1000 * 60 * 60 * 24));
  
  if (giorniPassati >= 7) {
    setTimeout(() => {
      showBackupReminder();
    }, 5000);
  }
}

function showBackupReminder() {
  const reminder = document.createElement('div');
  reminder.id = 'backupReminderPopup';
  reminder.style.cssText = `
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: #fff;
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    z-index: 1000;
    max-width: 350px;
    animation: slideUp 0.3s ease-out;
  `;
  
  reminder.innerHTML = `
    <h4 style="margin:0 0 10px 0;color:var(--ceo-orange);display:flex;align-items:center;gap:10px">
      <svg width="24" height="24"><use href="#i-save"/></svg>
      üíæ Promemoria Backup
    </h4>
    <p style="margin:0 0 15px 0;color:var(--muted);font-size:14px">
      Non hai fatto backup da pi√π di 7 giorni. Proteggi i tuoi dati!
    </p>
    <div style="display:flex;gap:10px">
      <button onclick="backupFromReminder()" style="background:var(--ceo-orange);color:white;padding:8px 16px;border-radius:8px;font-weight:600">
        Backup Ora
      </button>
      <button onclick="dismissBackupReminder()" style="background:transparent;color:var(--muted);padding:8px 16px;border-radius:8px;border:1px solid var(--border)">
        Dopo
      </button>
    </div>
  `;
  
  document.body.appendChild(reminder);
}

function backupFromReminder() {
  esportaBackup();
  dismissBackupReminder();
}

function dismissBackupReminder() {
  const reminder = document.getElementById('backupReminderPopup');
  if (reminder) {
    reminder.style.animation = 'slideDown 0.3s ease-out';
    setTimeout(() => reminder.remove(), 300);
  }
}

/* ======================================================
   BOOTSTRAP
   ====================================================== */
// Funzione Dark Mode
function toggleDarkMode() {
  document.body.classList.toggle('dark-mode');
  const isDark = document.body.classList.contains('dark-mode');
  localStorage.setItem('ceodoc_theme', isDark ? 'dark' : 'light');
}

// Carica tema salvato
function loadTheme() {
  const savedTheme = localStorage.getItem('ceodoc_theme');
  if (savedTheme === 'dark') {
    document.body.classList.add('dark-mode');
  }
}

window.addEventListener('load', function() {
  try {
    const lic = JSON.parse(getStorage('ceodoc_licenza') || 'null');
    const info = JSON.parse(getStorage('ceodoc_licenza_info') || 'null');
    
    if (lic && info) {
      licenzaAttiva = true;
      licenzaCorrente = lic;
      licenzaInfo = info;
     checkLicenseExpiration();
    }
    
    loadTheme();
    updateSidebarActive('home');
    updateAnagraficaAttivaUI();
    showWelcome();
    
    // Check updates e reminder
    // if (typeof checkForUpdates === 'function') checkForUpdates();  // DISABILITATO
    if (typeof checkBackupReminder === 'function') checkBackupReminder();
  } catch(e) {
    console.error('Errore inizializzazione:', e);
    document.getElementById('card-content').innerHTML = '<h2>Benvenuto in ceoDOC</h2><p>Si √® verificato un errore. Ricarica la pagina.</p>';
  }
});

// ESC chiude profilo
document.addEventListener('keydown', function(e) {
  if (e.key === 'Escape') {
    const modalProfilo = document.getElementById('modal-profilo');
    if (modalProfilo.style.display === 'flex') {
      chiudiProfilo();
    }
  }
});

/* ======================================================
   CONTEXT + BACKUP/RIPRISTINO
   ====================================================== */
function getContext() {
  try {
    const lic = JSON.parse(getStorage('ceodoc_licenza') || 'null');
    const info = JSON.parse(getStorage('ceodoc_licenza_info') || 'null');
    const az = JSON.parse(getStorage('ceodoc_anagrafica_attiva') || 'null');
    const session = getStorage('ceodoc_session') || ('S' + Math.random().toString(36).slice(2) + Date.now().toString(36));
    
    if (!getStorage('ceodoc_session')) {
      setStorage('ceodoc_session', session);
    }
    
    return {
      type: 'ceodoc.context',
      appId: null,
      sessionToken: session,
      license: lic,
      licenseInfo: info,
      utente: lic ? lic.utente : null,
      azienda: az,
      version: '2.0'
    };
  } catch(e) {
    return {
      type: 'ceodoc.context',
      appId: null,
      sessionToken: '',
      license: null,
      licenseInfo: null,
      utente: null,
      azienda: null,
      version: '2.0'
    };
  }
}

function wireIframe(iframe, moduleId) {
  try {
    iframe.onload = function() {
      try {
        const ctx = getContext();
        ctx.appId = moduleId;
        iframe.contentWindow.postMessage(ctx, '*');
      } catch(_) {}
    };
  } catch(e) {}
}

/* Backup/Ripristino */
function pad2(n) {
  return String(n).padStart(2, '0');
}

function esportaBackup() {
  alert('Salva in ceoDOC/archivio/dati/backup');
  const dump = {};
  
  try {
    for (let i = 0; i < localStorage.length; i++) {
      const k = localStorage.key(i);
      if (/^ceodoc_/i.test(k)) dump[k] = localStorage.getItem(k);
    }
  } catch(e) {}
  
  const d = new Date();
  const nome = 'ceodoc_backup_' + pad2(d.getDate()) + pad2(d.getMonth() + 1) + String(d.getFullYear()).slice(-2) + '_' + pad2(d.getHours()) + pad2(d.getMinutes()) + pad2(d.getSeconds()) + '.json';
  const payload = { created: new Date().toISOString(), data: dump };
  const blob = new Blob([JSON.stringify(payload, null, 2)], { type: 'application/json' });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = nome;
  document.body.appendChild(a);
  a.click();
  
  setTimeout(function() {
    URL.revokeObjectURL(a.href);
    a.remove();
  }, 0);
  
  // Salva timestamp ultimo backup
  setStorage('ceodoc_ultimo_backup', new Date().toISOString());
}

function ripristinaBackup() {
  alert('Ripristina da ceoDOC/archivio/dati/backup');
  document.getElementById('fileRestore').click();
}

function importaBackup(file) {
  const rd = new FileReader();
  rd.onload = function(e) {
    try {
      const obj = JSON.parse(e.target.result);
      const data = obj.data || obj;
      
      for (const k in data) {
        setStorage(k, data[k]);
      }
      
      alert("Backup ripristinato. L'app verr√† ricaricata.");
      location.reload();
    } catch(err) {
      alert('Backup non valido');
    }
  };
  rd.readAsText(file);
}

// Animazioni CSS per reminder
const style = document.createElement('style');
style.textContent = `
@keyframes slideUp {
  from { transform: translateY(100px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}
@keyframes slideDown {
  from { transform: translateY(0); opacity: 1; }
  to { transform: translateY(100px); opacity: 0; }
}
`;
document.head.appendChild(style);
</script>
</body>
</html>